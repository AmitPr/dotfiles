function desktopNotification(c,b){function a(){try{var g=window.webkitNotifications;var f=g.createNotification("http://i.imgur.com/mDZWP.png",c,b);f.show();setTimeout(function(){f.cancel()},5000)}catch(e){alert(e.message)}}if(window.webkitNotifications){var d=window.webkitNotifications;if(d.checkPermission()){d.requestPermission(a)}else{a()}}}var nameToCode={"pad-Backspace":8,Tab:9,Enter:13,Shift:16,Ctrl:17,Alt:18,Pause:19,Capslock:20,Esc:27,Pageup:33,Pagedown:34,End:35,Home:36,Leftarrow:37,Uparrow:38,Rightarrow:39,Downarrow:40,Insert:45,Delete:46,"0":48,"1":49,"2":50,"3":51,"4":52,"5":53,"6":54,"7":55,"8":56,"9":57,a:65,b:66,c:67,d:68,e:69,f:70,g:71,h:72,i:73,j:74,k:75,l:76,m:77,n:78,o:79,p:80,q:81,r:82,s:83,t:84,u:85,v:86,w:87,x:88,y:89,z:90,"pad-0":96,"pad-1":97,"pad-2":98,"pad-3":99,"pad-4":100,"pad-5":101,"pad-6":102,"pad-7":103,"pad-8":104,"pad-9":105,"pad-Multiply":106,Plus:107,Minut:109,Dot:110,Slash1:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,equal:187,Coma:188,Slash:191,Backslash:220,Cmd:91,cmdOrControl:(navigator.appVersion.indexOf("Mac")==-1)?17:91};var codeToName={8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",20:"Capslock",27:"Esc",33:"Pageup",34:"Pagedown",35:"End",36:"Home",37:"Leftarrow",38:"Uparrow",39:"Rightarrow",40:"Downarrow",45:"Insert",46:"Delete",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",96:"0",97:"pad-1",98:"pad-2",99:"pad-3",100:"pad-4",101:"pad-5",102:"pad-6",103:"pad-7",104:"pad-8",105:"pad-9",106:"Multiply",107:"Plus",109:"Minut",110:"Dot",111:"Slash1",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",187:"equal",188:"Coma",191:"Slash",220:"Backslash",91:"Cmd"};var shortcuts={togglePopupsStay:{action:function(){window.preventPreviewClose=(window.preventPreviewClose)?false:true},desc:"Toggle tooltips staying on screen"},openSearch:{action:function(){$("#searchNav").click();setTimeout(function(){$("#addSearch_search").focus()},1000)},desc:"Open Search"},reply:{action:function(){$("#replyGlobal").click()},desc:"Open Reply Popup"},newThread:{action:function(){$("#createPostNavButton").click()},desc:"Open New Thread Popup"},messages:{action:function(){$("#notificationCounter").click()},desc:"Open Notifications"},closePopup:{action:function(){$('[data-message="close"]').click()},desc:"Close Popup"},nextGalleryItem:{action:function(){if($(document.activeElement).is("input")||$(document.activeElement).is("textarea")){return}if($("#galleryPlayground").length){$("#galleryPlayground .forwardButton").filter(":visible").click()}else{$(".currentPage").next().filter(":visible").click()}},desc:"Next Gallery Item / Column's Page"},prevGalleryItem:{action:function(){if($(document.activeElement).is("input")||$(document.activeElement).is("textarea")){return}if($("#galleryPlayground").length){$("#galleryPlayground .backButton").filter(":visible").click()}else{$(".currentPage").prev().filter(":visible").click()}},desc:"Previous Gallery Item / Column's Page"},columnDropdown:{action:function(){$("#pageSelector .alien").filter(":visible").click()},desc:"Display Column Dropdown"},openSidebar:{action:function(){$("#postSideBar").click()},desc:"Open Sidebar"},openSettings:{action:function(){$("#settingsNav").click()},desc:"Open Settings"},accounts:{action:function(){$("#accounts").click()},desc:"Accounts"},goHome:{action:function(){$("#homeNav").click()},desc:"Go Home"},submit:{action:function(){$(".submitButton").click()},desc:"Submit"},goBack:{action:function(){history.back()},desc:"Go Back"},goForward:{action:function(){history.forward()},desc:"Go Forward"},toggleScopeLeft:{action:function(d,c){if($(document.activeElement).is("textarea, input")||$(".complexAlertBackdrop").length!=0){return}if(c!="next"){c="prev"}if(typeof column.prototype.activeColumn=="undefined"){var b=column.prototype.activeColumn=$('#ColumnContainer .container[data-page="'+window.tabManagerObj.currentPage+'"]:first');b.addClass("glow");shortcuts.toggleItemUp.action();return}var a=column.prototype.activeColumn[c]();if(!a.is(".container")){return}a.addClass("glow");column.prototype.activeColumn.removeClass("glow");if(window.tabManagerObj.currentPage!=a.attr("data-page")){window.tabManagerObj.changePage(a.attr("data-page"))}column.prototype.activeColumn=a;shortcuts.toggleItemUp.action();setTimeout(function(){$("input").blur()},250)},desc:"Previous Column"},toggleScopeRight:{action:function(a){shortcuts.toggleScopeLeft.action(a,"next")},desc:"Next Column"},toggleItemUp:{action:function(f,h){if($(document.activeElement).is("textarea, input")||$(".complexAlertBackdrop").length!=0){return true}if(h!="next"){h="prev"}if(typeof column.prototype.activeColumn=="undefined"){shortcuts.toggleScopeLeft.action();return}if(column.prototype.activeColumn.find(".current").length==0){$(".current").removeClass("current");window.armForEnter=column.prototype.activeColumn.find(".Post:visible:first").addClass("current");return}var g=column.prototype.activeColumn.find(".current");var a=g[h](":visible");if(a.length!=0){a}else{a=g[h+"Until"](":visible").last()[h]()}if(a.is("#searchElements")){return}else{if(!a.is(".LoadingPost")){g.removeClass("current");a.addClass("current");window.armForEnter=a}var b=a.parent().parent();var j=b.height();var d=b.scrollTop();var i=a.position().top;var c=a.height();if((j+d)<(i+c+d)){b.scrollTop(i+d-j+c+10)}else{if(d>(d+i)){b.scrollTop(i+d)}}}},desc:"Previous post/comment"},toggleItemDown:{action:function(a){shortcuts.toggleItemUp.action(a,"next")},desc:"Next post/comment"},upvote:{action:function(d,a){if($(document.activeElement).is("textarea, input")||$(".complexAlertBackdrop").length!=0){return}if(typeof a=="undefined"){a="upVote"}var b=tabManagerObj.columns[window.armForEnter.parent().parent().parent().parent().attr("id")];if(typeof b!="undefined"){var c=window.armForEnter.find("."+a);b.sourceObject[a](c,c.parent().parent().attr("id"))}},desc:"Upvote Item"},downvote:{action:function(a){shortcuts.upvote.action(a,"downVote")},desc:"Downvote Item"}};function setShortcut(a,c,b){a.setting("macros",function(d){d[c]=b;a.setting("macros",d)})}function applyShortcuts(a){a.setting("macros_enabled",function(c){var b=$(window);b.keyCombo(false);if(!c){return}a.setting("macros",function(e){for(var d in e){b.keyCombo(e[d],shortcuts[d].action)}b.off(".armForEnter").on("keypress.armForEnter",function(g){if(g.keyCode==13&&!$(document.activeElement).is("textarea, input")&&typeof window.armForEnter!="undefined"&&$(window.armForEnter).length!=0){if(window.armForEnter.is(".Post")){var f=tabManagerObj.columns[window.armForEnter.parent().parent().parent().parent().attr("id")];if(typeof f!="undefined"){f.sourceObject.openPost(window.armForEnter)}}}})})})}
/*! jQuery v@1.8.1 jquery.com | jquery.org/license */
(function(a,b){function G(a){var b=F[a]={};return p.each(a.split(s),function(a,c){b[c]=!0}),b}function J(a,c,d){if(d===b&&a.nodeType===1){var e="data-"+c.replace(I,"-$1").toLowerCase();d=a.getAttribute(e);if(typeof d=="string"){try{d=d==="true"?!0:d==="false"?!1:d==="null"?null:+d+""===d?+d:H.test(d)?p.parseJSON(d):d}catch(f){}p.data(a,c,d)}else{d=b}}return d}function K(a){var b;for(b in a){if(b==="data"&&p.isEmptyObject(a[b])){continue}if(b!=="toJSON"){return !1}}return !0}function ba(){return !1}function bb(){return !0}function bh(a){return !a||!a.parentNode||a.parentNode.nodeType===11}function bi(a,b){do{a=a[b]}while(a&&a.nodeType!==1);return a}function bj(a,b,c){b=b||0;if(p.isFunction(b)){return p.grep(a,function(a,d){var e=!!b.call(a,d,a);return e===c})}if(b.nodeType){return p.grep(a,function(a,d){return a===b===c})}if(typeof b=="string"){var d=p.grep(a,function(a){return a.nodeType===1});if(be.test(b)){return p.filter(b,d,!c)}b=p.filter(b,d)}return p.grep(a,function(a,d){return p.inArray(a,b)>=0===c})}function bk(a){var b=bl.split("|"),c=a.createDocumentFragment();if(c.createElement){while(b.length){c.createElement(b.pop())}}return c}function bC(a,b){return a.getElementsByTagName(b)[0]||a.appendChild(a.ownerDocument.createElement(b))}function bD(a,b){if(b.nodeType!==1||!p.hasData(a)){return}var c,d,e,f=p._data(a),g=p._data(b,f),h=f.events;if(h){delete g.handle,g.events={};for(c in h){for(d=0,e=h[c].length;d<e;d++){p.event.add(b,c,h[c][d])}}}g.data&&(g.data=p.extend({},g.data))}function bE(a,b){var c;if(b.nodeType!==1){return}b.clearAttributes&&b.clearAttributes(),b.mergeAttributes&&b.mergeAttributes(a),c=b.nodeName.toLowerCase(),c==="object"?(b.parentNode&&(b.outerHTML=a.outerHTML),p.support.html5Clone&&a.innerHTML&&!p.trim(b.innerHTML)&&(b.innerHTML=a.innerHTML)):c==="input"&&bv.test(a.type)?(b.defaultChecked=b.checked=a.checked,b.value!==a.value&&(b.value=a.value)):c==="option"?b.selected=a.defaultSelected:c==="input"||c==="textarea"?b.defaultValue=a.defaultValue:c==="script"&&b.text!==a.text&&(b.text=a.text),b.removeAttribute(p.expando)}function bF(a){return typeof a.getElementsByTagName!="undefined"?a.getElementsByTagName("*"):typeof a.querySelectorAll!="undefined"?a.querySelectorAll("*"):[]}function bG(a){bv.test(a.type)&&(a.defaultChecked=a.checked)}function bY(a,b){if(b in a){return b}var c=b.charAt(0).toUpperCase()+b.slice(1),d=b,e=bW.length;while(e--){b=bW[e]+c;if(b in a){return b}}return d}function bZ(a,b){return a=b||a,p.css(a,"display")==="none"||!p.contains(a.ownerDocument,a)}function b$(a,b){var c,d,e=[],f=0,g=a.length;for(;f<g;f++){c=a[f];if(!c.style){continue}e[f]=p._data(c,"olddisplay"),b?(!e[f]&&c.style.display==="none"&&(c.style.display=""),c.style.display===""&&bZ(c)&&(e[f]=p._data(c,"olddisplay",cc(c.nodeName)))):(d=bH(c,"display"),!e[f]&&d!=="none"&&p._data(c,"olddisplay",d))}for(f=0;f<g;f++){c=a[f];if(!c.style){continue}if(!b||c.style.display==="none"||c.style.display===""){c.style.display=b?e[f]||"":"none"}}return a}function b_(a,b,c){var d=bP.exec(b);return d?Math.max(0,d[1]-(c||0))+(d[2]||"px"):b}function ca(a,b,c,d){var e=c===(d?"border":"content")?4:b==="width"?1:0,f=0;for(;e<4;e+=2){c==="margin"&&(f+=p.css(a,c+bV[e],!0)),d?(c==="content"&&(f-=parseFloat(bH(a,"padding"+bV[e]))||0),c!=="margin"&&(f-=parseFloat(bH(a,"border"+bV[e]+"Width"))||0)):(f+=parseFloat(bH(a,"padding"+bV[e]))||0,c!=="padding"&&(f+=parseFloat(bH(a,"border"+bV[e]+"Width"))||0))}return f}function cb(a,b,c){var d=b==="width"?a.offsetWidth:a.offsetHeight,e=!0,f=p.support.boxSizing&&p.css(a,"boxSizing")==="border-box";if(d<=0||d==null){d=bH(a,b);if(d<0||d==null){d=a.style[b]}if(bQ.test(d)){return d}e=f&&(p.support.boxSizingReliable||d===a.style[b]),d=parseFloat(d)||0}return d+ca(a,b,c||(f?"border":"content"),e)+"px"}function cc(a){if(bS[a]){return bS[a]}var b=p("<"+a+">").appendTo(e.body),c=b.css("display");b.remove();if(c==="none"||c===""){bI=e.body.appendChild(bI||p.extend(e.createElement("iframe"),{frameBorder:0,width:0,height:0}));if(!bJ||!bI.createElement){bJ=(bI.contentWindow||bI.contentDocument).document,bJ.write("<!doctype html><html><body>"),bJ.close()}b=bJ.body.appendChild(bJ.createElement(a)),c=bH(b,"display"),e.body.removeChild(bI)}return bS[a]=c,c}function ci(a,b,c,d){var e;if(p.isArray(b)){p.each(b,function(b,e){c||ce.test(a)?d(a,e):ci(a+"["+(typeof e=="object"?b:"")+"]",e,c,d)})}else{if(!c&&p.type(b)==="object"){for(e in b){ci(a+"["+e+"]",b[e],c,d)}}else{d(a,b)}}}function cz(a){return function(b,c){typeof b!="string"&&(c=b,b="*");var d,e,f,g=b.toLowerCase().split(s),h=0,i=g.length;if(p.isFunction(c)){for(;h<i;h++){d=g[h],f=/^\+/.test(d),f&&(d=d.substr(1)||"*"),e=a[d]=a[d]||[],e[f?"unshift":"push"](c)}}}}function cA(a,c,d,e,f,g){f=f||c.dataTypes[0],g=g||{},g[f]=!0;var h,i=a[f],j=0,k=i?i.length:0,l=a===cv;for(;j<k&&(l||!h);j++){h=i[j](c,d,e),typeof h=="string"&&(!l||g[h]?h=b:(c.dataTypes.unshift(h),h=cA(a,c,d,e,h,g)))}return(l||!h)&&!g["*"]&&(h=cA(a,c,d,e,"*",g)),h}function cB(a,c){var d,e,f=p.ajaxSettings.flatOptions||{};for(d in c){c[d]!==b&&((f[d]?a:e||(e={}))[d]=c[d])}e&&p.extend(!0,a,e)}function cC(a,c,d){var e,f,g,h,i=a.contents,j=a.dataTypes,k=a.responseFields;for(f in k){f in d&&(c[k[f]]=d[f])}while(j[0]==="*"){j.shift(),e===b&&(e=a.mimeType||c.getResponseHeader("content-type"))}if(e){for(f in i){if(i[f]&&i[f].test(e)){j.unshift(f);break}}}if(j[0] in d){g=j[0]}else{for(f in d){if(!j[0]||a.converters[f+" "+j[0]]){g=f;break}h||(h=f)}g=g||h}if(g){return g!==j[0]&&j.unshift(g),d[g]}}function cD(a,b){var c,d,e,f,g=a.dataTypes.slice(),h=g[0],i={},j=0;a.dataFilter&&(b=a.dataFilter(b,a.dataType));if(g[1]){for(c in a.converters){i[c.toLowerCase()]=a.converters[c]}}for(;e=g[++j];){if(e!=="*"){if(h!=="*"&&h!==e){c=i[h+" "+e]||i["* "+e];if(!c){for(d in i){f=d.split(" ");if(f[1]===e){c=i[h+" "+f[0]]||i["* "+f[0]];if(c){c===!0?c=i[d]:i[d]!==!0&&(e=f[0],g.splice(j--,0,e));break}}}}if(c!==!0){if(c&&a["throws"]){b=c(b)}else{try{b=c(b)}catch(k){return{state:"parsererror",error:c?k:"No conversion from "+h+" to "+e}}}}}h=e}}return{state:"success",data:b}}function cL(){try{return new a.XMLHttpRequest}catch(b){}}function cM(){try{return new a.ActiveXObject("Microsoft.XMLHTTP")}catch(b){}}function cU(){return setTimeout(function(){cN=b},0),cN=p.now()}function cV(a,b){p.each(b,function(b,c){var d=(cT[b]||[]).concat(cT["*"]),e=0,f=d.length;for(;e<f;e++){if(d[e].call(a,b,c)){return}}})}function cW(a,b,c){var d,e=0,f=0,g=cS.length,h=p.Deferred().always(function(){delete i.elem}),i=function(){var b=cN||cU(),c=Math.max(0,j.startTime+j.duration-b),d=1-(c/j.duration||0),e=0,f=j.tweens.length;for(;e<f;e++){j.tweens[e].run(d)}return h.notifyWith(a,[j,d,c]),d<1&&f?c:(h.resolveWith(a,[j]),!1)},j=h.promise({elem:a,props:p.extend({},b),opts:p.extend(!0,{specialEasing:{}},c),originalProperties:b,originalOptions:c,startTime:cN||cU(),duration:c.duration,tweens:[],createTween:function(b,c,d){var e=p.Tween(a,j.opts,b,c,j.opts.specialEasing[b]||j.opts.easing);return j.tweens.push(e),e},stop:function(b){var c=0,d=b?j.tweens.length:0;for(;c<d;c++){j.tweens[c].run(1)}return b?h.resolveWith(a,[j,b]):h.rejectWith(a,[j,b]),this}}),k=j.props;cX(k,j.opts.specialEasing);for(;e<g;e++){d=cS[e].call(j,a,k,j.opts);if(d){return d}}return cV(j,k),p.isFunction(j.opts.start)&&j.opts.start.call(a,j),p.fx.timer(p.extend(i,{anim:j,queue:j.opts.queue,elem:a})),j.progress(j.opts.progress).done(j.opts.done,j.opts.complete).fail(j.opts.fail).always(j.opts.always)}function cX(a,b){var c,d,e,f,g;for(c in a){d=p.camelCase(c),e=b[d],f=a[c],p.isArray(f)&&(e=f[1],f=a[c]=f[0]),c!==d&&(a[d]=f,delete a[c]),g=p.cssHooks[d];if(g&&"expand" in g){f=g.expand(f),delete a[d];for(c in f){c in a||(a[c]=f[c],b[c]=e)}}else{b[d]=e}}}function cY(a,b,c){var d,e,f,g,h,i,j,k,l=this,m=a.style,n={},o=[],q=a.nodeType&&bZ(a);c.queue||(j=p._queueHooks(a,"fx"),j.unqueued==null&&(j.unqueued=0,k=j.empty.fire,j.empty.fire=function(){j.unqueued||k()}),j.unqueued++,l.always(function(){l.always(function(){j.unqueued--,p.queue(a,"fx").length||j.empty.fire()})})),a.nodeType===1&&("height" in b||"width" in b)&&(c.overflow=[m.overflow,m.overflowX,m.overflowY],p.css(a,"display")==="inline"&&p.css(a,"float")==="none"&&(!p.support.inlineBlockNeedsLayout||cc(a.nodeName)==="inline"?m.display="inline-block":m.zoom=1)),c.overflow&&(m.overflow="hidden",p.support.shrinkWrapBlocks||l.done(function(){m.overflow=c.overflow[0],m.overflowX=c.overflow[1],m.overflowY=c.overflow[2]}));for(d in b){f=b[d];if(cP.exec(f)){delete b[d];if(f===(q?"hide":"show")){continue}o.push(d)}}g=o.length;if(g){h=p._data(a,"fxshow")||p._data(a,"fxshow",{}),q?p(a).show():l.done(function(){p(a).hide()}),l.done(function(){var b;p.removeData(a,"fxshow",!0);for(b in n){p.style(a,b,n[b])}});for(d=0;d<g;d++){e=o[d],i=l.createTween(e,q?h[e]:0),n[e]=h[e]||p.style(a,e),e in h||(h[e]=i.start,q&&(i.end=i.start,i.start=e==="width"||e==="height"?1:0))}}}function cZ(a,b,c,d,e){return new cZ.prototype.init(a,b,c,d,e)}function c$(a,b){var c,d={height:a},e=0;b=b?1:0;for(;e<4;e+=2-b){c=bV[e],d["margin"+c]=d["padding"+c]=a}return b&&(d.opacity=d.width=a),d}function da(a){return p.isWindow(a)?a:a.nodeType===9?a.defaultView||a.parentWindow:!1}var c,d,e=a.document,f=a.location,g=a.navigator,h=a.jQuery,i=a.$,j=Array.prototype.push,k=Array.prototype.slice,l=Array.prototype.indexOf,m=Object.prototype.toString,n=Object.prototype.hasOwnProperty,o=String.prototype.trim,p=function(a,b){return new p.fn.init(a,b,c)},q=/[\-+]?(?:\d*\.|)\d+(?:[eE][\-+]?\d+|)/.source,r=/\S/,s=/\s+/,t=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,u=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,v=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,w=/^[\],:{}\s]*$/,x=/(?:^|:|,)(?:\s*\[)+/g,y=/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,z=/"[^"\\\r\n]*"|true|false|null|-?(?:\d\d*\.|)\d+(?:[eE][\-+]?\d+|)/g,A=/^-ms-/,B=/-([\da-z])/gi,C=function(a,b){return(b+"").toUpperCase()},D=function(){e.addEventListener?(e.removeEventListener("DOMContentLoaded",D,!1),p.ready()):e.readyState==="complete"&&(e.detachEvent("onreadystatechange",D),p.ready())},E={};p.fn=p.prototype={constructor:p,init:function(a,c,d){var f,g,h,i;if(!a){return this}if(a.nodeType){return this.context=this[0]=a,this.length=1,this}if(typeof a=="string"){a.charAt(0)==="<"&&a.charAt(a.length-1)===">"&&a.length>=3?f=[null,a,null]:f=u.exec(a);if(f&&(f[1]||!c)){if(f[1]){return c=c instanceof p?c[0]:c,i=c&&c.nodeType?c.ownerDocument||c:e,a=p.parseHTML(f[1],i,!0),v.test(f[1])&&p.isPlainObject(c)&&this.attr.call(a,c,!0),p.merge(this,a)}g=e.getElementById(f[2]);if(g&&g.parentNode){if(g.id!==f[2]){return d.find(a)}this.length=1,this[0]=g}return this.context=e,this.selector=a,this}return !c||c.jquery?(c||d).find(a):this.constructor(c).find(a)}return p.isFunction(a)?d.ready(a):(a.selector!==b&&(this.selector=a.selector,this.context=a.context),p.makeArray(a,this))},selector:"",jquery:"1.8.1",length:0,size:function(){return this.length},toArray:function(){return k.call(this)},get:function(a){return a==null?this.toArray():a<0?this[this.length+a]:this[a]},pushStack:function(a,b,c){var d=p.merge(this.constructor(),a);return d.prevObject=this,d.context=this.context,b==="find"?d.selector=this.selector+(this.selector?" ":"")+c:b&&(d.selector=this.selector+"."+b+"("+c+")"),d},each:function(a,b){return p.each(this,a,b)},ready:function(a){return p.ready.promise().done(a),this},eq:function(a){return a=+a,a===-1?this.slice(a):this.slice(a,a+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},slice:function(){return this.pushStack(k.apply(this,arguments),"slice",k.call(arguments).join(","))},map:function(a){return this.pushStack(p.map(this,function(b,c){return a.call(b,c,b)}))},end:function(){return this.prevObject||this.constructor(null)},push:j,sort:[].sort,splice:[].splice},p.fn.init.prototype=p.fn,p.extend=p.fn.extend=function(){var a,c,d,e,f,g,h=arguments[0]||{},i=1,j=arguments.length,k=!1;typeof h=="boolean"&&(k=h,h=arguments[1]||{},i=2),typeof h!="object"&&!p.isFunction(h)&&(h={}),j===i&&(h=this,--i);for(;i<j;i++){if((a=arguments[i])!=null){for(c in a){d=h[c],e=a[c];if(h===e){continue}k&&e&&(p.isPlainObject(e)||(f=p.isArray(e)))?(f?(f=!1,g=d&&p.isArray(d)?d:[]):g=d&&p.isPlainObject(d)?d:{},h[c]=p.extend(k,g,e)):e!==b&&(h[c]=e)}}}return h},p.extend({noConflict:function(b){return a.$===p&&(a.$=i),b&&a.jQuery===p&&(a.jQuery=h),p},isReady:!1,readyWait:1,holdReady:function(a){a?p.readyWait++:p.ready(!0)},ready:function(a){if(a===!0?--p.readyWait:p.isReady){return}if(!e.body){return setTimeout(p.ready,1)}p.isReady=!0;if(a!==!0&&--p.readyWait>0){return}d.resolveWith(e,[p]),p.fn.trigger&&p(e).trigger("ready").off("ready")},isFunction:function(a){return p.type(a)==="function"},isArray:Array.isArray||function(a){return p.type(a)==="array"},isWindow:function(a){return a!=null&&a==a.window},isNumeric:function(a){return !isNaN(parseFloat(a))&&isFinite(a)},type:function(a){return a==null?String(a):E[m.call(a)]||"object"},isPlainObject:function(a){if(!a||p.type(a)!=="object"||a.nodeType||p.isWindow(a)){return !1}try{if(a.constructor&&!n.call(a,"constructor")&&!n.call(a.constructor.prototype,"isPrototypeOf")){return !1}}catch(c){return !1}var d;for(d in a){}return d===b||n.call(a,d)},isEmptyObject:function(a){var b;for(b in a){return !1}return !0},error:function(a){throw new Error(a)},parseHTML:function(a,b,c){var d;return !a||typeof a!="string"?null:(typeof b=="boolean"&&(c=b,b=0),b=b||e,(d=v.exec(a))?[b.createElement(d[1])]:(d=p.buildFragment([a],b,c?null:[]),p.merge([],(d.cacheable?p.clone(d.fragment):d.fragment).childNodes)))},parseJSON:function(b){if(!b||typeof b!="string"){return null}b=p.trim(b);if(a.JSON&&a.JSON.parse){return a.JSON.parse(b)}if(w.test(b.replace(y,"@").replace(z,"]").replace(x,""))){return(new Function("return "+b))()}p.error("Invalid JSON: "+b)},parseXML:function(c){var d,e;if(!c||typeof c!="string"){return null}try{a.DOMParser?(e=new DOMParser,d=e.parseFromString(c,"text/xml")):(d=new ActiveXObject("Microsoft.XMLDOM"),d.async="false",d.loadXML(c))}catch(f){d=b}return(!d||!d.documentElement||d.getElementsByTagName("parsererror").length)&&p.error("Invalid XML: "+c),d},noop:function(){},globalEval:function(b){b&&r.test(b)&&(a.execScript||function(b){a.eval.call(a,b)})(b)},camelCase:function(a){return a.replace(A,"ms-").replace(B,C)},nodeName:function(a,b){return a.nodeName&&a.nodeName.toUpperCase()===b.toUpperCase()},each:function(a,c,d){var e,f=0,g=a.length,h=g===b||p.isFunction(a);if(d){if(h){for(e in a){if(c.apply(a[e],d)===!1){break}}}else{for(;f<g;){if(c.apply(a[f++],d)===!1){break}}}}else{if(h){for(e in a){if(c.call(a[e],e,a[e])===!1){break}}}else{for(;f<g;){if(c.call(a[f],f,a[f++])===!1){break}}}}return a},trim:o&&!o.call(" ")?function(a){return a==null?"":o.call(a)}:function(a){return a==null?"":a.toString().replace(t,"")},makeArray:function(a,b){var c,d=b||[];return a!=null&&(c=p.type(a),a.length==null||c==="string"||c==="function"||c==="regexp"||p.isWindow(a)?j.call(d,a):p.merge(d,a)),d},inArray:function(a,b,c){var d;if(b){if(l){return l.call(b,a,c)}d=b.length,c=c?c<0?Math.max(0,d+c):c:0;for(;c<d;c++){if(c in b&&b[c]===a){return c}}}return -1},merge:function(a,c){var d=c.length,e=a.length,f=0;if(typeof d=="number"){for(;f<d;f++){a[e++]=c[f]}}else{while(c[f]!==b){a[e++]=c[f++]}}return a.length=e,a},grep:function(a,b,c){var d,e=[],f=0,g=a.length;c=!!c;for(;f<g;f++){d=!!b(a[f],f),c!==d&&e.push(a[f])}return e},map:function(a,c,d){var e,f,g=[],h=0,i=a.length,j=a instanceof p||i!==b&&typeof i=="number"&&(i>0&&a[0]&&a[i-1]||i===0||p.isArray(a));if(j){for(;h<i;h++){e=c(a[h],h,d),e!=null&&(g[g.length]=e)}}else{for(f in a){e=c(a[f],f,d),e!=null&&(g[g.length]=e)}}return g.concat.apply([],g)},guid:1,proxy:function(a,c){var d,e,f;return typeof c=="string"&&(d=a[c],c=a,a=d),p.isFunction(a)?(e=k.call(arguments,2),f=function(){return a.apply(c,e.concat(k.call(arguments)))},f.guid=a.guid=a.guid||f.guid||p.guid++,f):b},access:function(a,c,d,e,f,g,h){var i,j=d==null,k=0,l=a.length;if(d&&typeof d=="object"){for(k in d){p.access(a,c,k,d[k],1,g,e)}f=1}else{if(e!==b){i=h===b&&p.isFunction(e),j&&(i?(i=c,c=function(a,b,c){return i.call(p(a),c)}):(c.call(a,e),c=null));if(c){for(;k<l;k++){c(a[k],d,i?e.call(a[k],k,c(a[k],d)):e,h)}}f=1}}return f?a:j?c.call(a):l?c(a[0],d):g},now:function(){return(new Date).getTime()}}),p.ready.promise=function(b){if(!d){d=p.Deferred();if(e.readyState==="complete"){setTimeout(p.ready,1)}else{if(e.addEventListener){e.addEventListener("DOMContentLoaded",D,!1),a.addEventListener("load",p.ready,!1)}else{e.attachEvent("onreadystatechange",D),a.attachEvent("onload",p.ready);var c=!1;try{c=a.frameElement==null&&e.documentElement}catch(f){}c&&c.doScroll&&function g(){if(!p.isReady){try{c.doScroll("left")}catch(a){return setTimeout(g,50)}p.ready()}}()}}}return d.promise(b)},p.each("Boolean Number String Function Array Date RegExp Object".split(" "),function(a,b){E["[object "+b+"]"]=b.toLowerCase()}),c=p(e);var F={};p.Callbacks=function(a){a=typeof a=="string"?F[a]||G(a):p.extend({},a);var c,d,e,f,g,h,i=[],j=!a.once&&[],k=function(b){c=a.memory&&b,d=!0,h=f||0,f=0,g=i.length,e=!0;for(;i&&h<g;h++){if(i[h].apply(b[0],b[1])===!1&&a.stopOnFalse){c=!1;break}}e=!1,i&&(j?j.length&&k(j.shift()):c?i=[]:l.disable())},l={add:function(){if(i){var b=i.length;(function d(b){p.each(b,function(b,c){var e=p.type(c);e==="function"&&(!a.unique||!l.has(c))?i.push(c):c&&c.length&&e!=="string"&&d(c)})})(arguments),e?g=i.length:c&&(f=b,k(c))}return this},remove:function(){return i&&p.each(arguments,function(a,b){var c;while((c=p.inArray(b,i,c))>-1){i.splice(c,1),e&&(c<=g&&g--,c<=h&&h--)}}),this},has:function(a){return p.inArray(a,i)>-1},empty:function(){return i=[],this},disable:function(){return i=j=c=b,this},disabled:function(){return !i},lock:function(){return j=b,c||l.disable(),this},locked:function(){return !j},fireWith:function(a,b){return b=b||[],b=[a,b.slice?b.slice():b],i&&(!d||j)&&(e?j.push(b):k(b)),this},fire:function(){return l.fireWith(this,arguments),this},fired:function(){return !!d}};return l},p.extend({Deferred:function(a){var b=[["resolve","done",p.Callbacks("once memory"),"resolved"],["reject","fail",p.Callbacks("once memory"),"rejected"],["notify","progress",p.Callbacks("memory")]],c="pending",d={state:function(){return c},always:function(){return e.done(arguments).fail(arguments),this},then:function(){var a=arguments;return p.Deferred(function(c){p.each(b,function(b,d){var f=d[0],g=a[b];e[d[1]](p.isFunction(g)?function(){var a=g.apply(this,arguments);a&&p.isFunction(a.promise)?a.promise().done(c.resolve).fail(c.reject).progress(c.notify):c[f+"With"](this===e?c:this,[a])}:c[f])}),a=null}).promise()},promise:function(a){return typeof a=="object"?p.extend(a,d):d}},e={};return d.pipe=d.then,p.each(b,function(a,f){var g=f[2],h=f[3];d[f[1]]=g.add,h&&g.add(function(){c=h},b[a^1][2].disable,b[2][2].lock),e[f[0]]=g.fire,e[f[0]+"With"]=g.fireWith}),d.promise(e),a&&a.call(e,e),e},when:function(a){var b=0,c=k.call(arguments),d=c.length,e=d!==1||a&&p.isFunction(a.promise)?d:0,f=e===1?a:p.Deferred(),g=function(a,b,c){return function(d){b[a]=this,c[a]=arguments.length>1?k.call(arguments):d,c===h?f.notifyWith(b,c):--e||f.resolveWith(b,c)}},h,i,j;if(d>1){h=new Array(d),i=new Array(d),j=new Array(d);for(;b<d;b++){c[b]&&p.isFunction(c[b].promise)?c[b].promise().done(g(b,j,c)).fail(f.reject).progress(g(b,i,h)):--e}}return e||f.resolveWith(j,c),f.promise()}}),p.support=function(){var b,c,d,f,g,h,i,j,k,l,m,n=e.createElement("div");n.setAttribute("className","t"),n.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",c=n.getElementsByTagName("*"),d=n.getElementsByTagName("a")[0],d.style.cssText="top:1px;float:left;opacity:.5";if(!c||!c.length||!d){return{}}f=e.createElement("select"),g=f.appendChild(e.createElement("option")),h=n.getElementsByTagName("input")[0],b={leadingWhitespace:n.firstChild.nodeType===3,tbody:!n.getElementsByTagName("tbody").length,htmlSerialize:!!n.getElementsByTagName("link").length,style:/top/.test(d.getAttribute("style")),hrefNormalized:d.getAttribute("href")==="/a",opacity:/^0.5/.test(d.style.opacity),cssFloat:!!d.style.cssFloat,checkOn:h.value==="on",optSelected:g.selected,getSetAttribute:n.className!=="t",enctype:!!e.createElement("form").enctype,html5Clone:e.createElement("nav").cloneNode(!0).outerHTML!=="<:nav></:nav>",boxModel:e.compatMode==="CSS1Compat",submitBubbles:!0,changeBubbles:!0,focusinBubbles:!1,deleteExpando:!0,noCloneEvent:!0,inlineBlockNeedsLayout:!1,shrinkWrapBlocks:!1,reliableMarginRight:!0,boxSizingReliable:!0,pixelPosition:!1},h.checked=!0,b.noCloneChecked=h.cloneNode(!0).checked,f.disabled=!0,b.optDisabled=!g.disabled;try{delete n.test}catch(o){b.deleteExpando=!1}!n.addEventListener&&n.attachEvent&&n.fireEvent&&(n.attachEvent("onclick",m=function(){b.noCloneEvent=!1}),n.cloneNode(!0).fireEvent("onclick"),n.detachEvent("onclick",m)),h=e.createElement("input"),h.value="t",h.setAttribute("type","radio"),b.radioValue=h.value==="t",h.setAttribute("checked","checked"),h.setAttribute("name","t"),n.appendChild(h),i=e.createDocumentFragment(),i.appendChild(n.lastChild),b.checkClone=i.cloneNode(!0).cloneNode(!0).lastChild.checked,b.appendChecked=h.checked,i.removeChild(h),i.appendChild(n);if(n.attachEvent){for(k in {submit:!0,change:!0,focusin:!0}){j="on"+k,l=j in n,l||(n.setAttribute(j,"return;"),l=typeof n[j]=="function"),b[k+"Bubbles"]=l}}return p(function(){var c,d,f,g,h="padding:0;margin:0;border:0;display:block;overflow:hidden;",i=e.getElementsByTagName("body")[0];if(!i){return}c=e.createElement("div"),c.style.cssText="visibility:hidden;border:0;width:0;height:0;position:static;top:0;margin-top:1px",i.insertBefore(c,i.firstChild),d=e.createElement("div"),c.appendChild(d),d.innerHTML="<table><tr><td></td><td>t</td></tr></table>",f=d.getElementsByTagName("td"),f[0].style.cssText="padding:0;margin:0;border:0;display:none",l=f[0].offsetHeight===0,f[0].style.display="",f[1].style.display="none",b.reliableHiddenOffsets=l&&f[0].offsetHeight===0,d.innerHTML="",d.style.cssText="box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%;",b.boxSizing=d.offsetWidth===4,b.doesNotIncludeMarginInBodyOffset=i.offsetTop!==1,a.getComputedStyle&&(b.pixelPosition=(a.getComputedStyle(d,null)||{}).top!=="1%",b.boxSizingReliable=(a.getComputedStyle(d,null)||{width:"4px"}).width==="4px",g=e.createElement("div"),g.style.cssText=d.style.cssText=h,g.style.marginRight=g.style.width="0",d.style.width="1px",d.appendChild(g),b.reliableMarginRight=!parseFloat((a.getComputedStyle(g,null)||{}).marginRight)),typeof d.style.zoom!="undefined"&&(d.innerHTML="",d.style.cssText=h+"width:1px;padding:1px;display:inline;zoom:1",b.inlineBlockNeedsLayout=d.offsetWidth===3,d.style.display="block",d.style.overflow="visible",d.innerHTML="<div></div>",d.firstChild.style.width="5px",b.shrinkWrapBlocks=d.offsetWidth!==3,c.style.zoom=1),i.removeChild(c),c=d=f=g=null}),i.removeChild(n),c=d=f=g=h=i=n=null,b}();var H=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,I=/([A-Z])/g;p.extend({cache:{},deletedIds:[],uuid:0,expando:"jQuery"+(p.fn.jquery+Math.random()).replace(/\D/g,""),noData:{embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:!0},hasData:function(a){return a=a.nodeType?p.cache[a[p.expando]]:a[p.expando],!!a&&!K(a)},data:function(a,c,d,e){if(!p.acceptData(a)){return}var f,g,h=p.expando,i=typeof c=="string",j=a.nodeType,k=j?p.cache:a,l=j?a[h]:a[h]&&h;if((!l||!k[l]||!e&&!k[l].data)&&i&&d===b){return}l||(j?a[h]=l=p.deletedIds.pop()||++p.uuid:l=h),k[l]||(k[l]={},j||(k[l].toJSON=p.noop));if(typeof c=="object"||typeof c=="function"){e?k[l]=p.extend(k[l],c):k[l].data=p.extend(k[l].data,c)}return f=k[l],e||(f.data||(f.data={}),f=f.data),d!==b&&(f[p.camelCase(c)]=d),i?(g=f[c],g==null&&(g=f[p.camelCase(c)])):g=f,g},removeData:function(a,b,c){if(!p.acceptData(a)){return}var d,e,f,g=a.nodeType,h=g?p.cache:a,i=g?a[p.expando]:p.expando;if(!h[i]){return}if(b){d=c?h[i]:h[i].data;if(d){p.isArray(b)||(b in d?b=[b]:(b=p.camelCase(b),b in d?b=[b]:b=b.split(" ")));for(e=0,f=b.length;e<f;e++){delete d[b[e]]}if(!(c?K:p.isEmptyObject)(d)){return}}}if(!c){delete h[i].data;if(!K(h[i])){return}}g?p.cleanData([a],!0):p.support.deleteExpando||h!=h.window?delete h[i]:h[i]=null},_data:function(a,b,c){return p.data(a,b,c,!0)},acceptData:function(a){var b=a.nodeName&&p.noData[a.nodeName.toLowerCase()];return !b||b!==!0&&a.getAttribute("classid")===b}}),p.fn.extend({data:function(a,c){var d,e,f,g,h,i=this[0],j=0,k=null;if(a===b){if(this.length){k=p.data(i);if(i.nodeType===1&&!p._data(i,"parsedAttrs")){f=i.attributes;for(h=f.length;j<h;j++){g=f[j].name,g.indexOf("data-")===0&&(g=p.camelCase(g.substring(5)),J(i,g,k[g]))}p._data(i,"parsedAttrs",!0)}}return k}return typeof a=="object"?this.each(function(){p.data(this,a)}):(d=a.split(".",2),d[1]=d[1]?"."+d[1]:"",e=d[1]+"!",p.access(this,function(c){if(c===b){return k=this.triggerHandler("getData"+e,[d[0]]),k===b&&i&&(k=p.data(i,a),k=J(i,a,k)),k===b&&d[1]?this.data(d[0]):k}d[1]=c,this.each(function(){var b=p(this);b.triggerHandler("setData"+e,d),p.data(this,a,c),b.triggerHandler("changeData"+e,d)})},null,c,arguments.length>1,null,!1))},removeData:function(a){return this.each(function(){p.removeData(this,a)})}}),p.extend({queue:function(a,b,c){var d;if(a){return b=(b||"fx")+"queue",d=p._data(a,b),c&&(!d||p.isArray(c)?d=p._data(a,b,p.makeArray(c)):d.push(c)),d||[]}},dequeue:function(a,b){b=b||"fx";var c=p.queue(a,b),d=c.length,e=c.shift(),f=p._queueHooks(a,b),g=function(){p.dequeue(a,b)};e==="inprogress"&&(e=c.shift(),d--),e&&(b==="fx"&&c.unshift("inprogress"),delete f.stop,e.call(a,g,f)),!d&&f&&f.empty.fire()},_queueHooks:function(a,b){var c=b+"queueHooks";return p._data(a,c)||p._data(a,c,{empty:p.Callbacks("once memory").add(function(){p.removeData(a,b+"queue",!0),p.removeData(a,c,!0)})})}}),p.fn.extend({queue:function(a,c){var d=2;return typeof a!="string"&&(c=a,a="fx",d--),arguments.length<d?p.queue(this[0],a):c===b?this:this.each(function(){var b=p.queue(this,a,c);p._queueHooks(this,a),a==="fx"&&b[0]!=="inprogress"&&p.dequeue(this,a)})},dequeue:function(a){return this.each(function(){p.dequeue(this,a)})},delay:function(a,b){return a=p.fx?p.fx.speeds[a]||a:a,b=b||"fx",this.queue(b,function(b,c){var d=setTimeout(b,a);c.stop=function(){clearTimeout(d)}})},clearQueue:function(a){return this.queue(a||"fx",[])},promise:function(a,c){var d,e=1,f=p.Deferred(),g=this,h=this.length,i=function(){--e||f.resolveWith(g,[g])};typeof a!="string"&&(c=a,a=b),a=a||"fx";while(h--){d=p._data(g[h],a+"queueHooks"),d&&d.empty&&(e++,d.empty.add(i))}return i(),f.promise(c)}});var L,M,N,O=/[\t\r\n]/g,P=/\r/g,Q=/^(?:button|input)$/i,R=/^(?:button|input|object|select|textarea)$/i,S=/^a(?:rea|)$/i,T=/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,U=p.support.getSetAttribute;p.fn.extend({attr:function(a,b){return p.access(this,p.attr,a,b,arguments.length>1)},removeAttr:function(a){return this.each(function(){p.removeAttr(this,a)})},prop:function(a,b){return p.access(this,p.prop,a,b,arguments.length>1)},removeProp:function(a){return a=p.propFix[a]||a,this.each(function(){try{this[a]=b,delete this[a]}catch(c){}})},addClass:function(a){var b,c,d,e,f,g,h;if(p.isFunction(a)){return this.each(function(b){p(this).addClass(a.call(this,b,this.className))})}if(a&&typeof a=="string"){b=a.split(s);for(c=0,d=this.length;c<d;c++){e=this[c];if(e.nodeType===1){if(!e.className&&b.length===1){e.className=a}else{f=" "+e.className+" ";for(g=0,h=b.length;g<h;g++){~f.indexOf(" "+b[g]+" ")||(f+=b[g]+" ")}e.className=p.trim(f)}}}}return this},removeClass:function(a){var c,d,e,f,g,h,i;if(p.isFunction(a)){return this.each(function(b){p(this).removeClass(a.call(this,b,this.className))})}if(a&&typeof a=="string"||a===b){c=(a||"").split(s);for(h=0,i=this.length;h<i;h++){e=this[h];if(e.nodeType===1&&e.className){d=(" "+e.className+" ").replace(O," ");for(f=0,g=c.length;f<g;f++){while(d.indexOf(" "+c[f]+" ")>-1){d=d.replace(" "+c[f]+" "," ")}}e.className=a?p.trim(d):""}}}return this},toggleClass:function(a,b){var c=typeof a,d=typeof b=="boolean";return p.isFunction(a)?this.each(function(c){p(this).toggleClass(a.call(this,c,this.className,b),b)}):this.each(function(){if(c==="string"){var e,f=0,g=p(this),h=b,i=a.split(s);while(e=i[f++]){h=d?h:!g.hasClass(e),g[h?"addClass":"removeClass"](e)}}else{if(c==="undefined"||c==="boolean"){this.className&&p._data(this,"__className__",this.className),this.className=this.className||a===!1?"":p._data(this,"__className__")||""}}})},hasClass:function(a){var b=" "+a+" ",c=0,d=this.length;for(;c<d;c++){if(this[c].nodeType===1&&(" "+this[c].className+" ").replace(O," ").indexOf(b)>-1){return !0}}return !1},val:function(a){var c,d,e,f=this[0];if(!arguments.length){if(f){return c=p.valHooks[f.type]||p.valHooks[f.nodeName.toLowerCase()],c&&"get" in c&&(d=c.get(f,"value"))!==b?d:(d=f.value,typeof d=="string"?d.replace(P,""):d==null?"":d)}return}return e=p.isFunction(a),this.each(function(d){var f,g=p(this);if(this.nodeType!==1){return}e?f=a.call(this,d,g.val()):f=a,f==null?f="":typeof f=="number"?f+="":p.isArray(f)&&(f=p.map(f,function(a){return a==null?"":a+""})),c=p.valHooks[this.type]||p.valHooks[this.nodeName.toLowerCase()];if(!c||!("set" in c)||c.set(this,f,"value")===b){this.value=f}})}}),p.extend({valHooks:{option:{get:function(a){var b=a.attributes.value;return !b||b.specified?a.value:a.text}},select:{get:function(a){var b,c,d,e,f=a.selectedIndex,g=[],h=a.options,i=a.type==="select-one";if(f<0){return null}c=i?f:0,d=i?f+1:h.length;for(;c<d;c++){e=h[c];if(e.selected&&(p.support.optDisabled?!e.disabled:e.getAttribute("disabled")===null)&&(!e.parentNode.disabled||!p.nodeName(e.parentNode,"optgroup"))){b=p(e).val();if(i){return b}g.push(b)}}return i&&!g.length&&h.length?p(h[f]).val():g},set:function(a,b){var c=p.makeArray(b);return p(a).find("option").each(function(){this.selected=p.inArray(p(this).val(),c)>=0}),c.length||(a.selectedIndex=-1),c}}},attrFn:{},attr:function(a,c,d,e){var f,g,h,i=a.nodeType;if(!a||i===3||i===8||i===2){return}if(e&&p.isFunction(p.fn[c])){return p(a)[c](d)}if(typeof a.getAttribute=="undefined"){return p.prop(a,c,d)}h=i!==1||!p.isXMLDoc(a),h&&(c=c.toLowerCase(),g=p.attrHooks[c]||(T.test(c)?M:L));if(d!==b){if(d===null){p.removeAttr(a,c);return}return g&&"set" in g&&h&&(f=g.set(a,d,c))!==b?f:(a.setAttribute(c,""+d),d)}return g&&"get" in g&&h&&(f=g.get(a,c))!==null?f:(f=a.getAttribute(c),f===null?b:f)},removeAttr:function(a,b){var c,d,e,f,g=0;if(b&&a.nodeType===1){d=b.split(s);for(;g<d.length;g++){e=d[g],e&&(c=p.propFix[e]||e,f=T.test(e),f||p.attr(a,e,""),a.removeAttribute(U?e:c),f&&c in a&&(a[c]=!1))}}},attrHooks:{type:{set:function(a,b){if(Q.test(a.nodeName)&&a.parentNode){p.error("type property can't be changed")}else{if(!p.support.radioValue&&b==="radio"&&p.nodeName(a,"input")){var c=a.value;return a.setAttribute("type",b),c&&(a.value=c),b}}}},value:{get:function(a,b){return L&&p.nodeName(a,"button")?L.get(a,b):b in a?a.value:null},set:function(a,b,c){if(L&&p.nodeName(a,"button")){return L.set(a,b,c)}a.value=b}}},propFix:{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},prop:function(a,c,d){var e,f,g,h=a.nodeType;if(!a||h===3||h===8||h===2){return}return g=h!==1||!p.isXMLDoc(a),g&&(c=p.propFix[c]||c,f=p.propHooks[c]),d!==b?f&&"set" in f&&(e=f.set(a,d,c))!==b?e:a[c]=d:f&&"get" in f&&(e=f.get(a,c))!==null?e:a[c]},propHooks:{tabIndex:{get:function(a){var c=a.getAttributeNode("tabindex");return c&&c.specified?parseInt(c.value,10):R.test(a.nodeName)||S.test(a.nodeName)&&a.href?0:b}}}}),M={get:function(a,c){var d,e=p.prop(a,c);return e===!0||typeof e!="boolean"&&(d=a.getAttributeNode(c))&&d.nodeValue!==!1?c.toLowerCase():b},set:function(a,b,c){var d;return b===!1?p.removeAttr(a,c):(d=p.propFix[c]||c,d in a&&(a[d]=!0),a.setAttribute(c,c.toLowerCase())),c}},U||(N={name:!0,id:!0,coords:!0},L=p.valHooks.button={get:function(a,c){var d;return d=a.getAttributeNode(c),d&&(N[c]?d.value!=="":d.specified)?d.value:b},set:function(a,b,c){var d=a.getAttributeNode(c);return d||(d=e.createAttribute(c),a.setAttributeNode(d)),d.value=b+""}},p.each(["width","height"],function(a,b){p.attrHooks[b]=p.extend(p.attrHooks[b],{set:function(a,c){if(c===""){return a.setAttribute(b,"auto"),c}}})}),p.attrHooks.contenteditable={get:L.get,set:function(a,b,c){b===""&&(b="false"),L.set(a,b,c)}}),p.support.hrefNormalized||p.each(["href","src","width","height"],function(a,c){p.attrHooks[c]=p.extend(p.attrHooks[c],{get:function(a){var d=a.getAttribute(c,2);return d===null?b:d}})}),p.support.style||(p.attrHooks.style={get:function(a){return a.style.cssText.toLowerCase()||b},set:function(a,b){return a.style.cssText=""+b}}),p.support.optSelected||(p.propHooks.selected=p.extend(p.propHooks.selected,{get:function(a){var b=a.parentNode;return b&&(b.selectedIndex,b.parentNode&&b.parentNode.selectedIndex),null}})),p.support.enctype||(p.propFix.enctype="encoding"),p.support.checkOn||p.each(["radio","checkbox"],function(){p.valHooks[this]={get:function(a){return a.getAttribute("value")===null?"on":a.value}}}),p.each(["radio","checkbox"],function(){p.valHooks[this]=p.extend(p.valHooks[this],{set:function(a,b){if(p.isArray(b)){return a.checked=p.inArray(p(a).val(),b)>=0}}})});var V=/^(?:textarea|input|select)$/i,W=/^([^\.]*|)(?:\.(.+)|)$/,X=/(?:^|\s)hover(\.\S+|)\b/,Y=/^key/,Z=/^(?:mouse|contextmenu)|click/,$=/^(?:focusinfocus|focusoutblur)$/,_=function(a){return p.event.special.hover?a:a.replace(X,"mouseenter$1 mouseleave$1")};p.event={add:function(a,c,d,e,f){var g,h,i,j,k,l,m,n,o,q,r;if(a.nodeType===3||a.nodeType===8||!c||!d||!(g=p._data(a))){return}d.handler&&(o=d,d=o.handler,f=o.selector),d.guid||(d.guid=p.guid++),i=g.events,i||(g.events=i={}),h=g.handle,h||(g.handle=h=function(a){return typeof p!="undefined"&&(!a||p.event.triggered!==a.type)?p.event.dispatch.apply(h.elem,arguments):b},h.elem=a),c=p.trim(_(c)).split(" ");for(j=0;j<c.length;j++){k=W.exec(c[j])||[],l=k[1],m=(k[2]||"").split(".").sort(),r=p.event.special[l]||{},l=(f?r.delegateType:r.bindType)||l,r=p.event.special[l]||{},n=p.extend({type:l,origType:k[1],data:e,handler:d,guid:d.guid,selector:f,namespace:m.join(".")},o),q=i[l];if(!q){q=i[l]=[],q.delegateCount=0;if(!r.setup||r.setup.call(a,e,m,h)===!1){a.addEventListener?a.addEventListener(l,h,!1):a.attachEvent&&a.attachEvent("on"+l,h)}}r.add&&(r.add.call(a,n),n.handler.guid||(n.handler.guid=d.guid)),f?q.splice(q.delegateCount++,0,n):q.push(n),p.event.global[l]=!0}a=null},global:{},remove:function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,q,r=p.hasData(a)&&p._data(a);if(!r||!(m=r.events)){return}b=p.trim(_(b||"")).split(" ");for(f=0;f<b.length;f++){g=W.exec(b[f])||[],h=i=g[1],j=g[2];if(!h){for(h in m){p.event.remove(a,h+b[f],c,d,!0)}continue}n=p.event.special[h]||{},h=(d?n.delegateType:n.bindType)||h,o=m[h]||[],k=o.length,j=j?new RegExp("(^|\\.)"+j.split(".").sort().join("\\.(?:.*\\.|)")+"(\\.|$)"):null;for(l=0;l<o.length;l++){q=o[l],(e||i===q.origType)&&(!c||c.guid===q.guid)&&(!j||j.test(q.namespace))&&(!d||d===q.selector||d==="**"&&q.selector)&&(o.splice(l--,1),q.selector&&o.delegateCount--,n.remove&&n.remove.call(a,q))}o.length===0&&k!==o.length&&((!n.teardown||n.teardown.call(a,j,r.handle)===!1)&&p.removeEvent(a,h,r.handle),delete m[h])}p.isEmptyObject(m)&&(delete r.handle,p.removeData(a,"events",!0))},customEvent:{getData:!0,setData:!0,changeData:!0},trigger:function(c,d,f,g){if(!f||f.nodeType!==3&&f.nodeType!==8){var h,i,j,k,l,m,n,o,q,r,s=c.type||c,t=[];if($.test(s+p.event.triggered)){return}s.indexOf("!")>=0&&(s=s.slice(0,-1),i=!0),s.indexOf(".")>=0&&(t=s.split("."),s=t.shift(),t.sort());if((!f||p.event.customEvent[s])&&!p.event.global[s]){return}c=typeof c=="object"?c[p.expando]?c:new p.Event(s,c):new p.Event(s),c.type=s,c.isTrigger=!0,c.exclusive=i,c.namespace=t.join("."),c.namespace_re=c.namespace?new RegExp("(^|\\.)"+t.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,m=s.indexOf(":")<0?"on"+s:"";if(!f){h=p.cache;for(j in h){h[j].events&&h[j].events[s]&&p.event.trigger(c,d,h[j].handle.elem,!0)}return}c.result=b,c.target||(c.target=f),d=d!=null?p.makeArray(d):[],d.unshift(c),n=p.event.special[s]||{};if(n.trigger&&n.trigger.apply(f,d)===!1){return}q=[[f,n.bindType||s]];if(!g&&!n.noBubble&&!p.isWindow(f)){r=n.delegateType||s,k=$.test(r+s)?f:f.parentNode;for(l=f;k;k=k.parentNode){q.push([k,r]),l=k}l===(f.ownerDocument||e)&&q.push([l.defaultView||l.parentWindow||a,r])}for(j=0;j<q.length&&!c.isPropagationStopped();j++){k=q[j][0],c.type=q[j][1],o=(p._data(k,"events")||{})[c.type]&&p._data(k,"handle"),o&&o.apply(k,d),o=m&&k[m],o&&p.acceptData(k)&&o.apply(k,d)===!1&&c.preventDefault()}return c.type=s,!g&&!c.isDefaultPrevented()&&(!n._default||n._default.apply(f.ownerDocument,d)===!1)&&(s!=="click"||!p.nodeName(f,"a"))&&p.acceptData(f)&&m&&f[s]&&(s!=="focus"&&s!=="blur"||c.target.offsetWidth!==0)&&!p.isWindow(f)&&(l=f[m],l&&(f[m]=null),p.event.triggered=s,f[s](),p.event.triggered=b,l&&(f[m]=l)),c.result}return},dispatch:function(c){c=p.event.fix(c||a.event);var d,e,f,g,h,i,j,k,l,m,n=(p._data(this,"events")||{})[c.type]||[],o=n.delegateCount,q=[].slice.call(arguments),r=!c.exclusive&&!c.namespace,s=p.event.special[c.type]||{},t=[];q[0]=c,c.delegateTarget=this;if(s.preDispatch&&s.preDispatch.call(this,c)===!1){return}if(o&&(!c.button||c.type!=="click")){for(f=c.target;f!=this;f=f.parentNode||this){if(f.disabled!==!0||c.type!=="click"){h={},j=[];for(d=0;d<o;d++){k=n[d],l=k.selector,h[l]===b&&(h[l]=p(l,this).index(f)>=0),h[l]&&j.push(k)}j.length&&t.push({elem:f,matches:j})}}}n.length>o&&t.push({elem:this,matches:n.slice(o)});for(d=0;d<t.length&&!c.isPropagationStopped();d++){i=t[d],c.currentTarget=i.elem;for(e=0;e<i.matches.length&&!c.isImmediatePropagationStopped();e++){k=i.matches[e];if(r||!c.namespace&&!k.namespace||c.namespace_re&&c.namespace_re.test(k.namespace)){c.data=k.data,c.handleObj=k,g=((p.event.special[k.origType]||{}).handle||k.handler).apply(i.elem,q),g!==b&&(c.result=g,g===!1&&(c.preventDefault(),c.stopPropagation()))}}}return s.postDispatch&&s.postDispatch.call(this,c),c.result},props:"attrChange attrName relatedNode srcElement altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(a,b){return a.which==null&&(a.which=b.charCode!=null?b.charCode:b.keyCode),a}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(a,c){var d,f,g,h=c.button,i=c.fromElement;return a.pageX==null&&c.clientX!=null&&(d=a.target.ownerDocument||e,f=d.documentElement,g=d.body,a.pageX=c.clientX+(f&&f.scrollLeft||g&&g.scrollLeft||0)-(f&&f.clientLeft||g&&g.clientLeft||0),a.pageY=c.clientY+(f&&f.scrollTop||g&&g.scrollTop||0)-(f&&f.clientTop||g&&g.clientTop||0)),!a.relatedTarget&&i&&(a.relatedTarget=i===a.target?c.toElement:i),!a.which&&h!==b&&(a.which=h&1?1:h&2?3:h&4?2:0),a}},fix:function(a){if(a[p.expando]){return a}var b,c,d=a,f=p.event.fixHooks[a.type]||{},g=f.props?this.props.concat(f.props):this.props;a=p.Event(d);for(b=g.length;b;){c=g[--b],a[c]=d[c]}return a.target||(a.target=d.srcElement||e),a.target.nodeType===3&&(a.target=a.target.parentNode),a.metaKey=!!a.metaKey,f.filter?f.filter(a,d):a},special:{load:{noBubble:!0},focus:{delegateType:"focusin"},blur:{delegateType:"focusout"},beforeunload:{setup:function(a,b,c){p.isWindow(this)&&(this.onbeforeunload=c)},teardown:function(a,b){this.onbeforeunload===b&&(this.onbeforeunload=null)}}},simulate:function(a,b,c,d){var e=p.extend(new p.Event,c,{type:a,isSimulated:!0,originalEvent:{}});d?p.event.trigger(e,null,b):p.event.dispatch.call(b,e),e.isDefaultPrevented()&&c.preventDefault()}},p.event.handle=p.event.dispatch,p.removeEvent=e.removeEventListener?function(a,b,c){a.removeEventListener&&a.removeEventListener(b,c,!1)}:function(a,b,c){var d="on"+b;a.detachEvent&&(typeof a[d]=="undefined"&&(a[d]=null),a.detachEvent(d,c))},p.Event=function(a,b){if(this instanceof p.Event){a&&a.type?(this.originalEvent=a,this.type=a.type,this.isDefaultPrevented=a.defaultPrevented||a.returnValue===!1||a.getPreventDefault&&a.getPreventDefault()?bb:ba):this.type=a,b&&p.extend(this,b),this.timeStamp=a&&a.timeStamp||p.now(),this[p.expando]=!0}else{return new p.Event(a,b)}},p.Event.prototype={preventDefault:function(){this.isDefaultPrevented=bb;var a=this.originalEvent;if(!a){return}a.preventDefault?a.preventDefault():a.returnValue=!1},stopPropagation:function(){this.isPropagationStopped=bb;var a=this.originalEvent;if(!a){return}a.stopPropagation&&a.stopPropagation(),a.cancelBubble=!0},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=bb,this.stopPropagation()},isDefaultPrevented:ba,isPropagationStopped:ba,isImmediatePropagationStopped:ba},p.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(a,b){p.event.special[a]={delegateType:b,bindType:b,handle:function(a){var c,d=this,e=a.relatedTarget,f=a.handleObj,g=f.selector;if(!e||e!==d&&!p.contains(d,e)){a.type=f.origType,c=f.handler.apply(this,arguments),a.type=b}return c}}}),p.support.submitBubbles||(p.event.special.submit={setup:function(){if(p.nodeName(this,"form")){return !1}p.event.add(this,"click._submit keypress._submit",function(a){var c=a.target,d=p.nodeName(c,"input")||p.nodeName(c,"button")?c.form:b;d&&!p._data(d,"_submit_attached")&&(p.event.add(d,"submit._submit",function(a){a._submit_bubble=!0}),p._data(d,"_submit_attached",!0))})},postDispatch:function(a){a._submit_bubble&&(delete a._submit_bubble,this.parentNode&&!a.isTrigger&&p.event.simulate("submit",this.parentNode,a,!0))},teardown:function(){if(p.nodeName(this,"form")){return !1}p.event.remove(this,"._submit")}}),p.support.changeBubbles||(p.event.special.change={setup:function(){if(V.test(this.nodeName)){if(this.type==="checkbox"||this.type==="radio"){p.event.add(this,"propertychange._change",function(a){a.originalEvent.propertyName==="checked"&&(this._just_changed=!0)}),p.event.add(this,"click._change",function(a){this._just_changed&&!a.isTrigger&&(this._just_changed=!1),p.event.simulate("change",this,a,!0)})}return !1}p.event.add(this,"beforeactivate._change",function(a){var b=a.target;V.test(b.nodeName)&&!p._data(b,"_change_attached")&&(p.event.add(b,"change._change",function(a){this.parentNode&&!a.isSimulated&&!a.isTrigger&&p.event.simulate("change",this.parentNode,a,!0)}),p._data(b,"_change_attached",!0))})},handle:function(a){var b=a.target;if(this!==b||a.isSimulated||a.isTrigger||b.type!=="radio"&&b.type!=="checkbox"){return a.handleObj.handler.apply(this,arguments)}},teardown:function(){return p.event.remove(this,"._change"),!V.test(this.nodeName)}}),p.support.focusinBubbles||p.each({focus:"focusin",blur:"focusout"},function(a,b){var c=0,d=function(a){p.event.simulate(b,a.target,p.event.fix(a),!0)};p.event.special[b]={setup:function(){c++===0&&e.addEventListener(a,d,!0)},teardown:function(){--c===0&&e.removeEventListener(a,d,!0)}}}),p.fn.extend({on:function(a,c,d,e,f){var g,h;if(typeof a=="object"){typeof c!="string"&&(d=d||c,c=b);for(h in a){this.on(h,c,d,a[h],f)}return this}d==null&&e==null?(e=c,d=c=b):e==null&&(typeof c=="string"?(e=d,d=b):(e=d,d=c,c=b));if(e===!1){e=ba}else{if(!e){return this}}return f===1&&(g=e,e=function(a){return p().off(a),g.apply(this,arguments)},e.guid=g.guid||(g.guid=p.guid++)),this.each(function(){p.event.add(this,a,e,d,c)})},one:function(a,b,c,d){return this.on(a,b,c,d,1)},off:function(a,c,d){var e,f;if(a&&a.preventDefault&&a.handleObj){return e=a.handleObj,p(a.delegateTarget).off(e.namespace?e.origType+"."+e.namespace:e.origType,e.selector,e.handler),this}if(typeof a=="object"){for(f in a){this.off(f,c,a[f])}return this}if(c===!1||typeof c=="function"){d=c,c=b}return d===!1&&(d=ba),this.each(function(){p.event.remove(this,a,d,c)})},bind:function(a,b,c){return this.on(a,null,b,c)},unbind:function(a,b){return this.off(a,null,b)},live:function(a,b,c){return p(this.context).on(a,this.selector,b,c),this},die:function(a,b){return p(this.context).off(a,this.selector||"**",b),this},delegate:function(a,b,c,d){return this.on(b,a,c,d)},undelegate:function(a,b,c){return arguments.length==1?this.off(a,"**"):this.off(b,a||"**",c)},trigger:function(a,b){return this.each(function(){p.event.trigger(a,b,this)})},triggerHandler:function(a,b){if(this[0]){return p.event.trigger(a,b,this[0],!0)}},toggle:function(a){var b=arguments,c=a.guid||p.guid++,d=0,e=function(c){var e=(p._data(this,"lastToggle"+a.guid)||0)%d;return p._data(this,"lastToggle"+a.guid,e+1),c.preventDefault(),b[e].apply(this,arguments)||!1};e.guid=c;while(d<b.length){b[d++].guid=c}return this.click(e)},hover:function(a,b){return this.mouseenter(a).mouseleave(b||a)}}),p.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(a,b){p.fn[b]=function(a,c){return c==null&&(c=a,a=null),arguments.length>0?this.on(b,null,a,c):this.trigger(b)},Y.test(b)&&(p.event.fixHooks[b]=p.event.keyHooks),Z.test(b)&&(p.event.fixHooks[b]=p.event.mouseHooks)}),function(a,b){function $(a,b,c,d){c=c||[],b=b||q;var e,f,g,j,k=b.nodeType;if(k!==1&&k!==9){return[]}if(!a||typeof a!="string"){return c}g=h(b);if(!g&&!d){if(e=L.exec(a)){if(j=e[1]){if(k===9){f=b.getElementById(j);if(!f||!f.parentNode){return c}if(f.id===j){return c.push(f),c}}else{if(b.ownerDocument&&(f=b.ownerDocument.getElementById(j))&&i(b,f)&&f.id===j){return c.push(f),c}}}else{if(e[2]){return u.apply(c,t.call(b.getElementsByTagName(a),0)),c}if((j=e[3])&&X&&b.getElementsByClassName){return u.apply(c,t.call(b.getElementsByClassName(j),0)),c}}}}return bk(a,b,c,d,g)}function _(a){return function(b){var c=b.nodeName.toLowerCase();return c==="input"&&b.type===a}}function ba(a){return function(b){var c=b.nodeName.toLowerCase();return(c==="input"||c==="button")&&b.type===a}}function bb(a,b,c){if(a===b){return c}var d=a.nextSibling;while(d){if(d===b){return -1}d=d.nextSibling}return 1}function bc(a,b,c,d){var e,g,h,i,j,k,l,m,n,p,r=!c&&b!==q,s=(r?"<s>":"")+a.replace(H,"$1<s>"),u=y[o][s];if(u){return d?0:t.call(u,0)}j=a,k=[],m=0,n=f.preFilter,p=f.filter;while(j){if(!e||(g=I.exec(j))){g&&(j=j.slice(g[0].length),h.selector=l),k.push(h=[]),l="",r&&(j=" "+j)}e=!1;if(g=J.exec(j)){l+=g[0],j=j.slice(g[0].length),e=h.push({part:g.pop().replace(H," "),string:g[0],captures:g})}for(i in p){(g=S[i].exec(j))&&(!n[i]||(g=n[i](g,b,c)))&&(l+=g[0],j=j.slice(g[0].length),e=h.push({part:i,string:g.shift(),captures:g}))}if(!e){break}}return l&&(h.selector=l),d?j.length:j?$.error(a):t.call(y(s,k),0)}function bd(a,b,e,f){var g=b.dir,h=s++;return a||(a=function(a){return a===e}),b.first?function(b){while(b=b[g]){if(b.nodeType===1){return a(b)&&b}}}:f?function(b){while(b=b[g]){if(b.nodeType===1&&a(b)){return b}}}:function(b){var e,f=h+"."+c,i=f+"."+d;while(b=b[g]){if(b.nodeType===1){if((e=b[o])===i){return b.sizset}if(typeof e=="string"&&e.indexOf(f)===0){if(b.sizset){return b}}else{b[o]=i;if(a(b)){return b.sizset=!0,b}b.sizset=!1}}}}}function be(a,b){return a?function(c){var d=b(c);return d&&a(d===!0?c:d)}:b}function bf(a,b,c){var d,e,g=0;for(;d=a[g];g++){f.relative[d.part]?e=bd(e,f.relative[d.part],b,c):e=be(e,f.filter[d.part].apply(null,d.captures.concat(b,c)))}return e}function bg(a){return function(b){var c,d=0;for(;c=a[d];d++){if(c(b)){return !0}}return !1}}function bh(a,b,c,d){var e=0,f=b.length;for(;e<f;e++){$(a,b[e],c,d)}}function bi(a,b,c,d,e,g){var h,i=f.setFilters[b.toLowerCase()];return i||$.error(b),(a||!(h=e))&&bh(a||"*",d,h=[],e),h.length>0?i(h,c,g):[]}function bj(a,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q,r,s=0,t=a.length,v=S.POS,w=new RegExp("^"+v.source+"(?!"+A+")","i"),x=function(){var a=1,c=arguments.length-2;for(;a<c;a++){arguments[a]===b&&(n[a]=b)}};for(;s<t;s++){f=a[s],g="",m=e;for(h=0,i=f.length;h<i;h++){j=f[h],k=j.string;if(j.part==="PSEUDO"){v.exec(""),l=0;while(n=v.exec(k)){o=!0,p=v.lastIndex=n.index+n[0].length;if(p>l){g+=k.slice(l,n.index),l=p,q=[c],J.test(g)&&(m&&(q=m),m=e);if(r=O.test(g)){g=g.slice(0,-5).replace(J,"$&*"),l++}n.length>1&&n[0].replace(w,x),m=bi(g,n[1],n[2],q,m,r)}g=""}}o||(g+=k),o=!1}g?J.test(g)?bh(g,m||[c],d,e):$(g,c,d,e?e.concat(m):m):u.apply(d,m)}return t===1?d:$.uniqueSort(d)}function bk(a,b,e,g,h){a=a.replace(H,"$1");var i,k,l,m,n,o,p,q,r,s,v=bc(a,b,h),w=b.nodeType;if(S.POS.test(a)){return bj(v,b,e,g)}if(g){i=t.call(g,0)}else{if(v.length===1){if((o=t.call(v[0],0)).length>2&&(p=o[0]).part==="ID"&&w===9&&!h&&f.relative[o[1].part]){b=f.find.ID(p.captures[0].replace(R,""),b,h)[0];if(!b){return e}a=a.slice(o.shift().string.length)}r=(v=N.exec(o[0].string))&&!v.index&&b.parentNode||b,q="";for(n=o.length-1;n>=0;n--){p=o[n],s=p.part,q=p.string+q;if(f.relative[s]){break}if(f.order.test(s)){i=f.find[s](p.captures[0].replace(R,""),r,h);if(i==null){continue}a=a.slice(0,a.length-q.length)+q.replace(S[s],""),a||u.apply(e,t.call(i,0));break}}}}if(a){k=j(a,b,h),c=k.dirruns++,i==null&&(i=f.find.TAG("*",N.test(a)&&b.parentNode||b));for(n=0;m=i[n];n++){d=k.runs++,k(m)&&e.push(m)}}return e}var c,d,e,f,g,h,i,j,k,l,m=!0,n="undefined",o=("sizcache"+Math.random()).replace(".",""),q=a.document,r=q.documentElement,s=0,t=[].slice,u=[].push,v=function(a,b){return a[o]=b||!0,a},w=function(){var a={},b=[];return v(function(c,d){return b.push(c)>f.cacheLength&&delete a[b.shift()],a[c]=d},a)},x=w(),y=w(),z=w(),A="[\\x20\\t\\r\\n\\f]",B="(?:\\\\.|[-\\w]|[^\\x00-\\xa0])+",C=B.replace("w","w#"),D="([*^$|!~]?=)",E="\\["+A+"*("+B+")"+A+"*(?:"+D+A+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+C+")|)|)"+A+"*\\]",F=":("+B+")(?:\\((?:(['\"])((?:\\\\.|[^\\\\])*?)\\2|([^()[\\]]*|(?:(?:"+E+")|[^:]|\\\\.)*|.*))\\)|)",G=":(nth|eq|gt|lt|first|last|even|odd)(?:\\(((?:-\\d)?\\d*)\\)|)(?=[^-]|$)",H=new RegExp("^"+A+"+|((?:^|[^\\\\])(?:\\\\.)*)"+A+"+$","g"),I=new RegExp("^"+A+"*,"+A+"*"),J=new RegExp("^"+A+"*([\\x20\\t\\r\\n\\f>+~])"+A+"*"),K=new RegExp(F),L=/^(?:#([\w\-]+)|(\w+)|\.([\w\-]+))$/,M=/^:not/,N=/[\x20\t\r\n\f]*[+~]/,O=/:not\($/,P=/h\d/i,Q=/input|select|textarea|button/i,R=/\\(?!\\)/g,S={ID:new RegExp("^#("+B+")"),CLASS:new RegExp("^\\.("+B+")"),NAME:new RegExp("^\\[name=['\"]?("+B+")['\"]?\\]"),TAG:new RegExp("^("+B.replace("w","w*")+")"),ATTR:new RegExp("^"+E),PSEUDO:new RegExp("^"+F),CHILD:new RegExp("^:(only|nth|last|first)-child(?:\\("+A+"*(even|odd|(([+-]|)(\\d*)n|)"+A+"*(?:([+-]|)"+A+"*(\\d+)|))"+A+"*\\)|)","i"),POS:new RegExp(G,"ig"),needsContext:new RegExp("^"+A+"*[>+~]|"+G,"i")},T=function(a){var b=q.createElement("div");try{return a(b)}catch(c){return !1}finally{b=null}},U=T(function(a){return a.appendChild(q.createComment("")),!a.getElementsByTagName("*").length}),V=T(function(a){return a.innerHTML="<a href='#'></a>",a.firstChild&&typeof a.firstChild.getAttribute!==n&&a.firstChild.getAttribute("href")==="#"}),W=T(function(a){a.innerHTML="<select></select>";var b=typeof a.lastChild.getAttribute("multiple");return b!=="boolean"&&b!=="string"}),X=T(function(a){return a.innerHTML="<div class='hidden e'></div><div class='hidden'></div>",!a.getElementsByClassName||!a.getElementsByClassName("e").length?!1:(a.lastChild.className="e",a.getElementsByClassName("e").length===2)}),Y=T(function(a){a.id=o+0,a.innerHTML="<a name='"+o+"'></a><div name='"+o+"'></div>",r.insertBefore(a,r.firstChild);var b=q.getElementsByName&&q.getElementsByName(o).length===2+q.getElementsByName(o+0).length;return e=!q.getElementById(o),r.removeChild(a),b});try{t.call(r.childNodes,0)[0].nodeType}catch(Z){t=function(a){var b,c=[];for(;b=this[a];a++){c.push(b)}return c}}$.matches=function(a,b){return $(a,null,null,b)},$.matchesSelector=function(a,b){return $(b,null,null,[a]).length>0},g=$.getText=function(a){var b,c="",d=0,e=a.nodeType;if(e){if(e===1||e===9||e===11){if(typeof a.textContent=="string"){return a.textContent}for(a=a.firstChild;a;a=a.nextSibling){c+=g(a)}}else{if(e===3||e===4){return a.nodeValue}}}else{for(;b=a[d];d++){c+=g(b)}}return c},h=$.isXML=function(a){var b=a&&(a.ownerDocument||a).documentElement;return b?b.nodeName!=="HTML":!1},i=$.contains=r.contains?function(a,b){var c=a.nodeType===9?a.documentElement:a,d=b&&b.parentNode;return a===d||!!(d&&d.nodeType===1&&c.contains&&c.contains(d))}:r.compareDocumentPosition?function(a,b){return b&&!!(a.compareDocumentPosition(b)&16)}:function(a,b){while(b=b.parentNode){if(b===a){return !0}}return !1},$.attr=function(a,b){var c,d=h(a);return d||(b=b.toLowerCase()),f.attrHandle[b]?f.attrHandle[b](a):W||d?a.getAttribute(b):(c=a.getAttributeNode(b),c?typeof a[b]=="boolean"?a[b]?b:null:c.specified?c.value:null:null)},f=$.selectors={cacheLength:50,createPseudo:v,match:S,order:new RegExp("ID|TAG"+(Y?"|NAME":"")+(X?"|CLASS":"")),attrHandle:V?{}:{href:function(a){return a.getAttribute("href",2)},type:function(a){return a.getAttribute("type")}},find:{ID:e?function(a,b,c){if(typeof b.getElementById!==n&&!c){var d=b.getElementById(a);return d&&d.parentNode?[d]:[]}}:function(a,c,d){if(typeof c.getElementById!==n&&!d){var e=c.getElementById(a);return e?e.id===a||typeof e.getAttributeNode!==n&&e.getAttributeNode("id").value===a?[e]:b:[]}},TAG:U?function(a,b){if(typeof b.getElementsByTagName!==n){return b.getElementsByTagName(a)}}:function(a,b){var c=b.getElementsByTagName(a);if(a==="*"){var d,e=[],f=0;for(;d=c[f];f++){d.nodeType===1&&e.push(d)}return e}return c},NAME:function(a,b){if(typeof b.getElementsByName!==n){return b.getElementsByName(name)}},CLASS:function(a,b,c){if(typeof b.getElementsByClassName!==n&&!c){return b.getElementsByClassName(a)}}},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(a){return a[1]=a[1].replace(R,""),a[3]=(a[4]||a[5]||"").replace(R,""),a[2]==="~="&&(a[3]=" "+a[3]+" "),a.slice(0,4)},CHILD:function(a){return a[1]=a[1].toLowerCase(),a[1]==="nth"?(a[2]||$.error(a[0]),a[3]=+(a[3]?a[4]+(a[5]||1):2*(a[2]==="even"||a[2]==="odd")),a[4]=+(a[6]+a[7]||a[2]==="odd")):a[2]&&$.error(a[0]),a},PSEUDO:function(a,b,c){var d,e;if(S.CHILD.test(a[0])){return null}if(a[3]){a[2]=a[3]}else{if(d=a[4]){K.test(d)&&(e=bc(d,b,c,!0))&&(e=d.indexOf(")",d.length-e)-d.length)&&(d=d.slice(0,e),a[0]=a[0].slice(0,e)),a[2]=d}}return a.slice(0,3)}},filter:{ID:e?function(a){return a=a.replace(R,""),function(b){return b.getAttribute("id")===a}}:function(a){return a=a.replace(R,""),function(b){var c=typeof b.getAttributeNode!==n&&b.getAttributeNode("id");return c&&c.value===a}},TAG:function(a){return a==="*"?function(){return !0}:(a=a.replace(R,"").toLowerCase(),function(b){return b.nodeName&&b.nodeName.toLowerCase()===a})},CLASS:function(a){var b=x[o][a];return b||(b=x(a,new RegExp("(^|"+A+")"+a+"("+A+"|$)"))),function(a){return b.test(a.className||typeof a.getAttribute!==n&&a.getAttribute("class")||"")}},ATTR:function(a,b,c){return b?function(d){var e=$.attr(d,a),f=e+"";if(e==null){return b==="!="}switch(b){case"=":return f===c;case"!=":return f!==c;case"^=":return c&&f.indexOf(c)===0;case"*=":return c&&f.indexOf(c)>-1;case"$=":return c&&f.substr(f.length-c.length)===c;case"~=":return(" "+f+" ").indexOf(c)>-1;case"|=":return f===c||f.substr(0,c.length+1)===c+"-"}}:function(b){return $.attr(b,a)!=null}},CHILD:function(a,b,c,d){if(a==="nth"){var e=s++;return function(a){var b,f,g=0,h=a;if(c===1&&d===0){return !0}b=a.parentNode;if(b&&(b[o]!==e||!a.sizset)){for(h=b.firstChild;h;h=h.nextSibling){if(h.nodeType===1){h.sizset=++g;if(h===a){break}}}b[o]=e}return f=a.sizset-d,c===0?f===0:f%c===0&&f/c>=0}}return function(b){var c=b;switch(a){case"only":case"first":while(c=c.previousSibling){if(c.nodeType===1){return !1}}if(a==="first"){return !0}c=b;case"last":while(c=c.nextSibling){if(c.nodeType===1){return !1}}return !0}}},PSEUDO:function(a,b,c,d){var e,g=f.pseudos[a]||f.pseudos[a.toLowerCase()];return g||$.error("unsupported pseudo: "+a),g[o]?g(b,c,d):g.length>1?(e=[a,a,"",b],function(a){return g(a,0,e)}):g}},pseudos:{not:v(function(a,b,c){var d=j(a.replace(H,"$1"),b,c);return function(a){return !d(a)}}),enabled:function(a){return a.disabled===!1},disabled:function(a){return a.disabled===!0},checked:function(a){var b=a.nodeName.toLowerCase();return b==="input"&&!!a.checked||b==="option"&&!!a.selected},selected:function(a){return a.parentNode&&a.parentNode.selectedIndex,a.selected===!0},parent:function(a){return !f.pseudos.empty(a)},empty:function(a){var b;a=a.firstChild;while(a){if(a.nodeName>"@"||(b=a.nodeType)===3||b===4){return !1}a=a.nextSibling}return !0},contains:v(function(a){return function(b){return(b.textContent||b.innerText||g(b)).indexOf(a)>-1}}),has:v(function(a){return function(b){return $(a,b).length>0}}),header:function(a){return P.test(a.nodeName)},text:function(a){var b,c;return a.nodeName.toLowerCase()==="input"&&(b=a.type)==="text"&&((c=a.getAttribute("type"))==null||c.toLowerCase()===b)},radio:_("radio"),checkbox:_("checkbox"),file:_("file"),password:_("password"),image:_("image"),submit:ba("submit"),reset:ba("reset"),button:function(a){var b=a.nodeName.toLowerCase();return b==="input"&&a.type==="button"||b==="button"},input:function(a){return Q.test(a.nodeName)},focus:function(a){var b=a.ownerDocument;return a===b.activeElement&&(!b.hasFocus||b.hasFocus())&&(!!a.type||!!a.href)},active:function(a){return a===a.ownerDocument.activeElement}},setFilters:{first:function(a,b,c){return c?a.slice(1):[a[0]]},last:function(a,b,c){var d=a.pop();return c?a:[d]},even:function(a,b,c){var d=[],e=c?1:0,f=a.length;for(;e<f;e=e+2){d.push(a[e])}return d},odd:function(a,b,c){var d=[],e=c?0:1,f=a.length;for(;e<f;e=e+2){d.push(a[e])}return d},lt:function(a,b,c){return c?a.slice(+b):a.slice(0,+b)},gt:function(a,b,c){return c?a.slice(0,+b+1):a.slice(+b+1)},eq:function(a,b,c){var d=a.splice(+b,1);return c?a:d}}},k=r.compareDocumentPosition?function(a,b){return a===b?(l=!0,0):(!a.compareDocumentPosition||!b.compareDocumentPosition?a.compareDocumentPosition:a.compareDocumentPosition(b)&4)?-1:1}:function(a,b){if(a===b){return l=!0,0}if(a.sourceIndex&&b.sourceIndex){return a.sourceIndex-b.sourceIndex}var c,d,e=[],f=[],g=a.parentNode,h=b.parentNode,i=g;if(g===h){return bb(a,b)}if(!g){return -1}if(!h){return 1}while(i){e.unshift(i),i=i.parentNode}i=h;while(i){f.unshift(i),i=i.parentNode}c=e.length,d=f.length;for(var j=0;j<c&&j<d;j++){if(e[j]!==f[j]){return bb(e[j],f[j])}}return j===c?bb(a,f[j],-1):bb(e[j],b,1)},[0,0].sort(k),m=!l,$.uniqueSort=function(a){var b,c=1;l=m,a.sort(k);if(l){for(;b=a[c];c++){b===a[c-1]&&a.splice(c--,1)}}return a},$.error=function(a){throw new Error("Syntax error, unrecognized expression: "+a)},j=$.compile=function(a,b,c){var d,e,f,g=z[o][a];if(g&&g.context===b){return g}d=bc(a,b,c);for(e=0,f=d.length;e<f;e++){d[e]=bf(d[e],b,c)}return g=z(a,bg(d)),g.context=b,g.runs=g.dirruns=0,g},q.querySelectorAll&&function(){var a,b=bk,c=/'|\\/g,d=/\=[\x20\t\r\n\f]*([^'"\]]*)[\x20\t\r\n\f]*\]/g,e=[],f=[":active"],g=r.matchesSelector||r.mozMatchesSelector||r.webkitMatchesSelector||r.oMatchesSelector||r.msMatchesSelector;T(function(a){a.innerHTML="<select><option selected=''></option></select>",a.querySelectorAll("[selected]").length||e.push("\\["+A+"*(?:checked|disabled|ismap|multiple|readonly|selected|value)"),a.querySelectorAll(":checked").length||e.push(":checked")}),T(function(a){a.innerHTML="<p test=''></p>",a.querySelectorAll("[test^='']").length&&e.push("[*^$]="+A+"*(?:\"\"|'')"),a.innerHTML="<input type='hidden'/>",a.querySelectorAll(":enabled").length||e.push(":enabled",":disabled")}),e=e.length&&new RegExp(e.join("|")),bk=function(a,d,f,g,h){if(!g&&!h&&(!e||!e.test(a))){if(d.nodeType===9){try{return u.apply(f,t.call(d.querySelectorAll(a),0)),f}catch(i){}}else{if(d.nodeType===1&&d.nodeName.toLowerCase()!=="object"){var j,k,l,m=d.getAttribute("id"),n=m||o,p=N.test(a)&&d.parentNode||d;m?n=n.replace(c,"\\$&"):d.setAttribute("id",n),j=bc(a,d,h),n="[id='"+n+"']";for(k=0,l=j.length;k<l;k++){j[k]=n+j[k].selector}try{return u.apply(f,t.call(p.querySelectorAll(j.join(",")),0)),f}catch(i){}finally{m||d.removeAttribute("id")}}}}return b(a,d,f,g,h)},g&&(T(function(b){a=g.call(b,"div");try{g.call(b,"[test!='']:sizzle"),f.push(S.PSEUDO.source,S.POS.source,"!=")}catch(c){}}),f=new RegExp(f.join("|")),$.matchesSelector=function(b,c){c=c.replace(d,"='$1']");if(!h(b)&&!f.test(c)&&(!e||!e.test(c))){try{var i=g.call(b,c);if(i||a||b.document&&b.document.nodeType!==11){return i}}catch(j){}}return $(c,null,null,[b]).length>0})}(),f.setFilters.nth=f.setFilters.eq,f.filters=f.pseudos,$.attr=p.attr,p.find=$,p.expr=$.selectors,p.expr[":"]=p.expr.pseudos,p.unique=$.uniqueSort,p.text=$.getText,p.isXMLDoc=$.isXML,p.contains=$.contains}(a);var bc=/Until$/,bd=/^(?:parents|prev(?:Until|All))/,be=/^.[^:#\[\.,]*$/,bf=p.expr.match.needsContext,bg={children:!0,contents:!0,next:!0,prev:!0};p.fn.extend({find:function(a){var b,c,d,e,f,g,h=this;if(typeof a!="string"){return p(a).filter(function(){for(b=0,c=h.length;b<c;b++){if(p.contains(h[b],this)){return !0}}})}g=this.pushStack("","find",a);for(b=0,c=this.length;b<c;b++){d=g.length,p.find(a,this[b],g);if(b>0){for(e=d;e<g.length;e++){for(f=0;f<d;f++){if(g[f]===g[e]){g.splice(e--,1);break}}}}}return g},has:function(a){var b,c=p(a,this),d=c.length;return this.filter(function(){for(b=0;b<d;b++){if(p.contains(this,c[b])){return !0}}})},not:function(a){return this.pushStack(bj(this,a,!1),"not",a)},filter:function(a){return this.pushStack(bj(this,a,!0),"filter",a)},is:function(a){return !!a&&(typeof a=="string"?bf.test(a)?p(a,this.context).index(this[0])>=0:p.filter(a,this).length>0:this.filter(a).length>0)},closest:function(a,b){var c,d=0,e=this.length,f=[],g=bf.test(a)||typeof a!="string"?p(a,b||this.context):0;for(;d<e;d++){c=this[d];while(c&&c.ownerDocument&&c!==b&&c.nodeType!==11){if(g?g.index(c)>-1:p.find.matchesSelector(c,a)){f.push(c);break}c=c.parentNode}}return f=f.length>1?p.unique(f):f,this.pushStack(f,"closest",a)},index:function(a){return a?typeof a=="string"?p.inArray(this[0],p(a)):p.inArray(a.jquery?a[0]:a,this):this[0]&&this[0].parentNode?this.prevAll().length:-1},add:function(a,b){var c=typeof a=="string"?p(a,b):p.makeArray(a&&a.nodeType?[a]:a),d=p.merge(this.get(),c);return this.pushStack(bh(c[0])||bh(d[0])?d:p.unique(d))},addBack:function(a){return this.add(a==null?this.prevObject:this.prevObject.filter(a))}}),p.fn.andSelf=p.fn.addBack,p.each({parent:function(a){var b=a.parentNode;return b&&b.nodeType!==11?b:null},parents:function(a){return p.dir(a,"parentNode")},parentsUntil:function(a,b,c){return p.dir(a,"parentNode",c)},next:function(a){return bi(a,"nextSibling")},prev:function(a){return bi(a,"previousSibling")},nextAll:function(a){return p.dir(a,"nextSibling")},prevAll:function(a){return p.dir(a,"previousSibling")},nextUntil:function(a,b,c){return p.dir(a,"nextSibling",c)},prevUntil:function(a,b,c){return p.dir(a,"previousSibling",c)},siblings:function(a){return p.sibling((a.parentNode||{}).firstChild,a)},children:function(a){return p.sibling(a.firstChild)},contents:function(a){return p.nodeName(a,"iframe")?a.contentDocument||a.contentWindow.document:p.merge([],a.childNodes)}},function(a,b){p.fn[a]=function(c,d){var e=p.map(this,b,c);return bc.test(a)||(d=c),d&&typeof d=="string"&&(e=p.filter(d,e)),e=this.length>1&&!bg[a]?p.unique(e):e,this.length>1&&bd.test(a)&&(e=e.reverse()),this.pushStack(e,a,k.call(arguments).join(","))}}),p.extend({filter:function(a,b,c){return c&&(a=":not("+a+")"),b.length===1?p.find.matchesSelector(b[0],a)?[b[0]]:[]:p.find.matches(a,b)},dir:function(a,c,d){var e=[],f=a[c];while(f&&f.nodeType!==9&&(d===b||f.nodeType!==1||!p(f).is(d))){f.nodeType===1&&e.push(f),f=f[c]}return e},sibling:function(a,b){var c=[];for(;a;a=a.nextSibling){a.nodeType===1&&a!==b&&c.push(a)}return c}});var bl="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",bm=/ jQuery\d+="(?:null|\d+)"/g,bn=/^\s+/,bo=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,bp=/<([\w:]+)/,bq=/<tbody/i,br=/<|&#?\w+;/,bs=/<(?:script|style|link)/i,bt=/<(?:script|object|embed|option|style)/i,bu=new RegExp("<(?:"+bl+")[\\s/>]","i"),bv=/^(?:checkbox|radio)$/,bw=/checked\s*(?:[^=]|=\s*.checked.)/i,bx=/\/(java|ecma)script/i,by=/^\s*<!(?:\[CDATA\[|\-\-)|[\]\-]{2}>\s*$/g,bz={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],area:[1,"<map>","</map>"],_default:[0,"",""]},bA=bk(e),bB=bA.appendChild(e.createElement("div"));bz.optgroup=bz.option,bz.tbody=bz.tfoot=bz.colgroup=bz.caption=bz.thead,bz.th=bz.td,p.support.htmlSerialize||(bz._default=[1,"X<div>","</div>"]),p.fn.extend({text:function(a){return p.access(this,function(a){return a===b?p.text(this):this.empty().append((this[0]&&this[0].ownerDocument||e).createTextNode(a))},null,a,arguments.length)},wrapAll:function(a){if(p.isFunction(a)){return this.each(function(b){p(this).wrapAll(a.call(this,b))})}if(this[0]){var b=p(a,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&b.insertBefore(this[0]),b.map(function(){var a=this;while(a.firstChild&&a.firstChild.nodeType===1){a=a.firstChild}return a}).append(this)}return this},wrapInner:function(a){return p.isFunction(a)?this.each(function(b){p(this).wrapInner(a.call(this,b))}):this.each(function(){var b=p(this),c=b.contents();c.length?c.wrapAll(a):b.append(a)})},wrap:function(a){var b=p.isFunction(a);return this.each(function(c){p(this).wrapAll(b?a.call(this,c):a)})},unwrap:function(){return this.parent().each(function(){p.nodeName(this,"body")||p(this).replaceWith(this.childNodes)}).end()},append:function(){return this.domManip(arguments,!0,function(a){(this.nodeType===1||this.nodeType===11)&&this.appendChild(a)})},prepend:function(){return this.domManip(arguments,!0,function(a){(this.nodeType===1||this.nodeType===11)&&this.insertBefore(a,this.firstChild)})},before:function(){if(!bh(this[0])){return this.domManip(arguments,!1,function(a){this.parentNode.insertBefore(a,this)})}if(arguments.length){var a=p.clean(arguments);return this.pushStack(p.merge(a,this),"before",this.selector)}},after:function(){if(!bh(this[0])){return this.domManip(arguments,!1,function(a){this.parentNode.insertBefore(a,this.nextSibling)})}if(arguments.length){var a=p.clean(arguments);return this.pushStack(p.merge(this,a),"after",this.selector)}},remove:function(a,b){var c,d=0;for(;(c=this[d])!=null;d++){if(!a||p.filter(a,[c]).length){!b&&c.nodeType===1&&(p.cleanData(c.getElementsByTagName("*")),p.cleanData([c])),c.parentNode&&c.parentNode.removeChild(c)}}return this},empty:function(){var a,b=0;for(;(a=this[b])!=null;b++){a.nodeType===1&&p.cleanData(a.getElementsByTagName("*"));while(a.firstChild){a.removeChild(a.firstChild)}}return this},clone:function(a,b){return a=a==null?!1:a,b=b==null?a:b,this.map(function(){return p.clone(this,a,b)})},html:function(a){return p.access(this,function(a){var c=this[0]||{},d=0,e=this.length;if(a===b){return c.nodeType===1?c.innerHTML.replace(bm,""):b}if(typeof a=="string"&&!bs.test(a)&&(p.support.htmlSerialize||!bu.test(a))&&(p.support.leadingWhitespace||!bn.test(a))&&!bz[(bp.exec(a)||["",""])[1].toLowerCase()]){a=a.replace(bo,"<$1></$2>");try{for(;d<e;d++){c=this[d]||{},c.nodeType===1&&(p.cleanData(c.getElementsByTagName("*")),c.innerHTML=a)}c=0}catch(f){}}c&&this.empty().append(a)},null,a,arguments.length)},replaceWith:function(a){return bh(this[0])?this.length?this.pushStack(p(p.isFunction(a)?a():a),"replaceWith",a):this:p.isFunction(a)?this.each(function(b){var c=p(this),d=c.html();c.replaceWith(a.call(this,b,d))}):(typeof a!="string"&&(a=p(a).detach()),this.each(function(){var b=this.nextSibling,c=this.parentNode;p(this).remove(),b?p(b).before(a):p(c).append(a)}))},detach:function(a){return this.remove(a,!0)},domManip:function(a,c,d){a=[].concat.apply([],a);var e,f,g,h,i=0,j=a[0],k=[],l=this.length;if(!p.support.checkClone&&l>1&&typeof j=="string"&&bw.test(j)){return this.each(function(){p(this).domManip(a,c,d)})}if(p.isFunction(j)){return this.each(function(e){var f=p(this);a[0]=j.call(this,e,c?f.html():b),f.domManip(a,c,d)})}if(this[0]){e=p.buildFragment(a,this,k),g=e.fragment,f=g.firstChild,g.childNodes.length===1&&(g=f);if(f){c=c&&p.nodeName(f,"tr");for(h=e.cacheable||l-1;i<l;i++){d.call(c&&p.nodeName(this[i],"table")?bC(this[i],"tbody"):this[i],i===h?g:p.clone(g,!0,!0))}}g=f=null,k.length&&p.each(k,function(a,b){b.src?p.ajax?p.ajax({url:b.src,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0}):p.error("no ajax"):p.globalEval((b.text||b.textContent||b.innerHTML||"").replace(by,"")),b.parentNode&&b.parentNode.removeChild(b)})}return this}}),p.buildFragment=function(a,c,d){var f,g,h,i=a[0];return c=c||e,c=!c.nodeType&&c[0]||c,c=c.ownerDocument||c,a.length===1&&typeof i=="string"&&i.length<512&&c===e&&i.charAt(0)==="<"&&!bt.test(i)&&(p.support.checkClone||!bw.test(i))&&(p.support.html5Clone||!bu.test(i))&&(g=!0,f=p.fragments[i],h=f!==b),f||(f=c.createDocumentFragment(),p.clean(a,c,f,d),g&&(p.fragments[i]=h&&f)),{fragment:f,cacheable:g}},p.fragments={},p.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(a,b){p.fn[a]=function(c){var d,e=0,f=[],g=p(c),h=g.length,i=this.length===1&&this[0].parentNode;if((i==null||i&&i.nodeType===11&&i.childNodes.length===1)&&h===1){return g[b](this[0]),this}for(;e<h;e++){d=(e>0?this.clone(!0):this).get(),p(g[e])[b](d),f=f.concat(d)}return this.pushStack(f,a,g.selector)}}),p.extend({clone:function(a,b,c){var d,e,f,g;p.support.html5Clone||p.isXMLDoc(a)||!bu.test("<"+a.nodeName+">")?g=a.cloneNode(!0):(bB.innerHTML=a.outerHTML,bB.removeChild(g=bB.firstChild));if((!p.support.noCloneEvent||!p.support.noCloneChecked)&&(a.nodeType===1||a.nodeType===11)&&!p.isXMLDoc(a)){bE(a,g),d=bF(a),e=bF(g);for(f=0;d[f];++f){e[f]&&bE(d[f],e[f])}}if(b){bD(a,g);if(c){d=bF(a),e=bF(g);for(f=0;d[f];++f){bD(d[f],e[f])}}}return d=e=null,g},clean:function(a,b,c,d){var f,g,h,i,j,k,l,m,n,o,q,r,s=b===e&&bA,t=[];if(!b||typeof b.createDocumentFragment=="undefined"){b=e}for(f=0;(h=a[f])!=null;f++){typeof h=="number"&&(h+="");if(!h){continue}if(typeof h=="string"){if(!br.test(h)){h=b.createTextNode(h)}else{s=s||bk(b),l=b.createElement("div"),s.appendChild(l),h=h.replace(bo,"<$1></$2>"),i=(bp.exec(h)||["",""])[1].toLowerCase(),j=bz[i]||bz._default,k=j[0],l.innerHTML=j[1]+h+j[2];while(k--){l=l.lastChild}if(!p.support.tbody){m=bq.test(h),n=i==="table"&&!m?l.firstChild&&l.firstChild.childNodes:j[1]==="<table>"&&!m?l.childNodes:[];for(g=n.length-1;g>=0;--g){p.nodeName(n[g],"tbody")&&!n[g].childNodes.length&&n[g].parentNode.removeChild(n[g])}}!p.support.leadingWhitespace&&bn.test(h)&&l.insertBefore(b.createTextNode(bn.exec(h)[0]),l.firstChild),h=l.childNodes,l.parentNode.removeChild(l)}}h.nodeType?t.push(h):p.merge(t,h)}l&&(h=l=s=null);if(!p.support.appendChecked){for(f=0;(h=t[f])!=null;f++){p.nodeName(h,"input")?bG(h):typeof h.getElementsByTagName!="undefined"&&p.grep(h.getElementsByTagName("input"),bG)}}if(c){q=function(a){if(!a.type||bx.test(a.type)){return d?d.push(a.parentNode?a.parentNode.removeChild(a):a):c.appendChild(a)}};for(f=0;(h=t[f])!=null;f++){if(!p.nodeName(h,"script")||!q(h)){c.appendChild(h),typeof h.getElementsByTagName!="undefined"&&(r=p.grep(p.merge([],h.getElementsByTagName("script")),q),t.splice.apply(t,[f+1,0].concat(r)),f+=r.length)}}}return t},cleanData:function(a,b){var c,d,e,f,g=0,h=p.expando,i=p.cache,j=p.support.deleteExpando,k=p.event.special;for(;(e=a[g])!=null;g++){if(b||p.acceptData(e)){d=e[h],c=d&&i[d];if(c){if(c.events){for(f in c.events){k[f]?p.event.remove(e,f):p.removeEvent(e,f,c.handle)}}i[d]&&(delete i[d],j?delete e[h]:e.removeAttribute?e.removeAttribute(h):e[h]=null,p.deletedIds.push(d))}}}}}),function(){var a,b;p.uaMatch=function(a){a=a.toLowerCase();var b=/(chrome)[ \/]([\w.]+)/.exec(a)||/(webkit)[ \/]([\w.]+)/.exec(a)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(a)||/(msie) ([\w.]+)/.exec(a)||a.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(a)||[];return{browser:b[1]||"",version:b[2]||"0"}},a=p.uaMatch(g.userAgent),b={},a.browser&&(b[a.browser]=!0,b.version=a.version),b.chrome?b.webkit=!0:b.webkit&&(b.safari=!0),p.browser=b,p.sub=function(){function a(b,c){return new a.fn.init(b,c)}p.extend(!0,a,this),a.superclass=this,a.fn=a.prototype=this(),a.fn.constructor=a,a.sub=this.sub,a.fn.init=function c(c,d){return d&&d instanceof p&&!(d instanceof a)&&(d=a(d)),p.fn.init.call(this,c,d,b)},a.fn.init.prototype=a.fn;var b=a(e);return a}}();var bH,bI,bJ,bK=/alpha\([^)]*\)/i,bL=/opacity=([^)]*)/,bM=/^(top|right|bottom|left)$/,bN=/^(none|table(?!-c[ea]).+)/,bO=/^margin/,bP=new RegExp("^("+q+")(.*)$","i"),bQ=new RegExp("^("+q+")(?!px)[a-z%]+$","i"),bR=new RegExp("^([-+])=("+q+")","i"),bS={},bT={position:"absolute",visibility:"hidden",display:"block"},bU={letterSpacing:0,fontWeight:400},bV=["Top","Right","Bottom","Left"],bW=["Webkit","O","Moz","ms"],bX=p.fn.toggle;p.fn.extend({css:function(a,c){return p.access(this,function(a,c,d){return d!==b?p.style(a,c,d):p.css(a,c)},a,c,arguments.length>1)},show:function(){return b$(this,!0)},hide:function(){return b$(this)},toggle:function(a,b){var c=typeof a=="boolean";return p.isFunction(a)&&p.isFunction(b)?bX.apply(this,arguments):this.each(function(){(c?a:bZ(this))?p(this).show():p(this).hide()})}}),p.extend({cssHooks:{opacity:{get:function(a,b){if(b){var c=bH(a,"opacity");return c===""?"1":c}}}},cssNumber:{fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":p.support.cssFloat?"cssFloat":"styleFloat"},style:function(a,c,d,e){if(!a||a.nodeType===3||a.nodeType===8||!a.style){return}var f,g,h,i=p.camelCase(c),j=a.style;c=p.cssProps[i]||(p.cssProps[i]=bY(j,i)),h=p.cssHooks[c]||p.cssHooks[i];if(d===b){return h&&"get" in h&&(f=h.get(a,!1,e))!==b?f:j[c]}g=typeof d,g==="string"&&(f=bR.exec(d))&&(d=(f[1]+1)*f[2]+parseFloat(p.css(a,c)),g="number");if(d==null||g==="number"&&isNaN(d)){return}g==="number"&&!p.cssNumber[i]&&(d+="px");if(!h||!("set" in h)||(d=h.set(a,d,e))!==b){try{j[c]=d}catch(k){}}},css:function(a,c,d,e){var f,g,h,i=p.camelCase(c);return c=p.cssProps[i]||(p.cssProps[i]=bY(a.style,i)),h=p.cssHooks[c]||p.cssHooks[i],h&&"get" in h&&(f=h.get(a,!0,e)),f===b&&(f=bH(a,c)),f==="normal"&&c in bU&&(f=bU[c]),d||e!==b?(g=parseFloat(f),d||p.isNumeric(g)?g||0:f):f},swap:function(a,b,c){var d,e,f={};for(e in b){f[e]=a.style[e],a.style[e]=b[e]}d=c.call(a);for(e in b){a.style[e]=f[e]}return d}}),a.getComputedStyle?bH=function(b,c){var d,e,f,g,h=a.getComputedStyle(b,null),i=b.style;return h&&(d=h[c],d===""&&!p.contains(b.ownerDocument,b)&&(d=p.style(b,c)),bQ.test(d)&&bO.test(c)&&(e=i.width,f=i.minWidth,g=i.maxWidth,i.minWidth=i.maxWidth=i.width=d,d=h.width,i.width=e,i.minWidth=f,i.maxWidth=g)),d}:e.documentElement.currentStyle&&(bH=function(a,b){var c,d,e=a.currentStyle&&a.currentStyle[b],f=a.style;return e==null&&f&&f[b]&&(e=f[b]),bQ.test(e)&&!bM.test(b)&&(c=f.left,d=a.runtimeStyle&&a.runtimeStyle.left,d&&(a.runtimeStyle.left=a.currentStyle.left),f.left=b==="fontSize"?"1em":e,e=f.pixelLeft+"px",f.left=c,d&&(a.runtimeStyle.left=d)),e===""?"auto":e}),p.each(["height","width"],function(a,b){p.cssHooks[b]={get:function(a,c,d){if(c){return a.offsetWidth===0&&bN.test(bH(a,"display"))?p.swap(a,bT,function(){return cb(a,b,d)}):cb(a,b,d)}},set:function(a,c,d){return b_(a,c,d?ca(a,b,d,p.support.boxSizing&&p.css(a,"boxSizing")==="border-box"):0)}}}),p.support.opacity||(p.cssHooks.opacity={get:function(a,b){return bL.test((b&&a.currentStyle?a.currentStyle.filter:a.style.filter)||"")?0.01*parseFloat(RegExp.$1)+"":b?"1":""},set:function(a,b){var c=a.style,d=a.currentStyle,e=p.isNumeric(b)?"alpha(opacity="+b*100+")":"",f=d&&d.filter||c.filter||"";c.zoom=1;if(b>=1&&p.trim(f.replace(bK,""))===""&&c.removeAttribute){c.removeAttribute("filter");if(d&&!d.filter){return}}c.filter=bK.test(f)?f.replace(bK,e):f+" "+e}}),p(function(){p.support.reliableMarginRight||(p.cssHooks.marginRight={get:function(a,b){return p.swap(a,{display:"inline-block"},function(){if(b){return bH(a,"marginRight")}})}}),!p.support.pixelPosition&&p.fn.position&&p.each(["top","left"],function(a,b){p.cssHooks[b]={get:function(a,c){if(c){var d=bH(a,b);return bQ.test(d)?p(a).position()[b]+"px":d}}}})}),p.expr&&p.expr.filters&&(p.expr.filters.hidden=function(a){return a.offsetWidth===0&&a.offsetHeight===0||!p.support.reliableHiddenOffsets&&(a.style&&a.style.display||bH(a,"display"))==="none"},p.expr.filters.visible=function(a){return !p.expr.filters.hidden(a)}),p.each({margin:"",padding:"",border:"Width"},function(a,b){p.cssHooks[a+b]={expand:function(c){var d,e=typeof c=="string"?c.split(" "):[c],f={};for(d=0;d<4;d++){f[a+bV[d]+b]=e[d]||e[d-2]||e[0]}return f}},bO.test(a)||(p.cssHooks[a+b].set=b_)});var cd=/%20/g,ce=/\[\]$/,cf=/\r?\n/g,cg=/^(?:color|date|datetime|datetime-local|email|hidden|month|number|password|range|search|tel|text|time|url|week)$/i,ch=/^(?:select|textarea)/i;p.fn.extend({serialize:function(){return p.param(this.serializeArray())},serializeArray:function(){return this.map(function(){return this.elements?p.makeArray(this.elements):this}).filter(function(){return this.name&&!this.disabled&&(this.checked||ch.test(this.nodeName)||cg.test(this.type))}).map(function(a,b){var c=p(this).val();return c==null?null:p.isArray(c)?p.map(c,function(a,c){return{name:b.name,value:a.replace(cf,"\r\n")}}):{name:b.name,value:c.replace(cf,"\r\n")}}).get()}}),p.param=function(a,c){var d,e=[],f=function(a,b){b=p.isFunction(b)?b():b==null?"":b,e[e.length]=encodeURIComponent(a)+"="+encodeURIComponent(b)};c===b&&(c=p.ajaxSettings&&p.ajaxSettings.traditional);if(p.isArray(a)||a.jquery&&!p.isPlainObject(a)){p.each(a,function(){f(this.name,this.value)})}else{for(d in a){ci(d,a[d],c,f)}}return e.join("&").replace(cd,"+")};var cj,ck,cl=/#.*$/,cm=/^(.*?):[ \t]*([^\r\n]*)\r?$/mg,cn=/^(?:about|app|app\-storage|.+\-extension|file|res|widget):$/,co=/^(?:GET|HEAD)$/,cp=/^\/\//,cq=/\?/,cr=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,cs=/([?&])_=[^&]*/,ct=/^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,cu=p.fn.load,cv={},cw={},cx=["*/"]+["*"];try{cj=f.href}catch(cy){cj=e.createElement("a"),cj.href="",cj=cj.href}ck=ct.exec(cj.toLowerCase())||[],p.fn.load=function(a,c,d){if(typeof a!="string"&&cu){return cu.apply(this,arguments)}if(!this.length){return this}var e,f,g,h=this,i=a.indexOf(" ");return i>=0&&(e=a.slice(i,a.length),a=a.slice(0,i)),p.isFunction(c)?(d=c,c=b):c&&typeof c=="object"&&(f="POST"),p.ajax({url:a,type:f,dataType:"html",data:c,complete:function(a,b){d&&h.each(d,g||[a.responseText,b,a])}}).done(function(a){g=arguments,h.html(e?p("<div>").append(a.replace(cr,"")).find(e):a)}),this},p.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),function(a,b){p.fn[b]=function(a){return this.on(b,a)}}),p.each(["get","post"],function(a,c){p[c]=function(a,d,e,f){return p.isFunction(d)&&(f=f||e,e=d,d=b),p.ajax({type:c,url:a,data:d,success:e,dataType:f})}}),p.extend({getScript:function(a,c){return p.get(a,b,c,"script")},getJSON:function(a,b,c){return p.get(a,b,c,"json")},ajaxSetup:function(a,b){return b?cB(a,p.ajaxSettings):(b=a,a=p.ajaxSettings),cB(a,b),a},ajaxSettings:{url:cj,isLocal:cn.test(ck[1]),global:!0,type:"GET",contentType:"application/x-www-form-urlencoded; charset=UTF-8",processData:!0,async:!0,accepts:{xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript","*":cx},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText"},converters:{"* text":a.String,"text html":!0,"text json":p.parseJSON,"text xml":p.parseXML},flatOptions:{context:!0,url:!0}},ajaxPrefilter:cz(cv),ajaxTransport:cz(cw),ajax:function(a,c){function y(a,c,f,i){var k,s,t,u,w,y=c;if(v===2){return}v=2,h&&clearTimeout(h),g=b,e=i||"",x.readyState=a>0?4:0,f&&(u=cC(l,x,f));if(a>=200&&a<300||a===304){l.ifModified&&(w=x.getResponseHeader("Last-Modified"),w&&(p.lastModified[d]=w),w=x.getResponseHeader("Etag"),w&&(p.etag[d]=w)),a===304?(y="notmodified",k=!0):(k=cD(l,u),y=k.state,s=k.data,t=k.error,k=!t)}else{t=y;if(!y||a){y="error",a<0&&(a=0)}}x.status=a,x.statusText=""+(c||y),k?o.resolveWith(m,[s,y,x]):o.rejectWith(m,[x,y,t]),x.statusCode(r),r=b,j&&n.trigger("ajax"+(k?"Success":"Error"),[x,l,k?s:t]),q.fireWith(m,[x,y]),j&&(n.trigger("ajaxComplete",[x,l]),--p.active||p.event.trigger("ajaxStop"))}typeof a=="object"&&(c=a,a=b),c=c||{};var d,e,f,g,h,i,j,k,l=p.ajaxSetup({},c),m=l.context||l,n=m!==l&&(m.nodeType||m instanceof p)?p(m):p.event,o=p.Deferred(),q=p.Callbacks("once memory"),r=l.statusCode||{},t={},u={},v=0,w="canceled",x={readyState:0,setRequestHeader:function(a,b){if(!v){var c=a.toLowerCase();a=u[c]=u[c]||a,t[a]=b}return this},getAllResponseHeaders:function(){return v===2?e:null},getResponseHeader:function(a){var c;if(v===2){if(!f){f={};while(c=cm.exec(e)){f[c[1].toLowerCase()]=c[2]}}c=f[a.toLowerCase()]}return c===b?null:c},overrideMimeType:function(a){return v||(l.mimeType=a),this},abort:function(a){return a=a||w,g&&g.abort(a),y(0,a),this}};o.promise(x),x.success=x.done,x.error=x.fail,x.complete=q.add,x.statusCode=function(a){if(a){var b;if(v<2){for(b in a){r[b]=[r[b],a[b]]}}else{b=a[x.status],x.always(b)}}return this},l.url=((a||l.url)+"").replace(cl,"").replace(cp,ck[1]+"//"),l.dataTypes=p.trim(l.dataType||"*").toLowerCase().split(s),l.crossDomain==null&&(i=ct.exec(l.url.toLowerCase()),l.crossDomain=!(!i||i[1]==ck[1]&&i[2]==ck[2]&&(i[3]||(i[1]==="http:"?80:443))==(ck[3]||(ck[1]==="http:"?80:443)))),l.data&&l.processData&&typeof l.data!="string"&&(l.data=p.param(l.data,l.traditional)),cA(cv,l,c,x);if(v===2){return x}j=l.global,l.type=l.type.toUpperCase(),l.hasContent=!co.test(l.type),j&&p.active++===0&&p.event.trigger("ajaxStart");if(!l.hasContent){l.data&&(l.url+=(cq.test(l.url)?"&":"?")+l.data,delete l.data),d=l.url;if(l.cache===!1){var z=p.now(),A=l.url.replace(cs,"$1_="+z);l.url=A+(A===l.url?(cq.test(l.url)?"&":"?")+"_="+z:"")}}(l.data&&l.hasContent&&l.contentType!==!1||c.contentType)&&x.setRequestHeader("Content-Type",l.contentType),l.ifModified&&(d=d||l.url,p.lastModified[d]&&x.setRequestHeader("If-Modified-Since",p.lastModified[d]),p.etag[d]&&x.setRequestHeader("If-None-Match",p.etag[d])),x.setRequestHeader("Accept",l.dataTypes[0]&&l.accepts[l.dataTypes[0]]?l.accepts[l.dataTypes[0]]+(l.dataTypes[0]!=="*"?", "+cx+"; q=0.01":""):l.accepts["*"]);for(k in l.headers){x.setRequestHeader(k,l.headers[k])}if(!l.beforeSend||l.beforeSend.call(m,x,l)!==!1&&v!==2){w="abort";for(k in {success:1,error:1,complete:1}){x[k](l[k])}g=cA(cw,l,c,x);if(!g){y(-1,"No Transport")}else{x.readyState=1,j&&n.trigger("ajaxSend",[x,l]),l.async&&l.timeout>0&&(h=setTimeout(function(){x.abort("timeout")},l.timeout));try{v=1,g.send(t,y)}catch(B){if(v<2){y(-1,B)}else{throw B}}}return x}return x.abort()},active:0,lastModified:{},etag:{}});var cE=[],cF=/\?/,cG=/(=)\?(?=&|$)|\?\?/,cH=p.now();p.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var a=cE.pop()||p.expando+"_"+cH++;return this[a]=!0,a}}),p.ajaxPrefilter("json jsonp",function(c,d,e){var f,g,h,i=c.data,j=c.url,k=c.jsonp!==!1,l=k&&cG.test(j),m=k&&!l&&typeof i=="string"&&!(c.contentType||"").indexOf("application/x-www-form-urlencoded")&&cG.test(i);if(c.dataTypes[0]==="jsonp"||l||m){return f=c.jsonpCallback=p.isFunction(c.jsonpCallback)?c.jsonpCallback():c.jsonpCallback,g=a[f],l?c.url=j.replace(cG,"$1"+f):m?c.data=i.replace(cG,"$1"+f):k&&(c.url+=(cF.test(j)?"&":"?")+c.jsonp+"="+f),c.converters["script json"]=function(){return h||p.error(f+" was not called"),h[0]},c.dataTypes[0]="json",a[f]=function(){h=arguments},e.always(function(){a[f]=g,c[f]&&(c.jsonpCallback=d.jsonpCallback,cE.push(f)),h&&p.isFunction(g)&&g(h[0]),h=g=b}),"script"}}),p.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/javascript|ecmascript/},converters:{"text script":function(a){return p.globalEval(a),a}}}),p.ajaxPrefilter("script",function(a){a.cache===b&&(a.cache=!1),a.crossDomain&&(a.type="GET",a.global=!1)}),p.ajaxTransport("script",function(a){if(a.crossDomain){var c,d=e.head||e.getElementsByTagName("head")[0]||e.documentElement;return{send:function(f,g){c=e.createElement("script"),c.async="async",a.scriptCharset&&(c.charset=a.scriptCharset),c.src=a.url,c.onload=c.onreadystatechange=function(a,e){if(e||!c.readyState||/loaded|complete/.test(c.readyState)){c.onload=c.onreadystatechange=null,d&&c.parentNode&&d.removeChild(c),c=b,e||g(200,"success")}},d.insertBefore(c,d.firstChild)},abort:function(){c&&c.onload(0,1)}}}});var cI,cJ=a.ActiveXObject?function(){for(var a in cI){cI[a](0,1)}}:!1,cK=0;p.ajaxSettings.xhr=a.ActiveXObject?function(){return !this.isLocal&&cL()||cM()}:cL,function(a){p.extend(p.support,{ajax:!!a,cors:!!a&&"withCredentials" in a})}(p.ajaxSettings.xhr()),p.support.ajax&&p.ajaxTransport(function(c){if(!c.crossDomain||p.support.cors){var d;return{send:function(e,f){var g,h,i=c.xhr();c.username?i.open(c.type,c.url,c.async,c.username,c.password):i.open(c.type,c.url,c.async);if(c.xhrFields){for(h in c.xhrFields){i[h]=c.xhrFields[h]}}c.mimeType&&i.overrideMimeType&&i.overrideMimeType(c.mimeType),!c.crossDomain&&!e["X-Requested-With"]&&(e["X-Requested-With"]="XMLHttpRequest");try{for(h in e){i.setRequestHeader(h,e[h])}}catch(j){}i.send(c.hasContent&&c.data||null),d=function(a,e){var h,j,k,l,m;try{if(d&&(e||i.readyState===4)){d=b,g&&(i.onreadystatechange=p.noop,cJ&&delete cI[g]);if(e){i.readyState!==4&&i.abort()}else{h=i.status,k=i.getAllResponseHeaders(),l={},m=i.responseXML,m&&m.documentElement&&(l.xml=m);try{l.text=i.responseText}catch(a){}try{j=i.statusText}catch(n){j=""}!h&&c.isLocal&&!c.crossDomain?h=l.text?200:404:h===1223&&(h=204)}}}catch(o){e||f(-1,o)}l&&f(h,j,l,k)},c.async?i.readyState===4?setTimeout(d,0):(g=++cK,cJ&&(cI||(cI={},p(a).unload(cJ)),cI[g]=d),i.onreadystatechange=d):d()},abort:function(){d&&d(0,1)}}}});var cN,cO,cP=/^(?:toggle|show|hide)$/,cQ=new RegExp("^(?:([-+])=|)("+q+")([a-z%]*)$","i"),cR=/queueHooks$/,cS=[cY],cT={"*":[function(a,b){var c,d,e,f=this.createTween(a,b),g=cQ.exec(b),h=f.cur(),i=+h||0,j=1;if(g){c=+g[2],d=g[3]||(p.cssNumber[a]?"":"px");if(d!=="px"&&i){i=p.css(f.elem,a,!0)||c||1;do{e=j=j||".5",i=i/j,p.style(f.elem,a,i+d),j=f.cur()/h}while(j!==1&&j!==e)}f.unit=d,f.start=i,f.end=g[1]?i+(g[1]+1)*c:c}return f}]};p.Animation=p.extend(cW,{tweener:function(a,b){p.isFunction(a)?(b=a,a=["*"]):a=a.split(" ");var c,d=0,e=a.length;for(;d<e;d++){c=a[d],cT[c]=cT[c]||[],cT[c].unshift(b)}},prefilter:function(a,b){b?cS.unshift(a):cS.push(a)}}),p.Tween=cZ,cZ.prototype={constructor:cZ,init:function(a,b,c,d,e,f){this.elem=a,this.prop=c,this.easing=e||"swing",this.options=b,this.start=this.now=this.cur(),this.end=d,this.unit=f||(p.cssNumber[c]?"":"px")},cur:function(){var a=cZ.propHooks[this.prop];return a&&a.get?a.get(this):cZ.propHooks._default.get(this)},run:function(a){var b,c=cZ.propHooks[this.prop];return this.options.duration?this.pos=b=p.easing[this.easing](a,this.options.duration*a,0,1,this.options.duration):this.pos=b=a,this.now=(this.end-this.start)*b+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),c&&c.set?c.set(this):cZ.propHooks._default.set(this),this}},cZ.prototype.init.prototype=cZ.prototype,cZ.propHooks={_default:{get:function(a){var b;return a.elem[a.prop]==null||!!a.elem.style&&a.elem.style[a.prop]!=null?(b=p.css(a.elem,a.prop,!1,""),!b||b==="auto"?0:b):a.elem[a.prop]},set:function(a){p.fx.step[a.prop]?p.fx.step[a.prop](a):a.elem.style&&(a.elem.style[p.cssProps[a.prop]]!=null||p.cssHooks[a.prop])?p.style(a.elem,a.prop,a.now+a.unit):a.elem[a.prop]=a.now}}},cZ.propHooks.scrollTop=cZ.propHooks.scrollLeft={set:function(a){a.elem.nodeType&&a.elem.parentNode&&(a.elem[a.prop]=a.now)}},p.each(["toggle","show","hide"],function(a,b){var c=p.fn[b];p.fn[b]=function(d,e,f){return d==null||typeof d=="boolean"||!a&&p.isFunction(d)&&p.isFunction(e)?c.apply(this,arguments):this.animate(c$(b,!0),d,e,f)}}),p.fn.extend({fadeTo:function(a,b,c,d){return this.filter(bZ).css("opacity",0).show().end().animate({opacity:b},a,c,d)},animate:function(a,b,c,d){var e=p.isEmptyObject(a),f=p.speed(b,c,d),g=function(){var b=cW(this,p.extend({},a),f);e&&b.stop(!0)};return e||f.queue===!1?this.each(g):this.queue(f.queue,g)},stop:function(a,c,d){var e=function(a){var b=a.stop;delete a.stop,b(d)};return typeof a!="string"&&(d=c,c=a,a=b),c&&a!==!1&&this.queue(a||"fx",[]),this.each(function(){var b=!0,c=a!=null&&a+"queueHooks",f=p.timers,g=p._data(this);if(c){g[c]&&g[c].stop&&e(g[c])}else{for(c in g){g[c]&&g[c].stop&&cR.test(c)&&e(g[c])}}for(c=f.length;c--;){f[c].elem===this&&(a==null||f[c].queue===a)&&(f[c].anim.stop(d),b=!1,f.splice(c,1))}(b||!d)&&p.dequeue(this,a)})}}),p.each({slideDown:c$("show"),slideUp:c$("hide"),slideToggle:c$("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(a,b){p.fn[a]=function(a,c,d){return this.animate(b,a,c,d)}}),p.speed=function(a,b,c){var d=a&&typeof a=="object"?p.extend({},a):{complete:c||!c&&b||p.isFunction(a)&&a,duration:a,easing:c&&b||b&&!p.isFunction(b)&&b};d.duration=p.fx.off?0:typeof d.duration=="number"?d.duration:d.duration in p.fx.speeds?p.fx.speeds[d.duration]:p.fx.speeds._default;if(d.queue==null||d.queue===!0){d.queue="fx"}return d.old=d.complete,d.complete=function(){p.isFunction(d.old)&&d.old.call(this),d.queue&&p.dequeue(this,d.queue)},d},p.easing={linear:function(a){return a},swing:function(a){return 0.5-Math.cos(a*Math.PI)/2}},p.timers=[],p.fx=cZ.prototype.init,p.fx.tick=function(){var a,b=p.timers,c=0;for(;c<b.length;c++){a=b[c],!a()&&b[c]===a&&b.splice(c--,1)}b.length||p.fx.stop()},p.fx.timer=function(a){a()&&p.timers.push(a)&&!cO&&(cO=setInterval(p.fx.tick,p.fx.interval))},p.fx.interval=13,p.fx.stop=function(){clearInterval(cO),cO=null},p.fx.speeds={slow:600,fast:200,_default:400},p.fx.step={},p.expr&&p.expr.filters&&(p.expr.filters.animated=function(a){return p.grep(p.timers,function(b){return a===b.elem}).length});var c_=/^(?:body|html)$/i;p.fn.offset=function(a){if(arguments.length){return a===b?this:this.each(function(b){p.offset.setOffset(this,a,b)})}var c,d,e,f,g,h,i,j,k,l,m=this[0],n=m&&m.ownerDocument;if(!n){return}return(e=n.body)===m?p.offset.bodyOffset(m):(d=n.documentElement,p.contains(d,m)?(c=m.getBoundingClientRect(),f=da(n),g=d.clientTop||e.clientTop||0,h=d.clientLeft||e.clientLeft||0,i=f.pageYOffset||d.scrollTop,j=f.pageXOffset||d.scrollLeft,k=c.top+i-g,l=c.left+j-h,{top:k,left:l}):{top:0,left:0})},p.offset={bodyOffset:function(a){var b=a.offsetTop,c=a.offsetLeft;return p.support.doesNotIncludeMarginInBodyOffset&&(b+=parseFloat(p.css(a,"marginTop"))||0,c+=parseFloat(p.css(a,"marginLeft"))||0),{top:b,left:c}},setOffset:function(a,b,c){var d=p.css(a,"position");d==="static"&&(a.style.position="relative");var e=p(a),f=e.offset(),g=p.css(a,"top"),h=p.css(a,"left"),i=(d==="absolute"||d==="fixed")&&p.inArray("auto",[g,h])>-1,j={},k={},l,m;i?(k=e.position(),l=k.top,m=k.left):(l=parseFloat(g)||0,m=parseFloat(h)||0),p.isFunction(b)&&(b=b.call(a,c,f)),b.top!=null&&(j.top=b.top-f.top+l),b.left!=null&&(j.left=b.left-f.left+m),"using" in b?b.using.call(a,j):e.css(j)}},p.fn.extend({position:function(){if(!this[0]){return}var a=this[0],b=this.offsetParent(),c=this.offset(),d=c_.test(b[0].nodeName)?{top:0,left:0}:b.offset();return c.top-=parseFloat(p.css(a,"marginTop"))||0,c.left-=parseFloat(p.css(a,"marginLeft"))||0,d.top+=parseFloat(p.css(b[0],"borderTopWidth"))||0,d.left+=parseFloat(p.css(b[0],"borderLeftWidth"))||0,{top:c.top-d.top,left:c.left-d.left}},offsetParent:function(){return this.map(function(){var a=this.offsetParent||e.body;while(a&&!c_.test(a.nodeName)&&p.css(a,"position")==="static"){a=a.offsetParent}return a||e.body})}}),p.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(a,c){var d=/Y/.test(c);p.fn[a]=function(e){return p.access(this,function(a,e,f){var g=da(a);if(f===b){return g?c in g?g[c]:g.document.documentElement[e]:a[e]}g?g.scrollTo(d?p(g).scrollLeft():f,d?f:p(g).scrollTop()):a[e]=f},a,e,arguments.length,null)}}),p.each({Height:"height",Width:"width"},function(a,c){p.each({padding:"inner"+a,content:c,"":"outer"+a},function(d,e){p.fn[e]=function(e,f){var g=arguments.length&&(d||typeof e!="boolean"),h=d||(e===!0||f===!0?"margin":"border");return p.access(this,function(c,d,e){var f;return p.isWindow(c)?c.document.documentElement["client"+a]:c.nodeType===9?(f=c.documentElement,Math.max(c.body["scroll"+a],f["scroll"+a],c.body["offset"+a],f["offset"+a],f["client"+a])):e===b?p.css(c,d,e,h):p.style(c,d,e,h)},c,g?e:b,g,null)}})}),a.jQuery=a.$=p,typeof define=="function"&&define.amd&&define.amd.jQuery&&define("jquery",[],function(){return p})})(window);
/*! jQuery UI - v1.9.2 - 2012-12-29
* http://jqueryui.com
* Includes: jquery.ui.core.js, jquery.ui.widget.js, jquery.ui.mouse.js, jquery.ui.draggable.js, jquery.ui.resizable.js, jquery.ui.sortable.js
* Copyright (c) 2012 jQuery Foundation and other contributors Licensed MIT */
(function(f,b){function a(j,m){var k,h,l,e=j.nodeName.toLowerCase();return"area"===e?(k=j.parentNode,h=k.name,!j.href||!h||k.nodeName.toLowerCase()!=="map"?!1:(l=f("img[usemap=#"+h+"]")[0],!!l&&c(l))):(/input|select|textarea|button|object/.test(e)?!j.disabled:"a"===e?j.href||m:m)&&c(j)}function c(e){return f.expr.filters.visible(e)&&!f(e).parents().andSelf().filter(function(){return f.css(this,"visibility")==="hidden"}).length}var g=0,d=/^ui-id-\d+$/;f.ui=f.ui||{};if(f.ui.version){return}f.extend(f.ui,{version:"1.9.2",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),f.fn.extend({_focus:f.fn.focus,focus:function(e,h){return typeof e=="number"?this.each(function(){var i=this;setTimeout(function(){f(i).focus(),h&&h.call(i)},e)}):this._focus.apply(this,arguments)},scrollParent:function(){var e;return f.ui.ie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?e=this.parents().filter(function(){return/(relative|absolute|fixed)/.test(f.css(this,"position"))&&/(auto|scroll)/.test(f.css(this,"overflow")+f.css(this,"overflow-y")+f.css(this,"overflow-x"))}).eq(0):e=this.parents().filter(function(){return/(auto|scroll)/.test(f.css(this,"overflow")+f.css(this,"overflow-y")+f.css(this,"overflow-x"))}).eq(0),/fixed/.test(this.css("position"))||!e.length?f(document):e},zIndex:function(k){if(k!==b){return this.css("zIndex",k)}if(this.length){var j=f(this[0]),e,h;while(j.length&&j[0]!==document){e=j.css("position");if(e==="absolute"||e==="relative"||e==="fixed"){h=parseInt(j.css("zIndex"),10);if(!isNaN(h)&&h!==0){return h}}j=j.parent()}}return 0},uniqueId:function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++g)})},removeUniqueId:function(){return this.each(function(){d.test(this.id)&&f(this).removeAttr("id")})}}),f.extend(f.expr[":"],{data:f.expr.createPseudo?f.expr.createPseudo(function(e){return function(h){return !!f.data(h,e)}}):function(e,i,h){return !!f.data(e,h[3])},focusable:function(e){return a(e,!isNaN(f.attr(e,"tabindex")))},tabbable:function(e){var i=f.attr(e,"tabindex"),h=isNaN(i);return(h||i>=0)&&a(e,!h)}}),f(function(){var e=document.body,h=e.appendChild(h=document.createElement("div"));h.offsetHeight,f.extend(h.style,{minHeight:"100px",height:"auto",padding:0,borderWidth:0}),f.support.minHeight=h.offsetHeight===100,f.support.selectstart="onselectstart" in h,e.removeChild(h).style.display="none"}),f("<a>").outerWidth(1).jquery||f.each(["Width","Height"],function(m,k){function e(i,q,p,o){return f.each(h,function(){q-=parseFloat(f.css(i,"padding"+this))||0,p&&(q-=parseFloat(f.css(i,"border"+this+"Width"))||0),o&&(q-=parseFloat(f.css(i,"margin"+this))||0)}),q}var h=k==="Width"?["Left","Right"]:["Top","Bottom"],j=k.toLowerCase(),l={innerWidth:f.fn.innerWidth,innerHeight:f.fn.innerHeight,outerWidth:f.fn.outerWidth,outerHeight:f.fn.outerHeight};f.fn["inner"+k]=function(i){return i===b?l["inner"+k].call(this):this.each(function(){f(this).css(j,e(this,i)+"px")})},f.fn["outer"+k]=function(i,o){return typeof i!="number"?l["outer"+k].call(this,i):this.each(function(){f(this).css(j,e(this,i,!0,o)+"px")})}}),f("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(f.fn.removeData=function(e){return function(h){return arguments.length?e.call(this,f.camelCase(h)):e.call(this)}}(f.fn.removeData)),function(){var e=/msie ([\w.]+)/.exec(navigator.userAgent.toLowerCase())||[];f.ui.ie=e.length?!0:!1,f.ui.ie6=parseFloat(e[1],10)===6}(),f.fn.extend({disableSelection:function(){return this.bind((f.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(h){h.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}}),f.extend(f.ui,{plugin:{add:function(h,l,k){var e,j=f.ui[h].prototype;for(e in k){j.plugins[e]=j.plugins[e]||[],j.plugins[e].push([l,k[e]])}},call:function(l,j,m){var k,h=l.plugins[j];if(!h||!l.element[0].parentNode||l.element[0].parentNode.nodeType===11){return}for(k=0;k<h.length;k++){l.options[h[k][0]]&&h[k][1].apply(l.element,m)}}},contains:f.contains,hasScroll:function(h,k){if(f(h).css("overflow")==="hidden"){return !1}var j=k&&k==="left"?"scrollLeft":"scrollTop",e=!1;return h[j]>0?!0:(h[j]=1,e=h[j]>0,h[j]=0,e)},isOverAxis:function(i,h,j){return i>h&&i<h+j},isOver:function(h,m,k,e,j,l){return f.ui.isOverAxis(h,k,j)&&f.ui.isOverAxis(m,e,l)}})})(jQuery);(function(d,b){var f=0,c=Array.prototype.slice,a=d.cleanData;d.cleanData=function(e){for(var i=0,h;(h=e[i])!=null;i++){try{d(h).triggerHandler("remove")}catch(g){}}a(e)},d.widget=function(j,p,l){var h,k,m,g,e=j.split(".")[0];j=j.split(".")[1],h=e+"-"+j,l||(l=p,p=d.Widget),d.expr[":"][h.toLowerCase()]=function(i){return !!d.data(i,h)},d[e]=d[e]||{},k=d[e][j],m=d[e][j]=function(n,i){if(!this._createWidget){return new m(n,i)}arguments.length&&this._createWidget(n,i)},d.extend(m,k,{version:l.version,_proto:d.extend({},l),_childConstructors:[]}),g=new p,g.options=d.widget.extend({},g.options),d.each(l,function(o,n){d.isFunction(n)&&(l[o]=function(){var q=function(){return p.prototype[o].apply(this,arguments)},i=function(r){return p.prototype[o].apply(this,r)};return function(){var r=this._super,v=this._superApply,u;return this._super=q,this._superApply=i,u=n.apply(this,arguments),this._super=r,this._superApply=v,u}}())}),m.prototype=d.widget.extend(g,{widgetEventPrefix:k?g.widgetEventPrefix:j},l,{constructor:m,namespace:e,widgetName:j,widgetBaseClass:h,widgetFullName:h}),k?(d.each(k._childConstructors,function(i,q){var o=q.prototype;d.widget(o.namespace+"."+o.widgetName,m,q._proto)}),delete k._childConstructors):p._childConstructors.push(m),d.widget.bridge(j,m)},d.widget.extend=function(l){var h=c.call(arguments,1),j=0,k=h.length,g,e;for(;j<k;j++){for(g in h[j]){e=h[j][g],h[j].hasOwnProperty(g)&&e!==b&&(d.isPlainObject(e)?l[g]=d.isPlainObject(l[g])?d.widget.extend({},l[g],e):d.widget.extend({},e):l[g]=e)}}return l},d.widget.bridge=function(h,e){var g=e.prototype.widgetFullName||h;d.fn[h]=function(l){var j=typeof l=="string",i=c.call(arguments,1),k=this;return l=!j&&i.length?d.widget.extend.apply(null,[l].concat(i)):l,j?this.each(function(){var n,m=d.data(this,g);if(!m){return d.error("cannot call methods on "+h+" prior to initialization; attempted to call method '"+l+"'")}if(!d.isFunction(m[l])||l.charAt(0)==="_"){return d.error("no such method '"+l+"' for "+h+" widget instance")}n=m[l].apply(m,i);if(n!==m&&n!==b){return k=n&&n.jquery?k.pushStack(n.get()):n,!1}}):this.each(function(){var m=d.data(this,g);m?m.option(l||{})._init():d.data(this,g,new e(l,this))}),k}},d.Widget=function(){},d.Widget._childConstructors=[],d.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(e,g){g=d(g||this.defaultElement||this)[0],this.element=d(g),this.uuid=f++,this.eventNamespace="."+this.widgetName+this.uuid,this.options=d.widget.extend({},this.options,this._getCreateOptions(),e),this.bindings=d(),this.hoverable=d(),this.focusable=d(),g!==this&&(d.data(g,this.widgetName,this),d.data(g,this.widgetFullName,this),this._on(!0,this.element,{remove:function(h){h.target===g&&this.destroy()}}),this.document=d(g.style?g.ownerDocument:g.document||g),this.window=d(this.document[0].defaultView||this.document[0].parentWindow)),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:d.noop,_getCreateEventData:d.noop,_create:d.noop,_init:d.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData(d.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:d.noop,widget:function(){return this.element},option:function(l,j){var g=l,h,k,e;if(arguments.length===0){return d.widget.extend({},this.options)}if(typeof l=="string"){g={},h=l.split("."),l=h.shift();if(h.length){k=g[l]=d.widget.extend({},this.options[l]);for(e=0;e<h.length-1;e++){k[h[e]]=k[h[e]]||{},k=k[h[e]]}l=h.pop();if(j===b){return k[l]===b?null:k[l]}k[l]=j}else{if(j===b){return this.options[l]===b?null:this.options[l]}g[l]=j}}return this._setOptions(g),this},_setOptions:function(h){var g;for(g in h){this._setOption(g,h[g])}return this},_setOption:function(h,g){return this.options[h]=g,h==="disabled"&&(this.widget().toggleClass(this.widgetFullName+"-disabled ui-state-disabled",!!g).attr("aria-disabled",g),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")),this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_on:function(g,k,j){var e,h=this;typeof g!="boolean"&&(j=k,k=g,g=!1),j?(k=e=d(k),this.bindings=this.bindings.add(k)):(j=k,k=this.element,e=this.widget()),d.each(j,function(p,s){function n(){if(!g&&(h.options.disabled===!0||d(this).hasClass("ui-state-disabled"))){return}return(typeof s=="string"?h[s]:s).apply(h,arguments)}typeof s!="string"&&(n.guid=s.guid=s.guid||n.guid||d.guid++);var m=p.match(/^(\w+)\s*(.*)$/),q=m[1]+h.eventNamespace,i=m[2];i?e.delegate(i,q,n):k.bind(q,n)})},_off:function(h,g){g=(g||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,h.unbind(g).undelegate(g)},_delay:function(i,g){function j(){return(typeof i=="string"?h[i]:i).apply(h,arguments)}var h=this;return setTimeout(j,g||0)},_hoverable:function(e){this.hoverable=this.hoverable.add(e),this._on(e,{mouseenter:function(g){d(g.currentTarget).addClass("ui-state-hover")},mouseleave:function(g){d(g.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(e){this.focusable=this.focusable.add(e),this._on(e,{focusin:function(g){d(g.currentTarget).addClass("ui-state-focus")},focusout:function(g){d(g.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(g,l,j){var e,h,k=this.options[g];j=j||{},l=d.Event(l),l.type=(g===this.widgetEventPrefix?g:this.widgetEventPrefix+g).toLowerCase(),l.target=this.element[0],h=l.originalEvent;if(h){for(e in h){e in l||(l[e]=h[e])}}return this.element.trigger(l,j),!(d.isFunction(k)&&k.apply(this.element[0],[l].concat(j))===!1||l.isDefaultPrevented())}},d.each({show:"fadeIn",hide:"fadeOut"},function(e,g){d.Widget.prototype["_"+e]=function(l,j,k){typeof j=="string"&&(j={effect:j});var m,h=j?j===!0||typeof j=="number"?g:j.effect||g:e;j=j||{},typeof j=="number"&&(j={duration:j}),m=!d.isEmptyObject(j),j.complete=k,j.delay&&l.delay(j.delay),m&&d.effects&&(d.effects.effect[h]||d.uiBackCompat!==!1&&d.effects[h])?l[e](j):h!==e&&l[h]?l[h](j.duration,j.easing,k):l.queue(function(i){d(this)[e](),k&&k.call(l[0]),i()})}}),d.uiBackCompat!==!1&&(d.Widget.prototype._getCreateOptions=function(){return d.metadata&&d.metadata.get(this.element[0])[this.widgetName]})})(jQuery);(function(b,a){var c=!1;b(document).mouseup(function(d){c=!1}),b.widget("ui.mouse",{version:"1.9.2",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var d=this;this.element.bind("mousedown."+this.widgetName,function(f){return d._mouseDown(f)}).bind("click."+this.widgetName,function(e){if(!0===b.data(e.target,d.widgetName+".preventClickEvent")){return b.removeData(e.target,d.widgetName+".preventClickEvent"),e.stopImmediatePropagation(),!1}}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),this._mouseMoveDelegate&&b(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(e){if(c){return}this._mouseStarted&&this._mouseUp(e),this._mouseDownEvent=e;var g=this,d=e.which===1,f=typeof this.options.cancel=="string"&&e.target.nodeName?b(e.target).closest(this.options.cancel).length:!1;if(!d||f||!this._mouseCapture(e)){return !0}this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){g.mouseDelayMet=!0},this.options.delay));if(this._mouseDistanceMet(e)&&this._mouseDelayMet(e)){this._mouseStarted=this._mouseStart(e)!==!1;if(!this._mouseStarted){return e.preventDefault(),!0}}return !0===b.data(e.target,this.widgetName+".preventClickEvent")&&b.removeData(e.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(h){return g._mouseMove(h)},this._mouseUpDelegate=function(h){return g._mouseUp(h)},b(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),e.preventDefault(),c=!0,!0},_mouseMove:function(d){return !b.ui.ie||document.documentMode>=9||!!d.button?this._mouseStarted?(this._mouseDrag(d),d.preventDefault()):(this._mouseDistanceMet(d)&&this._mouseDelayMet(d)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,d)!==!1,this._mouseStarted?this._mouseDrag(d):this._mouseUp(d)),!this._mouseStarted):this._mouseUp(d)},_mouseUp:function(d){return b(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,d.target===this._mouseDownEvent.target&&b.data(d.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(d)),!1},_mouseDistanceMet:function(d){return Math.max(Math.abs(this._mouseDownEvent.pageX-d.pageX),Math.abs(this._mouseDownEvent.pageY-d.pageY))>=this.options.distance},_mouseDelayMet:function(d){return this.mouseDelayMet},_mouseStart:function(d){},_mouseDrag:function(d){},_mouseStop:function(d){},_mouseCapture:function(d){return !0}})})(jQuery);(function(b,a){b.widget("ui.draggable",b.ui.mouse,{version:"1.9.2",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1},_create:function(){this.options.helper=="original"&&!/^(?:r|a|f)/.test(this.element.css("position"))&&(this.element[0].style.position="relative"),this.options.addClasses&&this.element.addClass("ui-draggable"),this.options.disabled&&this.element.addClass("ui-draggable-disabled"),this._mouseInit()},_destroy:function(){this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._mouseDestroy()},_mouseCapture:function(c){var d=this.options;return this.helper||d.disabled||b(c.target).is(".ui-resizable-handle")?!1:(this.handle=this._getHandle(c),this.handle?(b(d.iframeFix===!0?"iframe":d.iframeFix).each(function(){b('<div class="ui-draggable-iframeFix" style="background: #fff;"></div>').css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1000}).css(b(this).offset()).appendTo("body")}),!0):!1)},_mouseStart:function(c){var d=this.options;return this.helper=this._createHelper(c),this.helper.addClass("ui-draggable-dragging"),this._cacheHelperProportions(),b.ui.ddmanager&&(b.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(),this.offset=this.positionAbs=this.element.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},b.extend(this.offset,{click:{left:c.pageX-this.offset.left,top:c.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.originalPosition=this.position=this._generatePosition(c),this.originalPageX=c.pageX,this.originalPageY=c.pageY,d.cursorAt&&this._adjustOffsetFromHelper(d.cursorAt),d.containment&&this._setContainment(),this._trigger("start",c)===!1?(this._clear(),!1):(this._cacheHelperProportions(),b.ui.ddmanager&&!d.dropBehaviour&&b.ui.ddmanager.prepareOffsets(this,c),this._mouseDrag(c,!0),b.ui.ddmanager&&b.ui.ddmanager.dragStart(this,c),!0)},_mouseDrag:function(c,e){this.position=this._generatePosition(c),this.positionAbs=this._convertPositionTo("absolute");if(!e){var d=this._uiHash();if(this._trigger("drag",c,d)===!1){return this._mouseUp({}),!1}this.position=d.position}if(!this.options.axis||this.options.axis!="y"){this.helper[0].style.left=this.position.left+"px"}if(!this.options.axis||this.options.axis!="x"){this.helper[0].style.top=this.position.top+"px"}return b.ui.ddmanager&&b.ui.ddmanager.drag(this,c),!1},_mouseStop:function(d){var g=!1;b.ui.ddmanager&&!this.options.dropBehaviour&&(g=b.ui.ddmanager.drop(this,d)),this.dropped&&(g=this.dropped,this.dropped=!1);var f=this.element[0],c=!1;while(f&&(f=f.parentNode)){f==document&&(c=!0)}if(!c&&this.options.helper==="original"){return !1}if(this.options.revert=="invalid"&&!g||this.options.revert=="valid"&&g||this.options.revert===!0||b.isFunction(this.options.revert)&&this.options.revert.call(this.element,g)){var e=this;b(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){e._trigger("stop",d)!==!1&&e._clear()})}else{this._trigger("stop",d)!==!1&&this._clear()}return !1},_mouseUp:function(c){return b("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)}),b.ui.ddmanager&&b.ui.ddmanager.dragStop(this,c),b.ui.mouse.prototype._mouseUp.call(this,c)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear(),this},_getHandle:function(c){var d=!this.options.handle||!b(this.options.handle,this.element).length?!0:!1;return b(this.options.handle,this.element).find("*").andSelf().each(function(){this==c.target&&(d=!0)}),d},_createHelper:function(c){var e=this.options,d=b.isFunction(e.helper)?b(e.helper.apply(this.element[0],[c])):e.helper=="clone"?this.element.clone().removeAttr("id"):this.element;return d.parents("body").length||d.appendTo(e.appendTo=="parent"?this.element[0].parentNode:e.appendTo),d[0]!=this.element[0]&&!/(fixed|absolute)/.test(d.css("position"))&&d.css("position","absolute"),d},_adjustOffsetFromHelper:function(c){typeof c=="string"&&(c=c.split(" ")),b.isArray(c)&&(c={left:+c[0],top:+c[1]||0}),"left" in c&&(this.offset.click.left=c.left+this.margins.left),"right" in c&&(this.offset.click.left=this.helperProportions.width-c.right+this.margins.left),"top" in c&&(this.offset.click.top=c.top+this.margins.top),"bottom" in c&&(this.offset.click.top=this.helperProportions.height-c.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var c=this.offsetParent.offset();this.cssPosition=="absolute"&&this.scrollParent[0]!=document&&b.contains(this.scrollParent[0],this.offsetParent[0])&&(c.left+=this.scrollParent.scrollLeft(),c.top+=this.scrollParent.scrollTop());if(this.offsetParent[0]==document.body||this.offsetParent[0].tagName&&this.offsetParent[0].tagName.toLowerCase()=="html"&&b.ui.ie){c={top:0,left:0}}return{top:c.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:c.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if(this.cssPosition=="relative"){var c=this.element.position();return{top:c.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:c.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var d=this.options;d.containment=="parent"&&(d.containment=this.helper[0].parentNode);if(d.containment=="document"||d.containment=="window"){this.containment=[d.containment=="document"?0:b(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,d.containment=="document"?0:b(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,(d.containment=="document"?0:b(window).scrollLeft())+b(d.containment=="document"?document:window).width()-this.helperProportions.width-this.margins.left,(d.containment=="document"?0:b(window).scrollTop())+(b(d.containment=="document"?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]}if(!/^(document|window|parent)$/.test(d.containment)&&d.containment.constructor!=Array){var g=b(d.containment),f=g[0];if(!f){return}var c=g.offset(),e=b(f).css("overflow")!="hidden";this.containment=[(parseInt(b(f).css("borderLeftWidth"),10)||0)+(parseInt(b(f).css("paddingLeft"),10)||0),(parseInt(b(f).css("borderTopWidth"),10)||0)+(parseInt(b(f).css("paddingTop"),10)||0),(e?Math.max(f.scrollWidth,f.offsetWidth):f.offsetWidth)-(parseInt(b(f).css("borderLeftWidth"),10)||0)-(parseInt(b(f).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(e?Math.max(f.scrollHeight,f.offsetHeight):f.offsetHeight)-(parseInt(b(f).css("borderTopWidth"),10)||0)-(parseInt(b(f).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relative_container=g}else{d.containment.constructor==Array&&(this.containment=d.containment)}},_convertPositionTo:function(d,h){h||(h=this.position);var f=d=="absolute"?1:-1,c=this.options,e=this.cssPosition!="absolute"||this.scrollParent[0]!=document&&!!b.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,g=/(html|body)/i.test(e[0].tagName);return{top:h.top+this.offset.relative.top*f+this.offset.parent.top*f-(this.cssPosition=="fixed"?-this.scrollParent.scrollTop():g?0:e.scrollTop())*f,left:h.left+this.offset.relative.left*f+this.offset.parent.left*f-(this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():g?0:e.scrollLeft())*f}},_generatePosition:function(p){var e=this.options,c=this.cssPosition!="absolute"||this.scrollParent[0]!=document&&!!b.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,h=/(html|body)/i.test(c[0].tagName),q=p.pageX,d=p.pageY;if(this.originalPosition){var m;if(this.containment){if(this.relative_container){var k=this.relative_container.offset();m=[this.containment[0]+k.left,this.containment[1]+k.top,this.containment[2]+k.left,this.containment[3]+k.top]}else{m=this.containment}p.pageX-this.offset.click.left<m[0]&&(q=m[0]+this.offset.click.left),p.pageY-this.offset.click.top<m[1]&&(d=m[1]+this.offset.click.top),p.pageX-this.offset.click.left>m[2]&&(q=m[2]+this.offset.click.left),p.pageY-this.offset.click.top>m[3]&&(d=m[3]+this.offset.click.top)}if(e.grid){var j=e.grid[1]?this.originalPageY+Math.round((d-this.originalPageY)/e.grid[1])*e.grid[1]:this.originalPageY;d=m?j-this.offset.click.top<m[1]||j-this.offset.click.top>m[3]?j-this.offset.click.top<m[1]?j+e.grid[1]:j-e.grid[1]:j:j;var g=e.grid[0]?this.originalPageX+Math.round((q-this.originalPageX)/e.grid[0])*e.grid[0]:this.originalPageX;q=m?g-this.offset.click.left<m[0]||g-this.offset.click.left>m[2]?g-this.offset.click.left<m[0]?g+e.grid[0]:g-e.grid[0]:g:g}}return{top:d-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+(this.cssPosition=="fixed"?-this.scrollParent.scrollTop():h?0:c.scrollTop()),left:q-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():h?0:c.scrollLeft())}},_clear:function(){this.helper.removeClass("ui-draggable-dragging"),this.helper[0]!=this.element[0]&&!this.cancelHelperRemoval&&this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1},_trigger:function(c,e,d){return d=d||this._uiHash(),b.ui.plugin.call(this,c,[e,d]),c=="drag"&&(this.positionAbs=this._convertPositionTo("absolute")),b.Widget.prototype._trigger.call(this,c,e,d)},plugins:{},_uiHash:function(c){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),b.ui.plugin.add("draggable","connectToSortable",{start:function(d,g){var f=b(this).data("draggable"),c=f.options,e=b.extend({},g,{item:f.element});f.sortables=[],b(c.connectToSortable).each(function(){var h=b.data(this,"sortable");h&&!h.options.disabled&&(f.sortables.push({instance:h,shouldRevert:h.options.revert}),h.refreshPositions(),h._trigger("activate",d,e))})},stop:function(d,f){var e=b(this).data("draggable"),c=b.extend({},f,{item:e.element});b.each(e.sortables,function(){this.instance.isOver?(this.instance.isOver=0,e.cancelHelperRemoval=!0,this.instance.cancelHelperRemoval=!1,this.shouldRevert&&(this.instance.options.revert=!0),this.instance._mouseStop(d),this.instance.options.helper=this.instance.options._helper,e.options.helper=="original"&&this.instance.currentItem.css({top:"auto",left:"auto"})):(this.instance.cancelHelperRemoval=!1,this.instance._trigger("deactivate",d,c))})},drag:function(d,g){var f=b(this).data("draggable"),c=this,e=function(v){var k=this.offset.click.top,h=this.offset.click.left,l=this.positionAbs.top,w=this.positionAbs.left,j=v.height,q=v.width,p=v.top,m=v.left;return b.ui.isOver(l+k,w+h,p,m,j,q)};b.each(f.sortables,function(i){var j=!1,h=this;this.instance.positionAbs=f.positionAbs,this.instance.helperProportions=f.helperProportions,this.instance.offset.click=f.offset.click,this.instance._intersectsWith(this.instance.containerCache)&&(j=!0,b.each(f.sortables,function(){return this.instance.positionAbs=f.positionAbs,this.instance.helperProportions=f.helperProportions,this.instance.offset.click=f.offset.click,this!=h&&this.instance._intersectsWith(this.instance.containerCache)&&b.ui.contains(h.instance.element[0],this.instance.element[0])&&(j=!1),j})),j?(this.instance.isOver||(this.instance.isOver=1,this.instance.currentItem=b(c).clone().removeAttr("id").appendTo(this.instance.element).data("sortable-item",!0),this.instance.options._helper=this.instance.options.helper,this.instance.options.helper=function(){return g.helper[0]},d.target=this.instance.currentItem[0],this.instance._mouseCapture(d,!0),this.instance._mouseStart(d,!0,!0),this.instance.offset.click.top=f.offset.click.top,this.instance.offset.click.left=f.offset.click.left,this.instance.offset.parent.left-=f.offset.parent.left-this.instance.offset.parent.left,this.instance.offset.parent.top-=f.offset.parent.top-this.instance.offset.parent.top,f._trigger("toSortable",d),f.dropped=this.instance.element,f.currentItem=f.element,this.instance.fromOutside=f),this.instance.currentItem&&this.instance._mouseDrag(d)):this.instance.isOver&&(this.instance.isOver=0,this.instance.cancelHelperRemoval=!0,this.instance.options.revert=!1,this.instance._trigger("out",d,this.instance._uiHash(this.instance)),this.instance._mouseStop(d,!0),this.instance.options.helper=this.instance.options._helper,this.instance.currentItem.remove(),this.instance.placeholder&&this.instance.placeholder.remove(),f._trigger("fromSortable",d),f.dropped=!1)})}}),b.ui.plugin.add("draggable","cursor",{start:function(d,f){var e=b("body"),c=b(this).data("draggable").options;e.css("cursor")&&(c._cursor=e.css("cursor")),e.css("cursor",c.cursor)},stop:function(c,e){var d=b(this).data("draggable").options;d._cursor&&b("body").css("cursor",d._cursor)}}),b.ui.plugin.add("draggable","opacity",{start:function(d,f){var e=b(f.helper),c=b(this).data("draggable").options;e.css("opacity")&&(c._opacity=e.css("opacity")),e.css("opacity",c.opacity)},stop:function(c,e){var d=b(this).data("draggable").options;d._opacity&&b(e.helper).css("opacity",d._opacity)}}),b.ui.plugin.add("draggable","scroll",{start:function(c,e){var d=b(this).data("draggable");d.scrollParent[0]!=document&&d.scrollParent[0].tagName!="HTML"&&(d.overflowOffset=d.scrollParent.offset())},drag:function(d,g){var f=b(this).data("draggable"),c=f.options,e=!1;if(f.scrollParent[0]!=document&&f.scrollParent[0].tagName!="HTML"){if(!c.axis||c.axis!="x"){f.overflowOffset.top+f.scrollParent[0].offsetHeight-d.pageY<c.scrollSensitivity?f.scrollParent[0].scrollTop=e=f.scrollParent[0].scrollTop+c.scrollSpeed:d.pageY-f.overflowOffset.top<c.scrollSensitivity&&(f.scrollParent[0].scrollTop=e=f.scrollParent[0].scrollTop-c.scrollSpeed)}if(!c.axis||c.axis!="y"){f.overflowOffset.left+f.scrollParent[0].offsetWidth-d.pageX<c.scrollSensitivity?f.scrollParent[0].scrollLeft=e=f.scrollParent[0].scrollLeft+c.scrollSpeed:d.pageX-f.overflowOffset.left<c.scrollSensitivity&&(f.scrollParent[0].scrollLeft=e=f.scrollParent[0].scrollLeft-c.scrollSpeed)}}else{if(!c.axis||c.axis!="x"){d.pageY-b(document).scrollTop()<c.scrollSensitivity?e=b(document).scrollTop(b(document).scrollTop()-c.scrollSpeed):b(window).height()-(d.pageY-b(document).scrollTop())<c.scrollSensitivity&&(e=b(document).scrollTop(b(document).scrollTop()+c.scrollSpeed))}if(!c.axis||c.axis!="y"){d.pageX-b(document).scrollLeft()<c.scrollSensitivity?e=b(document).scrollLeft(b(document).scrollLeft()-c.scrollSpeed):b(window).width()-(d.pageX-b(document).scrollLeft())<c.scrollSensitivity&&(e=b(document).scrollLeft(b(document).scrollLeft()+c.scrollSpeed))}}e!==!1&&b.ui.ddmanager&&!c.dropBehaviour&&b.ui.ddmanager.prepareOffsets(f,d)}}),b.ui.plugin.add("draggable","snap",{start:function(d,f){var e=b(this).data("draggable"),c=e.options;e.snapElements=[],b(c.snap.constructor!=String?c.snap.items||":data(draggable)":c.snap).each(function(){var g=b(this),h=g.offset();this!=e.element[0]&&e.snapElements.push({item:this,width:g.outerWidth(),height:g.outerHeight(),top:h.top,left:h.left})})},drag:function(q,B){var x=b(this).data("draggable"),E=x.options,w=E.snapTolerance,A=B.offset.left,k=A+x.helperProportions.width,L=B.offset.top,H=L+x.helperProportions.height;for(var D=x.snapElements.length-1;D>=0;D--){var J=x.snapElements[D].left,F=J+x.snapElements[D].width,z=x.snapElements[D].top,I=z+x.snapElements[D].height;if(!(J-w<A&&A<F+w&&z-w<L&&L<I+w||J-w<A&&A<F+w&&z-w<H&&H<I+w||J-w<k&&k<F+w&&z-w<L&&L<I+w||J-w<k&&k<F+w&&z-w<H&&H<I+w)){x.snapElements[D].snapping&&x.options.snap.release&&x.options.snap.release.call(x.element,q,b.extend(x._uiHash(),{snapItem:x.snapElements[D].item})),x.snapElements[D].snapping=!1;continue}if(E.snapMode!="inner"){var j=Math.abs(z-H)<=w,C=Math.abs(I-L)<=w,G=Math.abs(J-k)<=w,e=Math.abs(F-A)<=w;j&&(B.position.top=x._convertPositionTo("relative",{top:z-x.helperProportions.height,left:0}).top-x.margins.top),C&&(B.position.top=x._convertPositionTo("relative",{top:I,left:0}).top-x.margins.top),G&&(B.position.left=x._convertPositionTo("relative",{top:0,left:J-x.helperProportions.width}).left-x.margins.left),e&&(B.position.left=x._convertPositionTo("relative",{top:0,left:F}).left-x.margins.left)}var K=j||C||G||e;if(E.snapMode!="outer"){var j=Math.abs(z-L)<=w,C=Math.abs(I-H)<=w,G=Math.abs(J-A)<=w,e=Math.abs(F-k)<=w;j&&(B.position.top=x._convertPositionTo("relative",{top:z,left:0}).top-x.margins.top),C&&(B.position.top=x._convertPositionTo("relative",{top:I-x.helperProportions.height,left:0}).top-x.margins.top),G&&(B.position.left=x._convertPositionTo("relative",{top:0,left:J}).left-x.margins.left),e&&(B.position.left=x._convertPositionTo("relative",{top:0,left:F-x.helperProportions.width}).left-x.margins.left)}!x.snapElements[D].snapping&&(j||C||G||e||K)&&x.options.snap.snap&&x.options.snap.snap.call(x.element,q,b.extend(x._uiHash(),{snapItem:x.snapElements[D].item})),x.snapElements[D].snapping=j||C||G||e||K}}}),b.ui.plugin.add("draggable","stack",{start:function(d,g){var f=b(this).data("draggable").options,c=b.makeArray(b(f.stack)).sort(function(h,i){return(parseInt(b(h).css("zIndex"),10)||0)-(parseInt(b(i).css("zIndex"),10)||0)});if(!c.length){return}var e=parseInt(c[0].style.zIndex)||0;b(c).each(function(h){this.style.zIndex=e+h}),this[0].style.zIndex=e+c.length}}),b.ui.plugin.add("draggable","zIndex",{start:function(d,f){var e=b(f.helper),c=b(this).data("draggable").options;e.css("zIndex")&&(c._zIndex=e.css("zIndex")),e.css("zIndex",c.zIndex)},stop:function(c,e){var d=b(this).data("draggable").options;d._zIndex&&b(e.helper).css("zIndex",d._zIndex)}})})(jQuery);(function(c,a){c.widget("ui.resizable",c.ui.mouse,{version:"1.9.2",widgetEventPrefix:"resize",options:{alsoResize:!1,animate:!1,animateDuration:"slow",animateEasing:"swing",aspectRatio:!1,autoHide:!1,containment:!1,ghost:!1,grid:!1,handles:"e,s,se",helper:!1,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:1000},_create:function(){var g=this,l=this.options;this.element.addClass("ui-resizable"),c.extend(this,{_aspectRatio:!!l.aspectRatio,aspectRatio:l.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:l.helper||l.ghost||l.animate?l.helper||"ui-resizable-helper":null}),this.element[0].nodeName.match(/canvas|textarea|input|select|button|img/i)&&(this.element.wrap(c('<div class="ui-wrapper" style="overflow: hidden;"></div>').css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")})),this.element=this.element.parent().data("resizable",this.element.data("resizable")),this.elementIsWrapper=!0,this.element.css({marginLeft:this.originalElement.css("marginLeft"),marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom")}),this.originalElement.css({marginLeft:0,marginTop:0,marginRight:0,marginBottom:0}),this.originalResizeStyle=this.originalElement.css("resize"),this.originalElement.css("resize","none"),this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"})),this.originalElement.css({margin:this.originalElement.css("margin")}),this._proportionallyResize()),this.handles=l.handles||(c(".ui-resizable-handle",this.element).length?{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"}:"e,s,se");if(this.handles.constructor==String){this.handles=="all"&&(this.handles="n,e,s,w,se,sw,ne,nw");var j=this.handles.split(",");this.handles={};for(var f=0;f<j.length;f++){var h=c.trim(j[f]),k="ui-resizable-"+h,e=c('<div class="ui-resizable-handle '+k+'"></div>');e.css({zIndex:l.zIndex}),"se"==h&&e.addClass("ui-icon ui-icon-gripsmall-diagonal-se"),this.handles[h]=".ui-resizable-"+h,this.element.append(e)}}this._renderAxis=function(o){o=o||this.element;for(var u in this.handles){this.handles[u].constructor==String&&(this.handles[u]=c(this.handles[u],this.element).show());if(this.elementIsWrapper&&this.originalElement[0].nodeName.match(/textarea|input|select|button/i)){var q=c(this.handles[u],this.element),m=0;m=/sw|ne|nw|se|n|s/.test(u)?q.outerHeight():q.outerWidth();var p=["padding",/ne|nw|n/.test(u)?"Top":/se|sw|s/.test(u)?"Bottom":/^e$/.test(u)?"Right":"Left"].join("");o.css(p,m),this._proportionallyResize()}if(!c(this.handles[u]).length){continue}}},this._renderAxis(this.element),this._handles=c(".ui-resizable-handle",this.element).disableSelection(),this._handles.mouseover(function(){if(!g.resizing){if(this.className){var i=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i)}g.axis=i&&i[1]?i[1]:"se"}}),l.autoHide&&(this._handles.hide(),c(this.element).addClass("ui-resizable-autohide").mouseenter(function(){if(l.disabled){return}c(this).removeClass("ui-resizable-autohide"),g._handles.show()}).mouseleave(function(){if(l.disabled){return}g.resizing||(c(this).addClass("ui-resizable-autohide"),g._handles.hide())})),this._mouseInit()},_destroy:function(){this._mouseDestroy();var e=function(g){c(g).removeClass("ui-resizable ui-resizable-disabled ui-resizable-resizing").removeData("resizable").removeData("ui-resizable").unbind(".resizable").find(".ui-resizable-handle").remove()};if(this.elementIsWrapper){e(this.element);var f=this.element;this.originalElement.css({position:f.css("position"),width:f.outerWidth(),height:f.outerHeight(),top:f.css("top"),left:f.css("left")}).insertAfter(f),f.remove()}return this.originalElement.css("resize",this.originalResizeStyle),e(this.originalElement),this},_mouseCapture:function(e){var g=!1;for(var f in this.handles){c(this.handles[f])[0]==e.target&&(g=!0)}return !this.options.disabled&&g},_mouseStart:function(h){var k=this.options,g=this.element.position(),j=this.element;this.resizing=!0,this.documentScroll={top:c(document).scrollTop(),left:c(document).scrollLeft()},(j.is(".ui-draggable")||/absolute/.test(j.css("position")))&&j.css({position:"absolute",top:g.top,left:g.left}),this._renderProxy();var l=d(this.helper.css("left")),f=d(this.helper.css("top"));k.containment&&(l+=c(k.containment).scrollLeft()||0,f+=c(k.containment).scrollTop()||0),this.offset=this.helper.offset(),this.position={left:l,top:f},this.size=this._helper?{width:j.outerWidth(),height:j.outerHeight()}:{width:j.width(),height:j.height()},this.originalSize=this._helper?{width:j.outerWidth(),height:j.outerHeight()}:{width:j.width(),height:j.height()},this.originalPosition={left:l,top:f},this.sizeDiff={width:j.outerWidth()-j.width(),height:j.outerHeight()-j.height()},this.originalMousePosition={left:h.pageX,top:h.pageY},this.aspectRatio=typeof k.aspectRatio=="number"?k.aspectRatio:this.originalSize.width/this.originalSize.height||1;var e=c(".ui-resizable-"+this.axis).css("cursor");return c("body").css("cursor",e=="auto"?this.axis+"-resize":e),j.addClass("ui-resizable-resizing"),this._propagate("start",h),!0},_mouseDrag:function(q){var x=this.helper,j=this.options,g={},m=this,y=this.originalMousePosition,h=this.axis,w=q.pageX-y.left||0,v=q.pageY-y.top||0,p=this._change[h];if(!p){return !1}var k=p.apply(this,[q,w,v]);this._updateVirtualBoundaries(q.shiftKey);if(this._aspectRatio||q.shiftKey){k=this._updateRatio(k,q)}return k=this._respectSize(k,q),this._propagate("resize",q),x.css({top:this.position.top+"px",left:this.position.left+"px",width:this.size.width+"px",height:this.size.height+"px"}),!this._helper&&this._proportionallyResizeElements.length&&this._proportionallyResize(),this._updateCache(k),this._trigger("resize",q,this.ui()),!1},_mouseStop:function(v){this.resizing=!1;var h=this.options,e=this;if(this._helper){var k=this._proportionallyResizeElements,w=k.length&&/textarea/i.test(k[0].nodeName),g=w&&c.ui.hasScroll(k[0],"left")?0:e.sizeDiff.height,q=w?0:e.sizeDiff.width,p={width:e.helper.width()-q,height:e.helper.height()-g},m=parseInt(e.element.css("left"),10)+(e.position.left-e.originalPosition.left)||null,j=parseInt(e.element.css("top"),10)+(e.position.top-e.originalPosition.top)||null;h.animate||this.element.css(c.extend(p,{top:j,left:m})),e.helper.height(e.size.height),e.helper.width(e.size.width),this._helper&&!h.animate&&this._proportionallyResize()}return c("body").css("cursor","auto"),this.element.removeClass("ui-resizable-resizing"),this._propagate("stop",v),this._helper&&this.helper.remove(),!1},_updateVirtualBoundaries:function(k){var h=this.options,m,g,j,l,f;f={minWidth:b(h.minWidth)?h.minWidth:0,maxWidth:b(h.maxWidth)?h.maxWidth:Infinity,minHeight:b(h.minHeight)?h.minHeight:0,maxHeight:b(h.maxHeight)?h.maxHeight:Infinity};if(this._aspectRatio||k){m=f.minHeight*this.aspectRatio,j=f.minWidth/this.aspectRatio,g=f.maxHeight*this.aspectRatio,l=f.maxWidth/this.aspectRatio,m>f.minWidth&&(f.minWidth=m),j>f.minHeight&&(f.minHeight=j),g<f.maxWidth&&(f.maxWidth=g),l<f.maxHeight&&(f.maxHeight=l)}this._vBoundaries=f},_updateCache:function(g){var f=this.options;this.offset=this.helper.offset(),b(g.left)&&(this.position.left=g.left),b(g.top)&&(this.position.top=g.top),b(g.height)&&(this.size.height=g.height),b(g.width)&&(this.size.width=g.width)},_updateRatio:function(j,g){var l=this.options,f=this.position,h=this.size,k=this.axis;return b(j.height)?j.width=j.height*this.aspectRatio:b(j.width)&&(j.height=j.width/this.aspectRatio),k=="sw"&&(j.left=f.left+(h.width-j.width),j.top=null),k=="nw"&&(j.top=f.top+(h.height-j.height),j.left=f.left+(h.width-j.width)),j},_respectSize:function(x,D){var k=this.helper,q=this._vBoundaries,E=this._aspectRatio||D.shiftKey,j=this.axis,C=b(x.width)&&q.maxWidth&&q.maxWidth<x.width,A=b(x.height)&&q.maxHeight&&q.maxHeight<x.height,w=b(x.width)&&q.minWidth&&q.minWidth>x.width,m=b(x.height)&&q.minHeight&&q.minHeight>x.height;w&&(x.width=q.minWidth),m&&(x.height=q.minHeight),C&&(x.width=q.maxWidth),A&&(x.height=q.maxHeight);var z=this.originalPosition.left+this.originalSize.width,r=this.position.top+this.size.height,g=/sw|nw|w/.test(j),y=/nw|ne|n/.test(j);w&&g&&(x.left=z-q.minWidth),C&&g&&(x.left=z-q.maxWidth),m&&y&&(x.top=r-q.minHeight),A&&y&&(x.top=r-q.maxHeight);var B=!x.width&&!x.height;return B&&!x.left&&x.top?x.top=null:B&&!x.top&&x.left&&(x.left=null),x},_proportionallyResize:function(){var f=this.options;if(!this._proportionallyResizeElements.length){return}var k=this.helper||this.element;for(var h=0;h<this._proportionallyResizeElements.length;h++){var e=this._proportionallyResizeElements[h];if(!this.borderDif){var g=[e.css("borderTopWidth"),e.css("borderRightWidth"),e.css("borderBottomWidth"),e.css("borderLeftWidth")],j=[e.css("paddingTop"),e.css("paddingRight"),e.css("paddingBottom"),e.css("paddingLeft")];this.borderDif=c.map(g,function(m,i){var o=parseInt(m,10)||0,l=parseInt(j[i],10)||0;return o+l})}e.css({height:k.height()-this.borderDif[0]-this.borderDif[2]||0,width:k.width()-this.borderDif[1]-this.borderDif[3]||0})}},_renderProxy:function(){var f=this.element,h=this.options;this.elementOffset=f.offset();if(this._helper){this.helper=this.helper||c('<div style="overflow:hidden;"></div>');var g=c.ui.ie6?1:0,e=c.ui.ie6?2:-1;this.helper.addClass(this._helper).css({width:this.element.outerWidth()+e,height:this.element.outerHeight()+e,position:"absolute",left:this.elementOffset.left-g+"px",top:this.elementOffset.top-g+"px",zIndex:++h.zIndex}),this.helper.appendTo("body").disableSelection()}else{this.helper=this.element}},_change:{e:function(g,f,h){return{width:this.originalSize.width+f}},w:function(k,g,l){var j=this.options,f=this.originalSize,h=this.originalPosition;return{left:h.left+g,width:f.width-g}},n:function(k,g,l){var j=this.options,f=this.originalSize,h=this.originalPosition;return{top:h.top+l,height:f.height-l}},s:function(g,f,h){return{height:this.originalSize.height+h}},se:function(e,g,f){return c.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[e,g,f]))},sw:function(e,g,f){return c.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[e,g,f]))},ne:function(e,g,f){return c.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[e,g,f]))},nw:function(e,g,f){return c.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[e,g,f]))}},_propagate:function(e,f){c.ui.plugin.call(this,e,[f,this.ui()]),e!="resize"&&this._trigger(e,f,this.ui())},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}}),c.ui.plugin.add("resizable","alsoResize",{start:function(f,j){var h=c(this).data("resizable"),e=h.options,g=function(i){c(i).each(function(){var k=c(this);k.data("resizable-alsoresize",{width:parseInt(k.width(),10),height:parseInt(k.height(),10),left:parseInt(k.css("left"),10),top:parseInt(k.css("top"),10)})})};typeof e.alsoResize=="object"&&!e.alsoResize.parentNode?e.alsoResize.length?(e.alsoResize=e.alsoResize[0],g(e.alsoResize)):c.each(e.alsoResize,function(i){g(i)}):g(e.alsoResize)},resize:function(h,m){var k=c(this).data("resizable"),g=k.options,j=k.originalSize,l=k.originalPosition,f={height:k.size.height-j.height||0,width:k.size.width-j.width||0,top:k.position.top-l.top||0,left:k.position.left-l.left||0},e=function(i,n){c(i).each(function(){var q=c(this),p=c(this).data("resizable-alsoresize"),r={},u=n&&n.length?n:q.parents(m.originalElement[0]).length?["width","height"]:["width","height","top","left"];c.each(u,function(s,o){var v=(p[o]||0)+(f[o]||0);v&&v>=0&&(r[o]=v||null)}),q.css(r)})};typeof g.alsoResize=="object"&&!g.alsoResize.nodeType?c.each(g.alsoResize,function(n,i){e(n,i)}):e(g.alsoResize)},stop:function(e,f){c(this).removeData("resizable-alsoresize")}}),c.ui.plugin.add("resizable","animate",{stop:function(w,h){var e=c(this).data("resizable"),k=e.options,x=e._proportionallyResizeElements,g=x.length&&/textarea/i.test(x[0].nodeName),v=g&&c.ui.hasScroll(x[0],"left")?0:e.sizeDiff.height,q=g?0:e.sizeDiff.width,m={width:e.size.width-q,height:e.size.height-v},j=parseInt(e.element.css("left"),10)+(e.position.left-e.originalPosition.left)||null,p=parseInt(e.element.css("top"),10)+(e.position.top-e.originalPosition.top)||null;e.element.animate(c.extend(m,p&&j?{top:p,left:j}:{}),{duration:k.animateDuration,easing:k.animateEasing,step:function(){var f={width:parseInt(e.element.css("width"),10),height:parseInt(e.element.css("height"),10),top:parseInt(e.element.css("top"),10),left:parseInt(e.element.css("left"),10)};x&&x.length&&c(x[0]).css({width:f.width,height:f.height}),e._updateCache(f),e._propagate("resize",w)}})}}),c.ui.plugin.add("resizable","containment",{start:function(B,e){var m=c(this).data("resizable"),C=m.options,j=m.element,A=C.containment,y=A instanceof c?A.get(0):/parent/.test(A)?j.parent().get(0):A;if(!y){return}m.containerElement=c(y);if(/document/.test(A)||A==document){m.containerOffset={left:0,top:0},m.containerPosition={left:0,top:0},m.parentData={element:c(document),left:0,top:0,width:c(document).width(),height:c(document).height()||document.body.parentNode.scrollHeight}}else{var q=c(y),k=[];c(["Top","Right","Left","Bottom"]).each(function(h,f){k[h]=d(q.css("padding"+f))}),m.containerOffset=q.offset(),m.containerPosition=q.position(),m.containerSize={height:q.innerHeight()-k[3],width:q.innerWidth()-k[1]};var x=m.containerOffset,n=m.containerSize.height,g=m.containerSize.width,w=c.ui.hasScroll(y,"left")?y.scrollWidth:g,z=c.ui.hasScroll(y)?y.scrollHeight:n;m.parentData={element:y,left:x.left,top:x.top,width:w,height:z}}},resize:function(D,k){var e=c(this).data("resizable"),q=e.options,E=e.containerSize,j=e.containerOffset,C=e.size,A=e.position,x=e._aspectRatio||D.shiftKey,m={top:0,left:0},z=e.containerElement;z[0]!=document&&/static/.test(z.css("position"))&&(m=j),A.left<(e._helper?j.left:0)&&(e.size.width=e.size.width+(e._helper?e.position.left-j.left:e.position.left-m.left),x&&(e.size.height=e.size.width/e.aspectRatio),e.position.left=q.helper?j.left:0),A.top<(e._helper?j.top:0)&&(e.size.height=e.size.height+(e._helper?e.position.top-j.top:e.position.top),x&&(e.size.width=e.size.height*e.aspectRatio),e.position.top=e._helper?j.top:0),e.offset.left=e.parentData.left+e.position.left,e.offset.top=e.parentData.top+e.position.top;var w=Math.abs((e._helper?e.offset.left-m.left:e.offset.left-m.left)+e.sizeDiff.width),g=Math.abs((e._helper?e.offset.top-m.top:e.offset.top-j.top)+e.sizeDiff.height),y=e.containerElement.get(0)==e.element.parent().get(0),B=/relative|absolute/.test(e.containerElement.css("position"));y&&B&&(w-=e.parentData.left),w+e.size.width>=e.parentData.width&&(e.size.width=e.parentData.width-w,x&&(e.size.height=e.size.width/e.aspectRatio)),g+e.size.height>=e.parentData.height&&(e.size.height=e.parentData.height-g,x&&(e.size.width=e.size.height*e.aspectRatio))},stop:function(y,j){var e=c(this).data("resizable"),m=e.options,z=e.position,g=e.containerOffset,x=e.containerPosition,w=e.containerElement,q=c(e.helper),k=q.offset(),v=q.outerWidth()-e.sizeDiff.width,p=q.outerHeight()-e.sizeDiff.height;e._helper&&!m.animate&&/relative/.test(w.css("position"))&&c(this).css({left:k.left-x.left-g.left,width:v,height:p}),e._helper&&!m.animate&&/static/.test(w.css("position"))&&c(this).css({left:k.left-x.left-g.left,width:v,height:p})}}),c.ui.plugin.add("resizable","ghost",{start:function(f,j){var h=c(this).data("resizable"),e=h.options,g=h.size;h.ghost=h.originalElement.clone(),h.ghost.css({opacity:0.25,display:"block",position:"relative",height:g.height,width:g.width,margin:0,left:0,top:0}).addClass("ui-resizable-ghost").addClass(typeof e.ghost=="string"?e.ghost:""),h.ghost.appendTo(h.helper)},resize:function(f,h){var g=c(this).data("resizable"),e=g.options;g.ghost&&g.ghost.css({position:"relative",height:g.size.height,width:g.size.width})},stop:function(f,h){var g=c(this).data("resizable"),e=g.options;g.ghost&&g.helper&&g.helper.get(0).removeChild(g.ghost.get(0))}}),c.ui.plugin.add("resizable","grid",{resize:function(w,h){var e=c(this).data("resizable"),k=e.options,x=e.size,g=e.originalSize,v=e.originalPosition,q=e.axis,m=k._aspectRatio||w.shiftKey;k.grid=typeof k.grid=="number"?[k.grid,k.grid]:k.grid;var j=Math.round((x.width-g.width)/(k.grid[0]||1))*(k.grid[0]||1),p=Math.round((x.height-g.height)/(k.grid[1]||1))*(k.grid[1]||1);/^(se|s|e)$/.test(q)?(e.size.width=g.width+j,e.size.height=g.height+p):/^(ne)$/.test(q)?(e.size.width=g.width+j,e.size.height=g.height+p,e.position.top=v.top-p):/^(sw)$/.test(q)?(e.size.width=g.width+j,e.size.height=g.height+p,e.position.left=v.left-j):(e.size.width=g.width+j,e.size.height=g.height+p,e.position.top=v.top-p,e.position.left=v.left-j)}});var d=function(f){return parseInt(f,10)||0},b=function(f){return !isNaN(parseInt(f,10))}})(jQuery);(function(b,a){b.widget("ui.sortable",b.ui.mouse,{version:"1.9.2",widgetEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1000},_create:function(){var c=this.options;this.containerCache={},this.element.addClass("ui-sortable"),this.refresh(),this.floating=this.items.length?c.axis==="x"||/left|right/.test(this.items[0].item.css("float"))||/inline|table-cell/.test(this.items[0].item.css("display")):!1,this.offset=this.element.offset(),this._mouseInit(),this.ready=!0},_destroy:function(){this.element.removeClass("ui-sortable ui-sortable-disabled"),this._mouseDestroy();for(var c=this.items.length-1;c>=0;c--){this.items[c].item.removeData(this.widgetName+"-item")}return this},_setOption:function(c,d){c==="disabled"?(this.options[c]=d,this.widget().toggleClass("ui-sortable-disabled",!!d)):b.Widget.prototype._setOption.apply(this,arguments)},_mouseCapture:function(d,h){var f=this;if(this.reverting){return !1}if(this.options.disabled||this.options.type=="static"){return !1}this._refreshItems(d);var c=null,e=b(d.target).parents().each(function(){if(b.data(this,f.widgetName+"-item")==f){return c=b(this),!1}});b.data(d.target,f.widgetName+"-item")==f&&(c=b(d.target));if(!c){return !1}if(this.options.handle&&!h){var g=!1;b(this.options.handle,c).find("*").andSelf().each(function(){this==d.target&&(g=!0)});if(!g){return !1}}return this.currentItem=c,this._removeCurrentsFromItems(),!0},_mouseStart:function(d,g,f){var c=this.options;this.currentContainer=this,this.refreshPositions(),this.helper=this._createHelper(d),this._cacheHelperProportions(),this._cacheMargins(),this.scrollParent=this.helper.scrollParent(),this.offset=this.currentItem.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},b.extend(this.offset,{click:{left:d.pageX-this.offset.left,top:d.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.helper.css("position","absolute"),this.cssPosition=this.helper.css("position"),this.originalPosition=this._generatePosition(d),this.originalPageX=d.pageX,this.originalPageY=d.pageY,c.cursorAt&&this._adjustOffsetFromHelper(c.cursorAt),this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]},this.helper[0]!=this.currentItem[0]&&this.currentItem.hide(),this._createPlaceholder(),c.containment&&this._setContainment(),c.cursor&&(b("body").css("cursor")&&(this._storedCursor=b("body").css("cursor")),b("body").css("cursor",c.cursor)),c.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",c.opacity)),c.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",c.zIndex)),this.scrollParent[0]!=document&&this.scrollParent[0].tagName!="HTML"&&(this.overflowOffset=this.scrollParent.offset()),this._trigger("start",d,this._uiHash()),this._preserveHelperProportions||this._cacheHelperProportions();if(!f){for(var e=this.containers.length-1;e>=0;e--){this.containers[e]._trigger("activate",d,this._uiHash(this))}}return b.ui.ddmanager&&(b.ui.ddmanager.current=this),b.ui.ddmanager&&!c.dropBehaviour&&b.ui.ddmanager.prepareOffsets(this,d),this.dragging=!0,this.helper.addClass("ui-sortable-helper"),this._mouseDrag(d),!0},_mouseDrag:function(e){this.position=this._generatePosition(e),this.positionAbs=this._convertPositionTo("absolute"),this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs);if(this.options.scroll){var j=this.options,g=!1;this.scrollParent[0]!=document&&this.scrollParent[0].tagName!="HTML"?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-e.pageY<j.scrollSensitivity?this.scrollParent[0].scrollTop=g=this.scrollParent[0].scrollTop+j.scrollSpeed:e.pageY-this.overflowOffset.top<j.scrollSensitivity&&(this.scrollParent[0].scrollTop=g=this.scrollParent[0].scrollTop-j.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-e.pageX<j.scrollSensitivity?this.scrollParent[0].scrollLeft=g=this.scrollParent[0].scrollLeft+j.scrollSpeed:e.pageX-this.overflowOffset.left<j.scrollSensitivity&&(this.scrollParent[0].scrollLeft=g=this.scrollParent[0].scrollLeft-j.scrollSpeed)):(e.pageY-b(document).scrollTop()<j.scrollSensitivity?g=b(document).scrollTop(b(document).scrollTop()-j.scrollSpeed):b(window).height()-(e.pageY-b(document).scrollTop())<j.scrollSensitivity&&(g=b(document).scrollTop(b(document).scrollTop()+j.scrollSpeed)),e.pageX-b(document).scrollLeft()<j.scrollSensitivity?g=b(document).scrollLeft(b(document).scrollLeft()-j.scrollSpeed):b(window).width()-(e.pageX-b(document).scrollLeft())<j.scrollSensitivity&&(g=b(document).scrollLeft(b(document).scrollLeft()+j.scrollSpeed))),g!==!1&&b.ui.ddmanager&&!j.dropBehaviour&&b.ui.ddmanager.prepareOffsets(this,e)}this.positionAbs=this._convertPositionTo("absolute");if(!this.options.axis||this.options.axis!="y"){this.helper[0].style.left=this.position.left+"px"}if(!this.options.axis||this.options.axis!="x"){this.helper[0].style.top=this.position.top+"px"}for(var d=this.items.length-1;d>=0;d--){var f=this.items[d],h=f.item[0],c=this._intersectsWithPointer(f);if(!c){continue}if(f.instance!==this.currentContainer){continue}if(h!=this.currentItem[0]&&this.placeholder[c==1?"next":"prev"]()[0]!=h&&!b.contains(this.placeholder[0],h)&&(this.options.type=="semi-dynamic"?!b.contains(this.element[0],h):!0)){this.direction=c==1?"down":"up";if(this.options.tolerance!="pointer"&&!this._intersectsWithSides(f)){break}this._rearrange(e,f),this._trigger("change",e,this._uiHash());break}}return this._contactContainers(e),b.ui.ddmanager&&b.ui.ddmanager.drag(this,e),this._trigger("sort",e,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(d,f){if(!d){return}b.ui.ddmanager&&!this.options.dropBehaviour&&b.ui.ddmanager.drop(this,d);if(this.options.revert){var e=this,c=this.placeholder.offset();this.reverting=!0,b(this.helper).animate({left:c.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]==document.body?0:this.offsetParent[0].scrollLeft),top:c.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]==document.body?0:this.offsetParent[0].scrollTop)},parseInt(this.options.revert,10)||500,function(){e._clear(d)})}else{this._clear(d,f)}return !1},cancel:function(){if(this.dragging){this._mouseUp({target:null}),this.options.helper=="original"?this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper"):this.currentItem.show();for(var c=this.containers.length-1;c>=0;c--){this.containers[c]._trigger("deactivate",null,this._uiHash(this)),this.containers[c].containerCache.over&&(this.containers[c]._trigger("out",null,this._uiHash(this)),this.containers[c].containerCache.over=0)}}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.options.helper!="original"&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),b.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?b(this.domPosition.prev).after(this.currentItem):b(this.domPosition.parent).prepend(this.currentItem)),this},serialize:function(c){var e=this._getItemsAsjQuery(c&&c.connected),d=[];return c=c||{},b(e).each(function(){var f=(b(c.item||this).attr(c.attribute||"id")||"").match(c.expression||/(.+)[-=_](.+)/);f&&d.push((c.key||f[1]+"[]")+"="+(c.key&&c.expression?f[1]:f[2]))}),!d.length&&c.key&&d.push(c.key+"="),d.join("&")},toArray:function(c){var e=this._getItemsAsjQuery(c&&c.connected),d=[];return c=c||{},e.each(function(){d.push(b(c.item||this).attr(c.attribute||"id")||"")}),d},_intersectsWith:function(p){var x=this.positionAbs.left,h=x+this.helperProportions.width,d=this.positionAbs.top,k=d+this.helperProportions.height,y=p.left,g=y+p.width,w=p.top,v=w+p.height,m=this.offset.click.top,j=this.offset.click.left,q=d+m>w&&d+m<v&&x+j>y&&x+j<g;return this.options.tolerance=="pointer"||this.options.forcePointerForContainers||this.options.tolerance!="pointer"&&this.helperProportions[this.floating?"width":"height"]>p[this.floating?"width":"height"]?q:y<x+this.helperProportions.width/2&&h-this.helperProportions.width/2<g&&w<d+this.helperProportions.height/2&&k-this.helperProportions.height/2<v},_intersectsWithPointer:function(d){var h=this.options.axis==="x"||b.ui.isOverAxis(this.positionAbs.top+this.offset.click.top,d.top,d.height),f=this.options.axis==="y"||b.ui.isOverAxis(this.positionAbs.left+this.offset.click.left,d.left,d.width),c=h&&f,e=this._getDragVerticalDirection(),g=this._getDragHorizontalDirection();return c?this.floating?g&&g=="right"||e=="down"?2:1:e&&(e=="down"?2:1):!1},_intersectsWithSides:function(d){var g=b.ui.isOverAxis(this.positionAbs.top+this.offset.click.top,d.top+d.height/2,d.height),f=b.ui.isOverAxis(this.positionAbs.left+this.offset.click.left,d.left+d.width/2,d.width),c=this._getDragVerticalDirection(),e=this._getDragHorizontalDirection();return this.floating&&e?e=="right"&&f||e=="left"&&!f:c&&(c=="down"&&g||c=="up"&&!g)},_getDragVerticalDirection:function(){var c=this.positionAbs.top-this.lastPositionAbs.top;return c!=0&&(c>0?"down":"up")},_getDragHorizontalDirection:function(){var c=this.positionAbs.left-this.lastPositionAbs.left;return c!=0&&(c>0?"right":"left")},refresh:function(c){return this._refreshItems(c),this.refreshPositions(),this},_connectWith:function(){var c=this.options;return c.connectWith.constructor==String?[c.connectWith]:c.connectWith},_getItemsAsjQuery:function(f){var k=[],h=[],e=this._connectWith();if(e&&f){for(var g=e.length-1;g>=0;g--){var j=b(e[g]);for(var d=j.length-1;d>=0;d--){var c=b.data(j[d],this.widgetName);c&&c!=this&&!c.options.disabled&&h.push([b.isFunction(c.options.items)?c.options.items.call(c.element):b(c.options.items,c.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),c])}}}h.push([b.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):b(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]);for(var g=h.length-1;g>=0;g--){h[g][0].each(function(){k.push(this)})}return b(k)},_removeCurrentsFromItems:function(){var c=this.currentItem.find(":data("+this.widgetName+"-item)");this.items=b.grep(this.items,function(d){for(var f=0;f<c.length;f++){if(c[f]==d.item[0]){return !1}}return !0})},_refreshItems:function(x){this.items=[],this.containers=[this];var g=this.items,d=[[b.isFunction(this.options.items)?this.options.items.call(this.element[0],x,{item:this.currentItem}):b(this.options.items,this.element),this]],k=this._connectWith();if(k&&this.ready){for(var y=k.length-1;y>=0;y--){var e=b(k[y]);for(var w=e.length-1;w>=0;w--){var v=b.data(e[w],this.widgetName);v&&v!=this&&!v.options.disabled&&(d.push([b.isFunction(v.options.items)?v.options.items.call(v.element[0],x,{item:this.currentItem}):b(v.options.items,v.element),v]),this.containers.push(v))}}}for(var y=d.length-1;y>=0;y--){var p=d[y][1],j=d[y][0];for(var w=0,q=j.length;w<q;w++){var m=b(j[w]);m.data(this.widgetName+"-item",p),g.push({item:m,instance:p,width:0,height:0,left:0,top:0})}}},refreshPositions:function(d){this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset());for(var g=this.items.length-1;g>=0;g--){var f=this.items[g];if(f.instance!=this.currentContainer&&this.currentContainer&&f.item[0]!=this.currentItem[0]){continue}var c=this.options.toleranceElement?b(this.options.toleranceElement,f.item):f.item;d||(f.width=c.outerWidth(),f.height=c.outerHeight());var e=c.offset();f.left=e.left,f.top=e.top}if(this.options.custom&&this.options.custom.refreshContainers){this.options.custom.refreshContainers.call(this)}else{for(var g=this.containers.length-1;g>=0;g--){var e=this.containers[g].element.offset();this.containers[g].containerCache.left=e.left,this.containers[g].containerCache.top=e.top,this.containers[g].containerCache.width=this.containers[g].element.outerWidth(),this.containers[g].containerCache.height=this.containers[g].element.outerHeight()}}return this},_createPlaceholder:function(c){c=c||this;var e=c.options;if(!e.placeholder||e.placeholder.constructor==String){var d=e.placeholder;e.placeholder={element:function(){var f=b(document.createElement(c.currentItem[0].nodeName)).addClass(d||c.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper")[0];return d||(f.style.visibility="hidden"),f},update:function(g,f){if(d&&!e.forcePlaceholderSize){return}f.height()||f.height(c.currentItem.innerHeight()-parseInt(c.currentItem.css("paddingTop")||0,10)-parseInt(c.currentItem.css("paddingBottom")||0,10)),f.width()||f.width(c.currentItem.innerWidth()-parseInt(c.currentItem.css("paddingLeft")||0,10)-parseInt(c.currentItem.css("paddingRight")||0,10))}}}c.placeholder=b(e.placeholder.element.call(c.element,c.currentItem)),c.currentItem.after(c.placeholder),e.placeholder.update(c,c.placeholder)},_contactContainers:function(x){var g=null,d=null;for(var k=this.containers.length-1;k>=0;k--){if(b.contains(this.currentItem[0],this.containers[k].element[0])){continue}if(this._intersectsWith(this.containers[k].containerCache)){if(g&&b.contains(this.containers[k].element[0],g.element[0])){continue}g=this.containers[k],d=k}else{this.containers[k].containerCache.over&&(this.containers[k]._trigger("out",x,this._uiHash(this)),this.containers[k].containerCache.over=0)}}if(!g){return}if(this.containers.length===1){this.containers[d]._trigger("over",x,this._uiHash(this)),this.containers[d].containerCache.over=1}else{var y=10000,e=null,w=this.containers[d].floating?"left":"top",v=this.containers[d].floating?"width":"height",p=this.positionAbs[w]+this.offset.click[w];for(var j=this.items.length-1;j>=0;j--){if(!b.contains(this.containers[d].element[0],this.items[j].item[0])){continue}if(this.items[j].item[0]==this.currentItem[0]){continue}var q=this.items[j].item.offset()[w],m=!1;Math.abs(q-p)>Math.abs(q+this.items[j][v]-p)&&(m=!0,q+=this.items[j][v]),Math.abs(q-p)<y&&(y=Math.abs(q-p),e=this.items[j],this.direction=m?"up":"down")}if(!e&&!this.options.dropOnEmpty){return}this.currentContainer=this.containers[d],e?this._rearrange(x,e,null,!0):this._rearrange(x,null,this.containers[d].element,!0),this._trigger("change",x,this._uiHash()),this.containers[d]._trigger("change",x,this._uiHash(this)),this.options.placeholder.update(this.currentContainer,this.placeholder),this.containers[d]._trigger("over",x,this._uiHash(this)),this.containers[d].containerCache.over=1}},_createHelper:function(c){var e=this.options,d=b.isFunction(e.helper)?b(e.helper.apply(this.element[0],[c,this.currentItem])):e.helper=="clone"?this.currentItem.clone():this.currentItem;return d.parents("body").length||b(e.appendTo!="parent"?e.appendTo:this.currentItem[0].parentNode)[0].appendChild(d[0]),d[0]==this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}),(d[0].style.width==""||e.forceHelperSize)&&d.width(this.currentItem.width()),(d[0].style.height==""||e.forceHelperSize)&&d.height(this.currentItem.height()),d},_adjustOffsetFromHelper:function(c){typeof c=="string"&&(c=c.split(" ")),b.isArray(c)&&(c={left:+c[0],top:+c[1]||0}),"left" in c&&(this.offset.click.left=c.left+this.margins.left),"right" in c&&(this.offset.click.left=this.helperProportions.width-c.right+this.margins.left),"top" in c&&(this.offset.click.top=c.top+this.margins.top),"bottom" in c&&(this.offset.click.top=this.helperProportions.height-c.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var c=this.offsetParent.offset();this.cssPosition=="absolute"&&this.scrollParent[0]!=document&&b.contains(this.scrollParent[0],this.offsetParent[0])&&(c.left+=this.scrollParent.scrollLeft(),c.top+=this.scrollParent.scrollTop());if(this.offsetParent[0]==document.body||this.offsetParent[0].tagName&&this.offsetParent[0].tagName.toLowerCase()=="html"&&b.ui.ie){c={top:0,left:0}}return{top:c.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:c.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if(this.cssPosition=="relative"){var c=this.currentItem.position();return{top:c.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:c.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var d=this.options;d.containment=="parent"&&(d.containment=this.helper[0].parentNode);if(d.containment=="document"||d.containment=="window"){this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,b(d.containment=="document"?document:window).width()-this.helperProportions.width-this.margins.left,(b(d.containment=="document"?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]}if(!/^(document|window|parent)$/.test(d.containment)){var f=b(d.containment)[0],e=b(d.containment).offset(),c=b(f).css("overflow")!="hidden";this.containment=[e.left+(parseInt(b(f).css("borderLeftWidth"),10)||0)+(parseInt(b(f).css("paddingLeft"),10)||0)-this.margins.left,e.top+(parseInt(b(f).css("borderTopWidth"),10)||0)+(parseInt(b(f).css("paddingTop"),10)||0)-this.margins.top,e.left+(c?Math.max(f.scrollWidth,f.offsetWidth):f.offsetWidth)-(parseInt(b(f).css("borderLeftWidth"),10)||0)-(parseInt(b(f).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,e.top+(c?Math.max(f.scrollHeight,f.offsetHeight):f.offsetHeight)-(parseInt(b(f).css("borderTopWidth"),10)||0)-(parseInt(b(f).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top]}},_convertPositionTo:function(d,h){h||(h=this.position);var f=d=="absolute"?1:-1,c=this.options,e=this.cssPosition!="absolute"||this.scrollParent[0]!=document&&!!b.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,g=/(html|body)/i.test(e[0].tagName);return{top:h.top+this.offset.relative.top*f+this.offset.parent.top*f-(this.cssPosition=="fixed"?-this.scrollParent.scrollTop():g?0:e.scrollTop())*f,left:h.left+this.offset.relative.left*f+this.offset.parent.left*f-(this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():g?0:e.scrollLeft())*f}},_generatePosition:function(f){var k=this.options,h=this.cssPosition!="absolute"||this.scrollParent[0]!=document&&!!b.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,e=/(html|body)/i.test(h[0].tagName);this.cssPosition=="relative"&&(this.scrollParent[0]==document||this.scrollParent[0]==this.offsetParent[0])&&(this.offset.relative=this._getRelativeOffset());var g=f.pageX,j=f.pageY;if(this.originalPosition){this.containment&&(f.pageX-this.offset.click.left<this.containment[0]&&(g=this.containment[0]+this.offset.click.left),f.pageY-this.offset.click.top<this.containment[1]&&(j=this.containment[1]+this.offset.click.top),f.pageX-this.offset.click.left>this.containment[2]&&(g=this.containment[2]+this.offset.click.left),f.pageY-this.offset.click.top>this.containment[3]&&(j=this.containment[3]+this.offset.click.top));if(k.grid){var d=this.originalPageY+Math.round((j-this.originalPageY)/k.grid[1])*k.grid[1];j=this.containment?d-this.offset.click.top<this.containment[1]||d-this.offset.click.top>this.containment[3]?d-this.offset.click.top<this.containment[1]?d+k.grid[1]:d-k.grid[1]:d:d;var c=this.originalPageX+Math.round((g-this.originalPageX)/k.grid[0])*k.grid[0];g=this.containment?c-this.offset.click.left<this.containment[0]||c-this.offset.click.left>this.containment[2]?c-this.offset.click.left<this.containment[0]?c+k.grid[0]:c-k.grid[0]:c:c}}return{top:j-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+(this.cssPosition=="fixed"?-this.scrollParent.scrollTop():e?0:h.scrollTop()),left:g-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():e?0:h.scrollLeft())}},_rearrange:function(g,d,h,f){h?h[0].appendChild(this.placeholder[0]):d.item[0].parentNode.insertBefore(this.placeholder[0],this.direction=="down"?d.item[0]:d.item[0].nextSibling),this.counter=this.counter?++this.counter:1;var c=this.counter;this._delay(function(){c==this.counter&&this.refreshPositions(!f)})},_clear:function(d,f){this.reverting=!1;var e=[];!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem),this._noFinalSort=null;if(this.helper[0]==this.currentItem[0]){for(var c in this._storedCSS){if(this._storedCSS[c]=="auto"||this._storedCSS[c]=="static"){this._storedCSS[c]=""}}this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else{this.currentItem.show()}this.fromOutside&&!f&&e.push(function(g){this._trigger("receive",g,this._uiHash(this.fromOutside))}),(this.fromOutside||this.domPosition.prev!=this.currentItem.prev().not(".ui-sortable-helper")[0]||this.domPosition.parent!=this.currentItem.parent()[0])&&!f&&e.push(function(g){this._trigger("update",g,this._uiHash())}),this!==this.currentContainer&&(f||(e.push(function(g){this._trigger("remove",g,this._uiHash())}),e.push(function(g){return function(h){g._trigger("receive",h,this._uiHash(this))}}.call(this,this.currentContainer)),e.push(function(g){return function(h){g._trigger("update",h,this._uiHash(this))}}.call(this,this.currentContainer))));for(var c=this.containers.length-1;c>=0;c--){f||e.push(function(g){return function(h){g._trigger("deactivate",h,this._uiHash(this))}}.call(this,this.containers[c])),this.containers[c].containerCache.over&&(e.push(function(g){return function(h){g._trigger("out",h,this._uiHash(this))}}.call(this,this.containers[c])),this.containers[c].containerCache.over=0)}this._storedCursor&&b("body").css("cursor",this._storedCursor),this._storedOpacity&&this.helper.css("opacity",this._storedOpacity),this._storedZIndex&&this.helper.css("zIndex",this._storedZIndex=="auto"?"":this._storedZIndex),this.dragging=!1;if(this.cancelHelperRemoval){if(!f){this._trigger("beforeStop",d,this._uiHash());for(var c=0;c<e.length;c++){e[c].call(this,d)}this._trigger("stop",d,this._uiHash())}return this.fromOutside=!1,!1}f||this._trigger("beforeStop",d,this._uiHash()),this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.helper[0]!=this.currentItem[0]&&this.helper.remove(),this.helper=null;if(!f){for(var c=0;c<e.length;c++){e[c].call(this,d)}this._trigger("stop",d,this._uiHash())}return this.fromOutside=!1,!0},_trigger:function(){b.Widget.prototype._trigger.apply(this,arguments)===!1&&this.cancel()},_uiHash:function(c){var d=c||this;return{helper:d.helper,placeholder:d.placeholder||b([]),position:d.position,originalPosition:d.originalPosition,offset:d.positionAbs,item:d.currentItem,sender:c?c.element:null}}})})(jQuery);jQuery.expr[":"].icontains=jQuery.expr.createPseudo(function(a){return function(b){return jQuery(b).text().toUpperCase().indexOf(a.toUpperCase())>=0}});function load_css(b,e){var d=new Date().getTime();var c=document.getElementsByTagName("head")[0];var a=document.createElement("link");a.type="text/css";a.rel="stylesheet";a.href=b;a.media="screen";a.id=d;a.onreadystatechange=function(){if(typeof e=="function"){e()}};a.onload=function(){if(typeof e=="function"){e()}};c.appendChild(a);return d}function popupBrowser(b){window.open(b);return;var a="data:text/html,";a+="<div style='width: 100%; height: 100%; overflow-y: hidden'> 			   		<input id='url' style='width: 100%;' type='text' value='"+b+"' disabled=true> 			   		<div style='padding-bottom: 15px'> <iframe id='page' border=0 style='border: none; width: 100%; height: 100%' src='"+b+"'></iframe> </div> 			   </div>";window.open(a)}var months=new Array("Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sept","Oct","Nov","Dec");function formatDate(g){g=(Date.now()/1000)-g;var b,f,e,d;b=g/60;if(b>30240){var g=new Date(new Date().getTime()-(b*60000));var a="th";var c=g.getDate();if(c==1||c==21||c==31){a="st"}else{if(c==2||c==22){a="nd"}else{if(c==3||c==23){a="rd"}}}e=(months[g.getMonth()]+" "+c+a+" "+g.getFullYear())}else{if(b>=10080){f=Math.floor(b/10080);e=f+"w ago";d="updateWeeks"}else{if(b>=1440){f=Math.floor(b/1440);e=f+"d ago";d="updateDays"}else{if(b>=60){f=Math.floor(b/60);e=f+"h ago";d="updateHours"}else{if(b>=1){f=Math.floor(b);e=f+"m ago";d="updateTime updateMinutes"}else{f=Math.floor(b*60);e=f+"s ago";d="updateTime updateSeconds"}}}}}return[e,d]}function updateDate(a,c,b){var d=$(a[c]);var e=d.attr("data-timestamp");d.html(formatDate(e)[0]);c++;if(c>=b){a=$(".updateTime");b=a.length;c=0}setTimeout(function(){updateDate(a,c,b)},1000)}(function(a){a.fn.toggleSwitch=function(){this.hide();this.each(function(){var j=a(this);var b='<span class="buttongroup toggleSwitch">';var g=j.val();var f=false;var h="";var c="";var e=j.find("option").size();var d=0;j.find("option").each(function(){var i=a(this);if(f==false&&g==i.val()){f=true;h=" btn_selected"}else{h=""}d++;if(e==d){c="last"}else{if(d==1){c="first"}else{c="middle"}}b=b+'<button class="toggleButton '+c+h+'" value="'+i.val()+'" data-message="'+i.attr("data-message")+'">'+i.html()+"</button>"});b=b+"</span>";j.wrap("<span>").after(b)});this.parent().find(".toggleSwitch .toggleButton").click(function(c){var b=a(this);c.preventDefault();b.parent().find(".toggleButton").removeClass("btn_selected");b.addClass("btn_selected");b.parent().parent().find("select").val(b.attr("value")).change()});return this}})(jQuery);(function(c){var b=0;var a=new Array();c.fn.doneTyping=function(f,d){if(typeof(d)=="undefined"){d=800}b++;this.keydown(function(){clearTimeout(a[b])});var e=this;this.keydown(function(){a[b]=setTimeout(function(){f.call(e)},d)});return this}})(jQuery);function nl2br(c,b){var a=(b||typeof b==="undefined")?"<br />":"<br>";return(c+"").replace(/([^>\r\n]?)(\r\n|\n\r|\r|\n)/g,"$1"+a+"$2")}function capitalize(b){if(typeof b=="object"){var a=b.length;var d=[];for(var c=0;c<a;c++){d.push(capitalize(b[c]))}return d}return b.charAt(0).toUpperCase()+b.slice(1)}function clipboard_set(b){var a=document.createElement("div");a.setAttribute("style","position: absolute; top: -1000px; left: -1000px; width: 1px; height: 1px;");a.contentEditable=true;document.body.appendChild(a);a.innerHTML=b;a.unselectable="off";a.focus();document.execCommand("SelectAll");document.execCommand("Copy",false,null);document.body.removeChild(a)}function strip_tags(b){var a=document.createElement("DIV");a.innerHTML=b.replace(/<br(.*?)>/gi,"LINEBREAK");return(a.textContent||a.innerText).replace(/LINEBREAK/gi,"<br>").replace(/<br(.*?)>[\s\S]<br(.*?)>[\s\S]<br(.*?)>/gi,"<br><br>")}(function(c){var b=new Array();var a=0;c.fn.autoHeight=function(){return this.each(function(){var e=c(this);e.attr("defaultheight",e.height()).attr("defaultwidth",e.width()).css("overflow-y","hidden");var d=c('<div style="word-wrap: break-word; position: absolute; left: -9999px;"></div>').css({"font-size":e.css("font-size"),"font-family":e.css("font-family"),width:e.width()}).appendTo("body");var f=function(){d.html(e.val().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\n$/,"<br/>&nbsp;").replace(/\n/g,"<br />"));var h=d.height();if(h>e.attr("defaultheight")){e.css("height",h)}else{e.css("height",e.attr("defaultheight"))}if(h>e.css("max-height").slice(0,-2)){e.css("overflow-y","scroll")}else{e.css("overflow-y","hidden")}};e.keyup(f).keydown(f).change(f);f();var g=++a;b[g]=setInterval(function(){if(e.width()!=e.attr("defaultwidth")){e.attr("defaultwidth",e.width());d.css("width",e.width());f();if(e.width()==0){d.remove();clearInterval(b[g])}}},300)});return this}})(jQuery);(function(a){a.fn.keyCombo=function(h,g){var e=a(this);var b=h.toString();if(h==false){e.off(".keycomboall");return this}if(g==false){e.off(".keycombo"+b);return this}if(typeof h=="string"){h=h.split(",")}var d=h.length;var c=d-1;var f=0;var j={};a(window).focus(function(){j={};f=0});var i=(navigator.appVersion.indexOf("Mac")==-1)?17:91;e.on("keydown.keycomboall.keycombo"+b,function(n){var k=n.keyCode;var l=(f==c&&(j[18]||(j[i]&&k!=90&&k!=67&&k!=86&&k!=65&&k!=88&&k!=89)))?true:false;if(l){n.preventDefault();n.stopPropagation()}var m=n.keyCode.toString();if(jQuery.inArray(m,h)!=-1&&j[m]!=true){j[m]=true;if(++f==d){f=0;j={};g.call(this,n)}}if(l){return false}});e.on("keyup.keycomboall.keycombo"+b,function(l){var k=l.keyCode.toString();if(jQuery.inArray(k,h)!=-1&&j[k]==true){j[k]=false;f--;if(f<0){f=0}}});return this}})(jQuery);jQuery.fn.outerHTML=function(a){return(a)?this.before(a).remove():jQuery("<p>").append(this.eq(0).clone()).html()};window.decode_html_entities_node=document.createElement("DIV");function decode_html_entities(a){window.decode_html_entities_node.innerHTML=a;return window.decode_html_entities_node.textContent}function setBadge(a){window.document.title=((a!=""&&a!=0)?"("+a+") ":"")+window.document.title.replace(/\((.*?)\) /,"")}function imgurUpload(b,a){uploadHandler.createUploadBuffer(b,a)}function waitForSelector(a,d,c){var c=(typeof c=="undefined")?60:c;var b=$(a);if(b.length){d(b)}else{if(--c>0){setTimeout(function(){waitForSelector(a,d,c)},250)}}}var updateNavCurrentUsertype="guest";var updateNavCurrentPage="None";function updateNav(b,a){if(b=="person"){updateNavCurrentUsertype=a}else{if(b=="page"){updateNavCurrentPage=a}}var c=$("#Header #Nav div, #leftNav");c.find(".link, .node").not(".node.title").hide();c.find("."+updateNavCurrentUsertype).show();c.find("."+updateNavCurrentPage).show();c.find("."+updateNavCurrentUsertype+"_and_"+updateNavCurrentPage).show();c.find(".not_"+updateNavCurrentPage).hide()}function bindNavigation(b){var f=$("#Header #Nav");var c=$("#leftNav");c.on("click.nav",".node.title",function(){var h=$(this);var g=h.parent();if(g.hasClass("open")){g.removeClass("open");b.userVariable("sidebarClosed",function(i){if(typeof i!="object"){i={isClosed:false,sections:{}}}i.sections[g.attr("id")]=false;b.userVariable("sidebarClosed",i)})}else{g.addClass("open");b.userVariable("sidebarClosed",function(i){if(typeof i!="object"){i={isClosed:false,sections:{}}}i.sections[g.attr("id")]=true;b.userVariable("sidebarClosed",i)})}});c.on("click.nav","#newMessage",function(){notifications(self.connection,window.tabManagerObj,{action:"compose",username:""})});f.on("click.nav","#previousHistory",function(){window.history.back()});f.on("click.nav","#forwardHistory",function(){window.history.forward()});f.on("click.nav","#refreshColumns",function(){if(window.location.hash.indexOf("/post/")==-1){for(var g in window.tabManagerObj.columns){window.tabManagerObj.columns[g].sourceObject.refresh()}}else{}});f.on("click.nav","#logoutNav",function(){logoutPopup(b)});f.on("click.nav","#homeNav",function(){window.location="#/Home"});c.on("click.nav","#newPost",function(){createPost(this,b,window.tabManagerObj)});f.on("click.nav","#invokeHistory",function(){historyDropdown(b)});c.on("click.nav","#addColumn",function(){addColumn(b,window.tabManagerObj)});c.on("click.nav","#quickView",function(){promptFancy("Enter the name of a subreddit (i.e. pets)",function(g){if(g==""||g==false||g==null){return}g=g.replace("/r/","");if(g.substr(0,2)=="r/"){g=g.substr(2)}new quickView(b,g,"/r/"+g.toLowerCase()+"/")},"subreddit")});f.on("click.nav","#accounts",function(){accountsPopup(this,b,window.tabManagerObj)});var d=false;function a(){$("#searchNav").removeClass("active");$("body").off(".searchInputActive")}function e(){$("body").off(".searchInputActive")}f.on("keyup.nav","#searchNav input",function(g){clearTimeout(window.quickSearchTimeout);if(g.keyCode==13){quickSearch($("#searchNav input").val(),true,b,window.tabManagerObj,a,e,d);return}window.quickSearchTimeout=setTimeout(function(){quickSearch($("#searchNav input").val(),false,b,window.tabManagerObj,a,e,d)},500)});f.on("click.nav","#searchNav input",function(h){setTimeout(function(){var i=true;$("body").off(".searchInputActive").on("click.searchInputActive",function(){if(i){a()}});$("#searchNav input").off(".searchInputActive").on("click.searchInputActive",function(j){i=false;setTimeout(function(){i=true},500)})},500);$("#searchNav").addClass("active");var g=$(this).val();quickSearch(g,false,b,window.tabManagerObj,a,e,d)});f.on("click.nav","#searchType .active",function(i){i.stopPropagation();var g=$(this);if(g.html()=="Posts"){var h="Subreddits"}else{var h="Posts"}g.html(h);d=h;quickSearch($("#searchNav input").val(),true,b,window.tabManagerObj,a,e,h);$("#searchNav input").focus().select()});f.on("click.nav",".banner",function(){var g=$("body");if(g.hasClass("leftPaneOpen")){b.userVariable("sidebarClosed",function(h){if(typeof h!="object"){h={sections:{}}}h.isClosed=true;b.userVariable("sidebarClosed",h)});setTimeout(function(){window.tabManagerObj.resize()},250);g.removeClass("leftPaneOpen");f.find(".leftNavArrow").removeClass("icon-chevron-left").addClass("icon-chevron-right")}else{b.userVariable("sidebarClosed",function(h){if(typeof h!="object"){h={sections:{}}}h.isClosed=false;b.userVariable("sidebarClosed",h)});setTimeout(function(){window.tabManagerObj.resize()},250);f.find(".leftNavArrow").removeClass("icon-chevron-right").addClass("icon-chevron-left");g.addClass("leftPaneOpen")}});f.on("click.nav","#notificationCounter",function(){notifications(b,window.tabManagerObj)});f.on("click.nav","#settingsNav",function(){var g=new settingsPopup(b,window.tabManagerObj)});c.on("click.nav","#viewFriends",function(){var g=new friendsList(b,window.tabManagerObj)});f.on("click.nav","#favouritesButton",function(){var g="/user/"+b.user.name+"/saved.json";new quickView(b,"Favourites",g,{SPECIAL:true,TEMP:true,SORT:false},{SORT:false,SPECIAL:true})});c.on("click.nav","#viewGallery",function(){var g=(window.location.hash.match(/~r~(.*?)~/)!=null?window.location.hash.match(/~r~(.*?)~/).pop():"/r/pics");promptFancy("Please choose which subreddit you want",function(h){if(!h){return}h=h.replace("/r/","");if(h.substr(0,2)=="r/"){h=h.substr(2)}var i=$('<div style="position: absolute; top: -1000px; opacity: 0;">').appendTo("body");var j=new column("/r/"+h+"/",i,i,b,tabManagerObj,{SORT:"hot",SPECIAL:true},h).startup();setTimeout(function(){new gallery(j,"default",function(){j.shutdown();delete j})},150)},"subreddit",g)});c.on("click.nav","#viewUser",function(){promptFancy("Enter a Username",function(g){if(!g){return false}var h=new userInfo(g,b,tabManagerObj,"")},"text",userInfo.prototype.lastUserInfoViewed?userInfo.prototype.lastUserInfoViewed:(b.user.name?b.user.name:""))});c.on("click.nav","#settingsNav .node:not(.title,#settingsProfile)",function(){var g=new settingsPopup(b,window.tabManagerObj,$(this).attr("data-section"))});c.on("click.nav","#settingsProfile.node",function(){var g=new userInfo(self.connection.user.username,self.connection,window.tabManagerObj)})}function createPost(e,a,j,n){var o=parseUrlData(window.location.hash);var c=o[0];var l=o[1];var i="<div class='left'><select id='PostType'><option value='link'>Link</option><option value='self'>Text</option></select></div><div class='text'>Drag images here to upload them to Imgur</div> 				   <button data-message='post' class='green right space'><i class=\"icon-ok\"></i><span>&nbsp;&nbsp;Post</span></button> 				   <button data-message='close' class='right space'><i class=\"icon-remove\"></i><span>&nbsp;&nbsp;Cancel</span></button>";var g="<div class='incontainer'><input class='first' placeholder='Title' type='text' id='Title' /></div> 				   <div id='LinkContainer'><div class='incontainer'><input placeholder='Link' type='text' id='Link' /></div></div> 				   <div style='display: none;' id='TextContainer'><div class='incontainer'><textarea placeholder='Write your message here' id='Text' /></div></div> 				   <div class='incontainer'><input class='nomargins' placeholder='Subreddit' type='text' value='"+(window.location.hash.match(/~r~(.*?)~/)!=null?window.location.hash.match(/~r~(.*?)~/).pop():"")+"' id='Subreddit' /></div> 				   <div id='addSubreddit_results'></div>";var h="link";var d=false;var m=false;var f,k;f=$.popup({id:"newPostPopup",message:g,buttons:i},function(q,p){a.setting("signature",function(s){if(q=="subreddit_item"){k.val(p.html()).focus().select()}else{if(q=="post"){var B=f.find("#Title");var A=f.find("#Link");var C=f.find("#Text");var t=f.find("#Subreddit");var w=f.find("#captchaEnter");if(d){return}d=true;p.addClass("loading");var v=B.val();var x=(h=="link")?A.val():C.val()+"\n\n"+s;var y=t.val();function r(){p.removeClass("loading");d=false}if(v==""){alert("Please specify a title!");r();B.focus().select();return}else{if(x==""){alert("Please specify a link or text!");r();if(h=="link"){A.focus().select()}else{C.focus().select()}return}else{if(y==""){alert("Please specify a subreddit!");r();t.focus().select();return}}}var u=(m?w.attr("iden"):null);var z=(m?w.val():null);a.submit(v,x,y,h,u,z,function(F,L){if(F=="BAD_CAPTCHA"){p.removeClass("loading");d=false;if(!m){m=true;var G='<img id="captchaCode" src="http://reddit.com/captcha/'+L+'.png" />';var I='<div class="incontainer">								<input placeholder="Enter the captcha code above" type="text" iden="'+L+'" id="captchaEnter"> 							</div>';f.find("#addSubreddit_results").before(G+I)}else{alert("You entered the captcha incorrectly, try again.");f.find("#captchaCode").attr("src","http://reddit.com/captcha/"+L+".png")}}else{if(F=="noerror"){f.closePopup();var J=L.split(".com").pop();var D=L.match(/comments\/(.*?)\//).pop();var K=L.match(/\.com(.*?)comments\//).pop().replace(/\//g,"-");var E=L.match(/\.com(.*?)comments\//).pop().replace(/\//g,"~");var H=capitalize(L.match(/r\/(.*?)\//).pop());window.location.href="#/Home/post/"+D+"/permalink/"+J.replace(/\//g,"~")+"/column/"+K+"/title/"+H+"/url/"+E}else{alert(L);p.removeClass("loading");d=false}}})}}});return q});f.find("#PostType").toggleSwitch();$("#PostType").change(function(){h=$(this).val();if(h=="link"){f.find("#LinkContainer").show();f.find("#TextContainer").hide()}else{f.find("#LinkContainer").hide();f.find("#TextContainer").show()}});var b=f.find("#addSubreddit_results");k=f.find("#Subreddit");k.doneTyping(function(){var p=k.val().toLowerCase();k.addClass("loading");a.searchRedditNames(p,function(t){b.find("div:not(.selected)").remove();if(t.length!=0){b.append('<div data-message="subreddit_item">'+t.join('</div><div data-message="subreddit_item">')+"</div>")}var r=false;var q=t.length;for(var s=0;s<q;s++){if(p==t[s].toLowerCase()){r=true}}k.removeClass("loading");if(!r){a.subredditExists(p,function(u){if(u){b.append('<div data-message="subreddit_item">'+capitalize(p)+"</div>")}})}})});f.find("textarea").autoHeight().css("max-height",parseInt($("body").height()-300)+"px").reditor();if(typeof n=="function"){n(f)}return f}function addColumn(a,i){var e=a.loggedin;var b='<div id="stageOne" class="stage columnTypes"> 		 				   <div data-message="subreddit" id="subreddit" class="item">Subreddit</div> 						   <div data-message="subscribed" id="subscribed" class="item">Front Page</div> 						   <div data-message="everything" id="everything" class="item">All</div> 						   <div data-message="search" id="search" class="item">Search</div> 						   <div data-message="user" id="user" class="item">User</div> 						   <div data-message="random" id="random" class="item">Random</div> 						   <div data-message="domain" id="domain" class="item">Domain</div>'+((e)?'<div data-message="saved" id="saved" class="item">Favourites</div> 						   <div data-message="moderated" id="moderated" class="item">Moderated</div> 						   <div data-message="friends" id="friends" class="item">Friends</div> 						   <div data-message="allcomments" id="friends" class="item">All Comments</div>':"")+'<div style="clear: both"></div> 					 </div>';var c='<div id="addSubreddit" class="stage" style="display: none"></div>';var g='<div id="addDomain" class="stage" style="display: none"> 						 <div class="incontainer"> 							<input data-message="addDomain_button" class="nomargins" id="addDomain_domain" placeholder="Enter a domain here"> 						 </div> 					</div>';var d='<div id="addUser" class="stage" style="display: none"> 						<div class="incontainer"> 							<input data-message="addUser_button" class="nomargins" id="addUser_username"placeholder="Specify a Username Here"> <br> 						</div> 				  </div>';var h='<button data-message="back" class="left backButton space" style="display: none"><i class="icon-arrow-left"></i><span>&nbsp;&nbsp;Back</span></button> 				   <button data-message="subreddit_createColumn" class="green subreddit_createColumn stage right space" style="display: none"><i class="icon-ok"></i><span>&nbsp;&nbsp;Create Column</span></button> 				   <button data-message="addUser_button" class="green addUser_button stage right space" style="display: none"><i class="icon-ok"></i><span>&nbsp;&nbsp;Create Column</span></button> 				   <button data-message="addDomain_button" class="green addDomain_button stage right space" style="display: none"><i class="icon-ok"></i><span>&nbsp;&nbsp;Create Column</span></button> 				   <button data-message="close" class="right space"><i class="icon-remove"></i><span>&nbsp;&nbsp;Cancel</span></button> 				   <div style="clear: both"></div>';var j=0;var f=null;addColumnDiag=null;f=$.popup({id:"columnPopup",message:b+c+d+g,buttons:h},function(s,o){var r=$(this);if(s=="back"){$(o).hide();r.find(".stage").hide();r.find("#stageOne").show()}else{if(s=="domain"){r.find("#stageOne").hide();r.find("#addDomain, .backButton, .addDomain_button").show();var q=r.find("#addDomain_domain").focus()}else{if(s=="addDomain_button"){var l=r.find("#addDomain_domain").val().replace(/www\./g,"").replace(/http:\/\//g,"");if(l.slice(-1)=="/"){l=l.slice(0,-1)}var p=l.slice(0,1).toUpperCase()+l.slice(1).toLowerCase();var n=i.insert(function(t){return new column("/domain/"+l+"/.json",t,activePlayground,a,this,{SPECIAL:true,DOM:true},p)},"SYNC");i.changePage(n);f.closePopup()}else{if(s=="friends"){var n=i.insert(function(t){return new column("/r/friends/",t,activePlayground,a,this,{SORT:"hot",FRI:true,SPECIAL:true},"Friends")},"SYNC");i.changePage(n);f.closePopup()}else{if(s=="allcomments"){var n=i.insert(function(t){return new column("/comments/.json",t,activePlayground,a,this,{SORT:"new",CMT:true},"All Comments",1000)},"SYNC");i.changePage(n);f.closePopup()}else{if(s=="moderated"){var n=i.insert(function(t){return new column("/r/mod/",t,activePlayground,a,this,{SORT:"hot",SPECIAL:true,MOD:true},"Moderator")},"SYNC");i.changePage(n);f.closePopup()}else{if(s=="subscribed"){var n=i.insert(function(t){return new column("/",t,activePlayground,a,this,{SORT:"new",SPECIAL:true,SUB:true},"Front Page")},"SYNC");i.changePage(n);f.closePopup()}else{if(s=="everything"){var n=i.insert(function(t){return new column("/r/all/",t,activePlayground,a,this,{SORT:"hot",SPECIAL:true,EVE:true},"All")},"SYNC");i.changePage(n);f.closePopup()}else{if(s=="random"){o.removeAttr("data-message").html("Loading");a.randomSubreddit(function(t){o.attr("data-message","random").html("Random");var u=t.slice(0,1).toUpperCase()+t.slice(1).toLowerCase();new quickView(a,u,"/r/"+t+"/")})}else{if(s=="saved"){var n=i.insert(function(t){return new column("/user/"+a.user.name+"/saved.json",t,activePlayground,a,this,{SORT:false,SPECIAL:true},"Favourites")},"SYNC");i.changePage(n);f.closePopup()}else{if(s=="addUser_button"){var m=r.find("#addUser_username").val();var p=m.slice(0,1).toUpperCase()+m.slice(1).toLowerCase()+"'s Posts";var n=i.insert(function(t){return new column("/user/"+m+"/.json",t,activePlayground,a,this,{SPECIAL:true,SORT:"new",USER:true},p)},"SYNC");i.changePage(n);f.closePopup()}else{if(s=="user"){r.find("#stageOne").hide();r.find("#addUser, .backButton, .addUser_button").show();var q=r.find("#addUser_username").focus()}else{if(s=="search"){searchPopup(a,i)}else{if(s=="subreddit"){var k=r.find("#addSubreddit");r.find("#stageOne").hide();k.show();r.find(".backButton").show();addColumnDiag=new subredditSelector(a,k,function(t){if(t.length>0){r.find(".subreddit_createColumn").show()}else{r.find(".subreddit_createColumn").hide()}})}else{if(s=="subreddit_createColumn"){addColumnDiag.subreddits(function(u){var t="/r/"+u.join("+")+"/";var v=capitalize(u).join(", ");var w=i.insert(function(x){return new column(t,x,activePlayground,a,this,{SORT:"hot"},v)},"SYNC");i.changePage(w);f.closePopup()})}}}}}}}}}}}}}}}return s})}function imageZoom(d,v,u,b,c,e){var r=$(".complexAlertBackdrop");if(!r.length){var r=$('<div class="complexAlertBackdrop" style="z-index: '+(window.shameful_popup_zindex++)+' !important"></div>').appendTo("body");setTimeout(function(){r.addClass("animate")},10)}var a=$(".complexAlertContainer");if(a.length){a.hide()}var g=$('<div class="complexAlertContainer" style="z-index: '+(window.shameful_popup_zindex++)+' !important; width: 100%; height: 100%; margin: 0px; padding: 0px; border: none; z-index: 1001; position: absolute; top: 0px; bottom: 0px; left: 0px; right: 0px; overflow: scroll"></div>').appendTo("body");function q(){g.remove();if(!$(".complexAlertContainer").length){r.remove()}if(!$(".complexAlertContainer:visible").length){$(".complexAlertContainer").last().show()}}g.add(r).click(q);if(typeof u=="undefined"||isNaN(u)){u=-1}var m=(typeof b=="undefined")?0:b.length;var o=(u==-1||m-u==1)?"":'<div style="z-index: '+(window.shameful_popup_zindex)+' !important" class="imageZoomCaptionForwardButton"></div>';var n=(u==-1||u==0)?"":'<div style="z-index: '+(window.shameful_popup_zindex)+' !important" class="imageZoomCaptionBackwardButton"></div>';var v=(typeof v=="undefined"||v=="")?"":'<div class="imageZoomCaption" style="z-index: '+(window.shameful_popup_zindex++)+' !important"><span>'+v+"</span></div>";$('<table style="width: 100%; height: 100%; margin: 0px; padding: 0px; border: none; z-index: 1001; position: fixed; top: 0px; bottom: 0px; left: 0px; right: 0px"><tr valign="middle"><td style="text-align: center" valign="middle"><div id="imageContainer"><div class="loadingcss"></div></div></td></tr></table>'+o+n+v).appendTo(g);var f=true;var w=g.find("table").draggable({start:function(){f=false},stop:function(){setTimeout(function(){f=true},250)}});var p=w.find("td");var y=new Image();var l=0;var x=0;y.onload=function(){if(u>1){$("<img/>")[0].src=b[u-1]}if(u+1<m){$("<img/>")[0].src=b[u+1]}p.find("#imageContainer").html(y);var D=$(window);var A=D.width()-150;var i=D.height()-300;var C=$(y);l=C.width();F=C.height();if(l>A){var F=(A/l)*F;l=A;C.attr("width",l).attr("height",F)}if(F>i){l=(i/F)*l;F=i;C.attr("height",F).attr("width",l)}var G=$('<div id="controls" class="buttongroup" style="position: fixed; top: 5px; left: 5px; z-index: '+(window.shameful_popup_zindex)+' !important"> 							  <button id="copyLink"><i class="icon-link"></i></button><button id="zoomOut"><i class="icon-zoom-out"></i></button><button id="zoomIn"><i class="icon-zoom-in"></i></button> 						  </div>').appendTo(g);var z=$('<div style="z-index: '+(window.shameful_popup_zindex)+' !important" data-message="close" id="closeGallery"></div>').appendTo(g);function B(H){H.stopPropagation();H.preventDefault();if(!f){return false}l*=1.2;F*=1.2;C.attr("width",l).attr("height",F);return false}G.on("click","#zoomIn",B);p.on("click","img",B);function E(H){H.stopPropagation();H.preventDefault();if(!f){return false}l*=0.8;F*=0.8;C.attr("width",l).attr("height",F);return false}G.on("click","#zoomOut",E);p.on("contextmenu","img",E);G.on("click","#copyLink",function(H){H.stopPropagation();clipboard_set(b[u])});w.on("mousewheel",function(K){K.preventDefault();K.stopPropagation();var H=K.originalEvent.wheelDeltaY;var I=l+(H/600)*l;var J=F+(H/600)*F;if(H<0&&(J<50||I<50)){return false}C.attr("width",l=I).attr("height",F=J);return false});g.on("click",".imageZoomCaptionForwardButton",function(I){I.stopPropagation();var H=u+1;imageZoom(b[H],c[H],H,b,c,e);q()});g.on("click",".imageZoomCaptionBackwardButton",function(I){I.stopPropagation();var H=u-1;imageZoom(b[H],c[H],H,b,c,e);q()})};y.src=d;if(typeof e!="undefined"){if(typeof e=="object"){var s=['<div id="bareSourceImages" class="imageZoomPreviewContainer"><div>'];for(var t=0;t<m;t++){s.push('<div class="img"> 								<img data-key="'+t+'" src="'+e[t]+'"> 								<div class="imgtitle"><span>'+c[t]+"</span></div> 							 </div>")}s.push("</div></div>");e=s.join("")}var h=$(e).css("z-index",window.shameful_popup_zindex++);g.append(h);h.on("click","img",function(z){z.stopPropagation();var i=parseInt($(this).attr("data-key"));imageZoom(b[i],c[i],i,b,c,e);q()});var k=h.find('[data-key="'+u+'"]').parent();k.addClass("active");var j=k.offset().left;g.scrollLeft(j-(g.width()-k.width())/2)}}function replyBar(b,f,g,e,h,c,d){this.connection=b;this.content=f;this.placeholder=g;this.id=e;this.callback=h;this.isReplying=false;this.textPreview=d;this.converter=SnuOwnd.getParser();var a=this;if(c){$(".bottomInterface").remove();this.draw()}else{if($(".bottomInterface").length!=0){confirmFancy("Are you sure you want to cancel "+$(".bottomInterface").find("textarea").attr("placeholder")+"?",function(i){if(i){$(".bottomInterface").remove();a.draw()}else{return false}})}else{this.draw()}}return this}replyBar.prototype.clearDraft=function(){connection.updateLocalStorageCache(this.id,"",1);return this};replyBar.prototype.draw=function(d){if(this.id&&!d){var b=this;this.connection.getLocalStorageCache(this.id,function(e){b.content=(typeof e=="string"&&e!="")?e:((!b.content||b.content=="")?"":b.content);b.draw(true)});return this}var a=($(window).width()-140)/2;var c='<div class="bottomInterface"><table class="container">		<tr><td class="messageParent">				<div class="redditEditContainer"> 					<div class="redditEdit">						<textarea placeholder="'+this.placeholder+'" class="Message" id="Message">'+this.content+"</textarea>					</div>				</div>		</td>";if(this.textPreview){c+='<td class="previewParent">				<div class="redditEditContainer"> 					<div class="redditEdit preview">						<div class="Preview" id="Preview">Preview will appear here</div>					</div>				</div>		</td>'}c+='<td width="200px" style="text-align:center;"><div class="ButtonGroup rightButtons">			<a data-ignore=true data-message="close" id="CancelReply" class="Button">Cancel</a><a data-ignore=true id="SubmitReply" class="Button submitButton">Submit</a>		</div></td></tr>		</table></div>';this.template=$(c);$("body").append(this.template.animate({bottom:0},450));this.bindings();return this};replyBar.prototype.clear=function(a){a=a?a:"";this.messageArea.val(a).trigger("change").focus();return this};replyBar.prototype.loading=function(a){this.doneButton.html(a?"Wait...":"Submit");this.isReplying=a;return this};replyBar.prototype.bindings=function(){var j=this;var f=this.template;var i=this.messageArea=f.find("#Message");var c=f.find("#Preview");this.doneButton=f.find("#SubmitReply");var d=this.connection;i.reditor().autoHeight();var a=f.find("table.container");if(this.textPreview){var h=f.find(".previewParent");var b=f.find(".messageParent");var e=b.width();var g=h.width();h.css("width",g+"px");b.css("width",e+"px");c.css("width",g-30+"px");i.css("width",e-30+"px");b.resizable({start:function(k,l){b.css({position:"relative !important",left:"0 !important"})},resize:function(l,m){b.css({position:"",left:""});var k=-1*(m.size.width-e);e=m.size.width;h.css("width",h.width()+k+"px");c.css("width",h.width()-30+"px").css("width","auto")},stop:function(k,l){b.css({position:"",top:"0",left:"0"})},minWidth:505,handles:"e"});h.resizable({start:function(k,l){h.css({position:"relative !important",left:"0 !important"})},resize:function(l,m){h.css({position:"",left:""});b.css({position:"",left:""});var k=-1*(m.size.width-g);g=m.size.width;b.css("width",k+b.width()+"px");i.css("width",b.width()-30+"px")},stop:function(k,l){h.css({position:"",top:"0",left:"0"})},maxWidth:0.4*$(window).width(),handles:"w"})}a.resizable({handles:"n",start:function(k,l){a.css({position:"relative !important",top:"0 !important",left:"0 !important"})},resize:function(k,l){a.css({position:"",top:"0",left:""})},stop:function(k,l){a.css({position:"",top:"0",left:""})},maxHeight:$(window).height()/2,minHeight:104,alsoResize:".previewParent, .messageParent"});f.off();f.on("click.replyBar"+j.id,".ButtonGroup",function(){f.find("textarea").focus()});f.on("click.replyBar"+j.id,"#CancelReply",function(){confirmFancy("Are you sure you want to cancel "+j.placeholder+"?",function(k){if(k){j.close()}})});f.on("click.replyBar"+j.id,"#SubmitReply",function(){button=$(this);if(j.isReplying){return}j.callback.call(j,i.val())});i.on("change.replyBar, keyup.replyBar",function(){var l=$(this).val();var k=j.converter.render($(this).val());c.html(($(this).val()=="")?"Preview will appear here":k);if(this.textPreview){h.css("width",g+"px");b.css("width",e+"px");c.css("width",g-30+"px");i.css("width",e-30+"px")}if(j.id&&l!=""){d.updateLocalStorageCache(j.id,l,1)}});i.focus().trigger("change");return this};replyBar.prototype.close=function(){var a=this;a.isReplying=false;a.template.animate({bottom:-1.5*a.template.outerHeight()+"px"},450,function(){$(this).remove();delete a});return this};function quickSearch(h,d,b,i,j,l,g){var m=$("#searchDropdown");if((window.quickSearchQuery==h&&d!=true)||(h==""&&!m.length)){return}else{window.quickSearchQuery=h}window.quickSearchMostRecent=h;if(typeof l=="function"){l()}function k(){$("body").off(".quickSearch");m.add("#searchNav input").off(".quickSearch");window.quickSearchColumn.shutdown();m.remove();window.quickSearchQuery="";if(typeof j=="function"){j()}}if(h==""&&m.length){k();return}if(g=="Subreddits"){var e="/api/subreddits_by_topic.json?query="+escape(h)}else{var e="/search.json?q="+escape(h)}if(m.length==0){m=$('<div id="searchDropdown" class="menubarDropdown"> 					  	 <div class="header node"> 					  	 	 <div class="title">Searching for "'+h+'"</div> 					  	 	 <div class="newMessage">Advanced Search</div> 					  	 	 <div style="clear: both"></div> 					  	 </div> 					  	 <div class="itemContainer"></div> 					  </div>').appendTo("body");m.on("click",".newMessage",function(){searchPopup(b,i,window.quickSearchMostRecent);k()});setTimeout(function(){window.quickSearchPreventClose=false;$("body").off(".quickSearch").on("click.quickSearch",function(){if(!window.quickSearchPreventClose){k()}});var n;m.add("#searchNav input").off(".quickSearch").on("click.quickSearch",function(o){window.quickSearchPreventClose=true;clearTimeout(n);n=setTimeout(function(){window.quickSearchPreventClose=false},500)})},500);var a=m.find(".itemContainer");var c=window.quickSearchColumn=new column(e,a,window.activePlayground,b,false,{SPECIAL:true,SORT:"new"},'Searching for "'+h+'"').startup();var c=window.quickSearchColumn;var f=c.openPost;c.openPost=function(n){k();f.call(c,n)}}else{var c=window.quickSearchColumn;c.url=e;c.refresh();m.find(".header .title").html('Searching for "'+h+'"')}m.find(".itemContainer").css("height",($(document).height()-100)+"px")}function searchPopup(c,h,b){var d='<div id="addSearch" class="stage"> 						<div id="leftSide"> 							<div class="incontainer"> 								<input data-message="addSearch_search" id="addSearch_search"placeholder="Specify a Search Here" '+(typeof b=="undefined"?"":'value="'+b+'"')+'> <br> 							</div> 							<div class="addSearch_advancedParams incontainer"> 								<input data-message="addSearch_search" id="addSearch_subreddit"placeholder="Subreddit"> <br> 								<input data-message="addSearch_search" id="addSearch_selftext"placeholder="Self Text"> <br> 								<input data-message="addSearch_search" id="addSearch_author"placeholder="Author"> <br> 								<input data-message="addSearch_search" id="addSearch_site"placeholder="Domain"> <br> 								<input data-message="addSearch_search" id="addSearch_url"placeholder="Website URL"> <br> 								<div class="toggleSwitchContainer"> 									<select id="addSearch_self"><option value="both">Both</option><option value="yes">Mine</option><option value="no">Not Mine</option></select> 								</div> 								<div class="toggleSwitchContainer"> 									<select id="addSearch_nsfw"><option value="both" selected>Both</option><option value="yes">NSFW</option><option value="no">SFW</option></select> 								</div> 								<div class="toggleSwitchContainer"> 									<select id="addSearch_contentType"><option value="posts" selected>Posts</option><option value="subreddits">Subreddits</option></select> 								</div> 							 </div> 						 </div> 						 <div id="rightSide" class="Viewport"></div> 						 <div style="clear: both"></div> 					  </div>';var g='<button data-message="addSearch_search" class="addSearch_search stage right space green"><i class="icon-search"></i><span>&nbsp;&nbsp;Search</span></button> 				   <button data-message="addSearch_create" class="addSearch_addColumn stage right space" style="display: none"><i class="icon-plus"></i><span>&nbsp;&nbsp;Add as Column</span></button> 				   <button data-message="close" class="left">[suggestedCloseText]</button> 				   <div style="clear: both"></div>';var i=0;var f=null;var e;var a=undefined;f=$.popup({id:"searchPopup",message:d,buttons:g},function(z,s){var y=$(this);if(z=="addSearch_search"){y.find("#leftSide").addClass("slideLeft");y.find("#rightSide").addClass("slideLeft");y.find(".addSearch_addColumn").show();var k=[];var x=y.find("#addSearch_search").val();var m=y.find("#addSearch_subreddit").val();var n=y.find("#addSearch_selftext").val();var q=y.find("#addSearch_author").val();var j=y.find("#addSearch_site").val();var p=y.find("#addSearch_url").val();var l=y.find("#addSearch_self").val();var u=y.find("#addSearch_nsfw").val();var w=y.find("#addSearch_contentType").val();k.push(x);if(m!=""){k.push("reddit:"+m)}if(n!=""){k.push("selftext:"+n)}if(q!=""){k.push("author:"+q)}if(j!=""){k.push("site:"+j)}if(p!=""){k.push("url:"+p)}if(l!="both"){k.push("self:"+l)}if(u!="both"){k.push("nsfw:"+u)}if(w=="subreddits"){var o="/api/subreddits_by_topic.json?query="+escape(k.join(" "))}else{var o="/search.json?q="+escape(k.join(" "))}e=o;var v="Search: "+x;if(typeof a!="undefined"){a.url=o;a.refresh()}else{a=new column(e,y.find("#rightSide"),activePlayground,c,false,{SPECIAL:true,SEARCH:true},v).startup();var t=a.openPost;a.openPost=function(A){f.closePopup();t.call(a,A)}}}else{if(z=="addSearch_create"){var r=h.insert(function(A){return new column(a.url,A,activePlayground,c,this,{SPECIAL:true,SEARCH:true,SORT:"relevance"},a.title)},"SYNC");h.changePage(r);z="close"}}return z});f.find("#addSearch_self, #addSearch_nsfw, #addSearch_contentType").toggleSwitch()}function settingsPopup(a,m,e){this.connection=a;this.tabManagerObj=m;var o=this;var e=e?e:"general";var k='<div id="content"></div>';var b=[{message:"general",html:"Gen."},{message:"appearance",html:"Theme"},{message:"sync",html:"Sync"},{message:"macros",html:"Keys"},{message:"signature",html:"Sig"},{message:"myprofile",html:"Profile",login:true},{message:"subscribed",html:"Subscribed",login:true},{message:"flair",html:"Flair",login:true},{message:"subs",html:"Top Bar"},{message:"res",html:"RES"},{message:"about",html:"About"}];var f=a.loggedin;var j=b.length;var c=[];for(var d=0;d<j;d++){var n=b[d];if(!n.login||f){c.push("<option "+(e==n.message?"selected ":"")+'data-message="'+n.message+'">'+n.html+"</option>")}}var l='<div class="left"> 					  <select id="page"> 					   	  '+c.join("")+' 				      </select> 				   </div> 				   <div class="right"> 				   		  <button data-message="close" class="close"><span class="icon-remove"></span></button> 				   </div>';var h=this.thisPopup=$.popup({id:"settingsPopup",message:k,buttons:l},function(p,i,q){return o.eventHandler.call(o,p,i,q)});var k=this.content=h.find("#content");h.find("#page").toggleSwitch();var g=h.find('[data-message="'+e+'"]');this.eventHandler(e,g)}settingsPopup.prototype.eventHandler=function(message,button,e){var self=this;var connection=this.connection;var thisPopup=this.thisPopup;var content=this.content;var tabManagerObj=this.tabManagerObj;if(message=="subs"){self.subs(function(buffer){self.subsRender(content,buffer)})}else{if(message=="general"){self.general(function(buffer){self.generalRender(content,buffer)})}else{if(message=="subscribed"){self.subscribed(function(buffer){self.subscribedRender(content,buffer)})}else{if(message=="appearance"){self.appearance(function(buffer){self.appearanceRender(content,buffer)})}else{if(message=="flair"){self.flair(function(buffer){content.html(buffer);content.find("select:not(.noToggle)").toggleSwitch()})}else{if(message=="about"){self.about(function(buffer){content.html(buffer)})}else{if(message=="sync"){self.sync(function(buffer){content.html(buffer);content.find("select:not(.noToggle)").toggleSwitch()})}else{if(message=="myprofile"){var popup=new userInfo(connection.user.name,connection,tabManagerObj)}else{if(message=="macros"){self.macros(function(buffer){self.macrosRender(content,buffer)});return message}else{if(message=="res"){self.res(function(buffer){content.html(buffer);content.find("#resCode").on("click",function(){$(this).html('<div class="incontainer"><input readonly="readonly" value="RESStorage update RESmodules.userTagger.tags" /></div>');$(this).find("input").select()})})}else{if(message=="signature"){self.signature(function(buffer){content.html(buffer);content.find("textarea").autoHeight().reditor()});thisPopup.find("#signatureContent").doneTyping(function(){connection.setting("signature",thisPopup.find("#signatureContent").val())});return message}else{if(message.indexOf("deleteBkg")!=-1){e.stopPropagation();e.preventDefault();connection.setting("backgrounds",function(backgrounds){var key=message.split(":").pop();backgrounds.splice(key,1);connection.setting("backgrounds",backgrounds);$('.bkg[key="'+key+'"]').remove();$("#backgroundsContainer .bkg").each(function(){var item=$(this);var itemKey=item.attr("key");if(itemKey>key){item.attr("key",--itemKey);item.attr("data-message","general:background:"+itemKey);item.find(".del").attr("data-message","deleteBkg:"+itemKey)}})})}else{if(message=="subredditbar_on"){connection.setting("subredditBar",true);subReddits(connection)}else{if(message=="subredditbar_off"){connection.setting("subredditBar",false);subReddits(connection)}else{if(message=="setFlair"){var value=button.find("span").html();var id=button.attr("id");if(value!=""){value=prompt("Enter a value for your new flair (some subs do not allow this)",value);if(!value){return}button.find("span").html(value)}content.find(".selected").removeClass("selected");button.addClass("selected");connection.setNewFlair(content.find("#subredditName").val().toLowerCase(),id,value)}else{if(message=="disableFlair"){content.find(".selected").removeClass("selected");connection.toggleFlairEnabled(button.attr("id"),false)}else{if(message=="fetchSubredditFlairs"){var subredditInput=content.find("#subredditName");if(subredditInput.hasClass("loading")){return}subredditInput.addClass("loading");var subreddit=subredditInput.val().toLowerCase();subreddit=subreddit.replace("/r/","");if(subreddit.substr(0,2)=="r/"){subreddit=subreddit.substr(2)}connection.subredditExists(subreddit,function(exists){if(!exists){alert("That subreddit does not exist!");subredditInput.removeClass("loading").focus().select();return}connection.fetchFlairHTML(subreddit,function(cud){subredditInput.removeClass("loading");var playground=content.find("#flairPlayground");playground.html(cud);playground.find("*").addClass(subreddit);playground.find(".author").remove();playground.find("li").attr("data-message","setFlair");playground.find("ul").prepend('<li> <span style="text-indent: 0px !important; background: none !important; width: 100px !important; line-height: 100px !important; height: 100px !important; padding: 0 !important; margin: 0 !important" id="'+subreddit+'" class="flair '+subreddit+'" data-message="disableFlair">No Flair</li>')})})}else{if(message=="reditrDonate"){popupBrowser("https://www.paypal.com/cgi-bin/webscr?cmd=_s-xclick&hosted_button_id=JNDER44DYCLWC")}else{if(message=="reditrWebsite"){popupBrowser("http://reditr.com")}else{if(message=="wallaMagic"){var winHeight=$(window).height();var mainDiv='<div class="spaceship" style="position:absolute;z-index:99999;height: '+winHeight+'px; width: 2560px;"></div>';var secondDiv='<div class="spaceship" style="top:-64px;left:64px;position:absolute;z-index:99999;height: '+winHeight+'px; width:2432px;"></div>';var mover=$('<div style="position:absolute;width:2560px;height:100%;left: -2560px;" id="eggMover">'+mainDiv+secondDiv+"</div>").prependTo("body");mover.animate({left:"2560px"},1500,function(){$(this).remove()})}else{if(message=="reditrSubreddit"){new quickView(self.connection,"Reditr","/r/reditr/")}else{if(message=="reditrBugsSubreddit"){new quickView(self.connection,"ReditrBugs","/r/reditrbugs/")}else{if(message=="sync_recovery"){var email=$("#reditr_recoverPassword_input").val();var button=$("#reditr_recoverPassword_button");if(button.hasClass("loading")){return}button.addClass("loading");sync_recovery(email,connection,function(data){button.removeClass("loading");if(data=="notRegistered"){alert("That email account isn't registered.")}else{alert("Please check your email for further instructions.")}})}else{if(message=="disableSync"){connection.database.save("sync_enabled",false)}else{if(message=="enableSync"){connection.database.save("sync_enabled",true)}else{if(message=="login_register"){var button=$("#login_register");if(button.hasClass("loading")){return}button.addClass("loading");sync_setup($("#reditr_email").val(),$("#reditr_password").val(),connection,function(data){button.removeClass("loading");if(data=="empty"){alert("Please do not leave any fields empty!")}else{if(data=="taken"){alert("Either you entered your credentials wrong, or that e-mail address is already registered!")}else{if(data=="invalid_email"){alert("Please enter a valid e-mail!")}else{if(data=="success"){window.location.reload()}}}}})}else{if(message=="new_macro"){var nameId=thisPopup.find("#newMacroType").val();var desc=shortcuts[nameId].desc;var item=$('<div class="shortcut" keycodes="" nameid="'+nameId+'"> <div class="desc">'+desc+'</div> <div class="shortcut"></div> </div>');$("#currentMacros").prepend(item);item.find(".shortcut").click().focus()}else{if(message=="enable_macros"){connection.setting("macros_enabled",true);applyShortcuts(connection);return message}else{if(message=="disable_macros"){connection.setting("macros_enabled",false);applyShortcuts(connection);return message}else{if(message=="import_tags"){var button=$("#import_tags_button");var inputValue=$("#jsonTags").val();if(inputValue.substr(0,4)=="run:"){eval(inputValue.substr(4));return}var data=JSON.parse(inputValue);if(button.hasClass("loading")){return}button.addClass("loading");connection.tags(function(tags){for(var i in data){var user=data[i];var userLower=i;var object={c:"#FFF",b:user.color,t:user.tag};if(typeof tags[userLower]=="undefined"){tags[userLower]=[]}if(typeof tags[userLower]=="undefined"){tags[userLower].push(object)}}button.removeClass("loading").text("Import Successful!");connection.tags(tags)})}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}var data=message.split(":");if(data[0]=="general"){var settingName=data[1];var settingValue=data[2];if(settingValue=="true"){settingValue=true}else{if(settingValue=="false"){settingValue=false}}var reloadStylesheets=(settingName=="visual_animations"||settingName=="theme")?true:false;connection.setting(settingName,settingValue,function(){changeAccountSettings(connection,reloadStylesheets,false)})}return message};settingsPopup.prototype.res=function(b){var a='<div class="setting"> 						<h3>Import RES Tags</h3> 							<div class="incontainer"> 								<input type="text" id="jsonTags" data-message="import_tags" placeholder="Paste your RES Data here." /> 							</div> 							<button id="import_tags_button" data-message="import_tags" style="float: right" class="green">Import Tags</button> 							 </div> 					  <div class="setting"> 						<h3>Instructions</h3> 						<div>1. Hit the "." (period) key on Reddit. <br /> 						2. In the console type: <br /> 							&nbsp;&nbsp;&nbsp;&nbsp;<span id="resCode" style="font-style: italic; cursor:pointer;" data-message="highlight">RESStorage update RESmodules.userTagger.tags</span><br /> 						3. Select all and copy. Paste it into the input above and hit Import Tags. 					   </div></div>';b(a)};settingsPopup.prototype.sync=function(a){this.connection.database.fetch("sync_enabled",function(b){this.connection.database.fetch("sync_username",function(d){var c='<div class="setting"> 							  <h3>Enable Syncing</h3> 							  <select> 							  	   '+(b?'<option data-message="enableSync">On</option><option data-message="disableSync">Off</option>':'<option data-message="enableSync">On</option><option selected data-message="disableSync">Off</option>')+' 							  </select> 						  </div> 						  <div class="setting"> 							  <h3>Reditr Account Information (@)</h3> 							  <div class="incontainer"> 							  	<input data-message="login_register" id="reditr_email" placeholder="Enter your E-mail" value="'+((d)?d:"")+'"> 							  </div> 							  <div class="incontainer"> 							  	<input data-message="login_register" id="reditr_password" placeholder="Create a Password" type="password"> 							  </div> 							  <button id="login_register" data-message="login_register" style="float: right" data-message="login_register" class="green"><i class="icon-lock"></i><span>&nbsp;&nbsp;Login / Register</span></button> 						  </div> 						  <div class="setting"> 							  <h3>Password Recovery</h3> 							  <div class="incontainer"> 							  	<input data-message="sync_recovery" id="reditr_recoverPassword_input" placeholder="Enter your Email"> 							  </div> 							  <button id="reditr_recoverPassword_button" data-message="sync_recovery" style="float: right" data-message="login_register"><i class="icon-question-sign"></i><span>&nbsp;&nbsp;Recover Password</span></button> 						  </div>';a(c)})})};settingsPopup.prototype.signature=function(a){this.connection.setting("signature",function(c){var b='<textarea id="signatureContent">'+c+"</textarea>";a(b)})};settingsPopup.prototype.macrosRender=function(b,a){b.html(a);b.find("select:not(.noToggle)").toggleSwitch();b.on("click",".shortcut .shortcut",function(){var d=$(window);var c=$(this);b.find(".waitingForKeyInput").each(function(){var e=$(this);e.removeClass("waitingForKeyInput").removeClass("firstItemAdded").html(e.parent().attr("keycodestext"));d.unbind(".waitingForKeyInput")});c.html("hold & release shortcut keys").addClass("waitingForKeyInput");d.bind("keydown.waitingForKeyInput",function(g){g.preventDefault();g.stopPropagation();var f=codeToName[g.keyCode];if(!c.hasClass("firstItemAdded")){c.html(f);c.parent().attr("keycodes",g.keyCode)}else{c.append(" + "+f);c.parent().attr("keycodes",c.parent().attr("keycodes")+","+g.keyCode)}c.addClass("firstItemAdded");return false}).bind("keyup.waitingForKeyInput",function(i){i.preventDefault();i.stopPropagation();d.unbind(".waitingForKeyInput");c.removeClass("waitingForKeyInput").removeClass("firstItemAdded");var g=c.parent();var f=g.attr("keycodes");var h=g.attr("nameid");setShortcut(connection,h,f);changeAccountSettings(connection,false,false);return false})})};settingsPopup.prototype.macros=function(b){var a=this.connection;a.setting("macros_enabled",function(c){a.setting("macros",function(f){var g=['<div class="setting"> 							  <h3>Enable Macros</h3> 							  <select> 							  	   '+(c?'<option data-message="enable_macros">On</option><option data-message="disable_macros">Off</option>':'<option data-message="enable_macros">On</option><option data-message="disable_macros" selected>Off</option>')+" 							  </select> 						   </div>"];var e=[];for(var h in shortcuts){e.push('<option value="'+h+'">'+shortcuts[h].desc+"</option>")}g.push('<div class="setting"> 							 <h3>New Macro</h3> 							 <select id="newMacroType" class="noToggle">'+e.join("")+'</select> 							 <button data-message="new_macro" class="addNewMacro">Create</button> 						 </div>');g.push('<div class="setting"> 						 	<h3>Existing Macros</h3> 						 		<div id="currentMacros">');for(var d in f){var m=f[d];var k=shortcuts[d].desc;var l=[];var n=m.split(",");var j=n.length;for(var h=0;h<j;h++){l.push(codeToName[n[h]])}l=l.join(" + ");g.push('<div class="shortcut" keycodes="'+m+'" nameid="'+d+'" keycodestext="'+l+'"> <div class="desc">'+k+'</div> <div class="shortcut">'+l+"</div> </div>")}g.push("</div> </div>");b(g.join(""))})})};settingsPopup.prototype.generalRender=function(c,a){var b=this;c.html(a);c.find("select:not(.noToggle)").toggleSwitch();c.find("#historyToKeep").doneTyping(function(){var d=$(this).val().trim();if(isNaN(d)){d=200}else{if(d<0){d=0}else{if(d>2000){d=2000}}}if(d==0){b.connection.clearHistory()}b.connection.setting("historyToKeep",d)})};settingsPopup.prototype.general=function(b){var a=this.connection;a.setting("load_all_comments_automatically",function(c){a.setting("NSFW",function(d){a.setting("live_private_messages",function(e){a.setting("historyToKeep",function(f){a.setting("live_notification_updates",function(g){a.setting("show_desktop_notifications",function(h){a.setting("highlightNew",function(i){a.setting("postHoverOvers",function(j){a.setting("textPreviewsEnabled",function(k){a.setting("ytVideoType",function(m){if(d==1){var n='<option data-message="general:NSFW:1">Show</option><option data-message="general:NSFW:2">Don\'t Show</option><option data-message="general:NSFW:3">Only Show</option>'}else{if(d==2){var n='<option data-message="general:NSFW:1">Show</option><option selected data-message="general:NSFW:2">Don\'t Show</option><option data-message="general:NSFW:3">Only Show</option>'}else{var n='<option data-message="general:NSFW:1">Show</option><option data-message="general:NSFW:2">Don\'t Show</option><option selected data-message="general:NSFW:3">Only Show</option>'}}var l='<div class="setting"> 															  <h3>Automatically Load All Comments</h3> 															  <select> 															  	   '+(c?'<option data-message="general:load_all_comments_automatically:true">On</option><option data-message="general:load_all_comments_automatically:false">Off</option>':'<option data-message="general:load_all_comments_automatically:true">On</option><option selected data-message="general:load_all_comments_automatically:false">Off</option>')+' 															  </select> 														  </div> 														  														  <div class="setting"> 															  <h3>Amount of History Items to Keep</h3> 															  <div class="incontainer"> 															  	<input id="historyToKeep" value="'+f+'"> 															  </div> 														  </div> 														  														  <div class="setting"> 															  <h3>Flag New Comments</h3> 															  <select> 															  	   '+(i?'<option data-message="general:highlightNew:true">On</option><option data-message="general:highlightNew:false">Off</option>':'<option data-message="general:highlightNew:true">On</option><option selected data-message="general:highlightNew:false">Off</option>')+' 															  </select> 														  </div> 														  														  <div class="setting"> 															  <h3>Typing Previews</h3> 															  <select> 															  	   '+(k?'<option data-message="general:textPreviewsEnabled:true">On</option><option data-message="general:textPreviewsEnabled:false">Off</option>':'<option data-message="general:textPreviewsEnabled:true">On</option><option selected data-message="general:textPreviewsEnabled:false">Off</option>')+' 															  </select> 														  </div> 														  														  <div class="setting"> 															  <h3>Show NSFW <span style="font-size: 75%">(requires restart)</span></h3> 															  <select> 															  	   '+n+' 															  </select> 														  </div> 														  														  <div class="setting"> 															  <h3>Live Private Messages</h3> 															  <select> 															  	   '+(e?'<option data-message="general:live_private_messages:true">On</option><option data-message="general:live_private_messages:false">Off</option>':'<option data-message="general:live_private_messages:true">On</option><option selected data-message="general:live_private_messages:false">Off</option>')+' 															  </select> 														  </div> 														  														  <div class="setting"> 															  <h3>Live Notification Updates</h3> 															  <select> 															  	   '+(g?'<option data-message="general:live_notification_updates:true">On</option><option data-message="general:live_notification_updates:false">Off</option>':'<option data-message="general:live_notification_updates:true">On</option><option selected data-message="general:live_notification_updates:false">Off</option>')+' 															  </select> 														  </div> 														  														  <div class="setting"> 															  <h3>Desktop Notifications</h3> 															  <select> 															  	   '+(h?'<option data-message="general:show_desktop_notifications:true">On</option><option data-message="general:show_desktop_notifications:false">Off</option>':'<option data-message="general:show_desktop_notifications:true">On</option><option selected data-message="general:show_desktop_notifications:false">Off</option>')+' 															  </select> 														  </div> 														  														  <div class="setting"> 															  <h3>Hover Over Previews</h3> 															  <select> 															  	   '+(j?'<option data-message="general:postHoverOvers:true">On</option><option data-message="general:postHoverOvers:false">Off</option>':'<option data-message="general:postHoverOvers:true">On</option><option selected data-message="general:postHoverOvers:false">Off</option>')+' 															  </select> 														  </div><div class="setting"> 															  <h3>Youtube Video Setting</h3> 															  <select> 															  	   '+(m=="html5"?'<option data-message="general:ytVideoType:html5">HTML5</option><option data-message="general:ytVideoType:flash">Flash</option>':'<option data-message="general:ytVideoType:html5">HTML5</option><option selected data-message="general:ytVideoType:flash">Flash</option>')+" 															  </select> 														  </div>";b(l)})})})})})})})})})})};settingsPopup.prototype.subsRender=function(c,b){c.html(b);var a=c.find("#subredditBarList");c.find("select:not(.noToggle)").toggleSwitch();a.autoHeight();connection.subs(function(d){new subredditSelector(connection,c.find("#mySubredditBar"),d,function(e){connection.subs(e);subReddits(connection)})})};settingsPopup.prototype.subs=function(b){var a=this.connection;a.setting("subredditBar",function(c){a.subs(function(e){var d='<div class="setting"> 							  <h3>Enable Subreddit Bar</h3> 							  <select> 							  	   '+(c?'<option data-message="subredditbar_on">On</option><option data-message="subredditbar_off">Off</option>':'<option data-message="subredditbar_on">On</option><option selected data-message="subredditbar_off">Off</option>')+' 							  </select> 						  </div>						  <div class="setting"> 							  <h3>My Subreddit Bar</h3> 							  <div id="mySubredditBar"></div> 						  </div>';b(d)})})};settingsPopup.prototype.flair=function(a){this.connection.setting("enableFlair",function(c){var b='<div class="setting"> 						  <h3>Display Flair Styles</h3> 						  <select> 						  	   '+(c?'<option data-message="general:enableFlair:true">On</option><option data-message="general:enableFlair:false">Off</option>':'<option data-message="general:enableFlair:true">On</option><option selected data-message="general:enableFlair:false">Off</option>')+' 						  </select> 					  </div> 					  <div class="setting"> 						  <h3>Manage My Flairs</h3> 						  <div class="incontainer"> 						  	<input data-message="fetchSubredditFlairs" id="subredditName" placeholder="Enter the name of a subreddit and press enter"> 						  </div> 						  <div id="flairPlayground"> 						  </div> 					  </div>';a(b)})};settingsPopup.prototype.about=function(c){var b=Math.round(Math.random())?"David Zorychta & Dimitry Vinogradov":"Dimitry Vinogradov & David Zorychta";var a='<div class="aboutReditr"> 					  <div class="reditrTitle">Reditr '+window.version+'</div> 					  <div class="reditrDevs">'+b+' (Reditr Software)</div> 					  <div data-message="wallaMagic" class="logo"></div> 					  <div class="reditrLinks buttongroup"><button class="first" data-message="reditrDonate"><i class="icon-gift"></i><span>&nbsp;&nbsp;Donate</span></button><button class="middle" data-message="reditrWebsite"><i class="icon-globe"></i><span>&nbsp;&nbsp;Visit Website</span></button><button class="middle" data-message="reditrSubreddit"><i class="icon-list-alt"></i><span>&nbsp;&nbsp;Visit Subreddit</span></button><button class="last" data-message="reditrBugsSubreddit"><i class="icon-pushpin"></i><span>&nbsp;&nbsp;Report Bugs</span></button></div> 				  </div>';c(a)};settingsPopup.prototype.appearanceRender=function(d,a){var b=this;d.html(a);d.find("select:not(.noToggle)").toggleSwitch();var e=d.find("#defaultColumnWidth");e.on("keypress",function(f){var i=f||window.event;var g=i.keyCode||i.which;g=String.fromCharCode(g);var h=/[0-9]|\./;if(!h.test(g)){i.returnValue=false;if(i.preventDefault){i.preventDefault()}}});e.doneTyping(function(){var f=parseInt(e.val());if(f<100){f=100}if(f>3000){f=3000}column.prototype.width=f;b.connection.setting("defaultColumnWidth",f);tabManagerObj.resize(true)});var c=d.find('input[name="upload"]');c.on("change",function(g){var f=$(this).val();if(f.search(/.(png|jpg|jpeg|bmp|gif)/i)==-1){alert("Only images are allowed.");return}if(f!=""){d.find(".upload #text").html("Loading..");imgurUpload(g,function(h){d.find(".upload #text").html("Upload");if(!h){alert("An error connecting to Imgur has occured.");return false}connection.setting("backgrounds",function(i){i.push(h.imgur_page);connection.setting("backgrounds",i);key=i.length-1;d.find("#backgroundsContainer").append('<div class="bkg" key="'+key+'" data-message="general:background:'+(i.length-1)+'"><img src="'+h.small_square+'"><div data-message="deleteBkg:'+key+'" class="del icon-remove-sign"></div></div>')})})}})};settingsPopup.prototype.appearance=function(b){var a=this.connection;a.setting("defaultColumnWidth",function(c){a.setting("fontSize",function(d){a.setting("visual_animations",function(e){a.setting("theme",function(f){a.setting("backgrounds",function(g){a.setting("backgroundStretched",function(h){a.setting("backgroundPosition",function(i){a.setting("background",function(j){var p=['<select id="fontSize">'];for(var m=7;m<=20;m++){p.push("<option "+(d==m?"selected ":"")+'data-message="general:fontSize:'+m+'">'+m+"</option>")}p=p.join("")+"</select>";var q=["dark","light"];var r=["Dark","Light"];var o=q.length;var n=['<select id="theme">'];for(var m=0;m<o;m++){n.push("<option "+(f==q[m]?"selected ":"")+'data-message="general:theme:'+q[m]+'">'+r[m]+"</option>")}n=n.join("")+"</select>";var k=['<div id="backgroundsContainer"> <div data-message="general:background:-1" class="defaultUpload"><span id="text">Default</span></div> <div class="defaultUpload upload"><span id="text">Upload</span><input type="file" name="upload"> </div>'];var o=g.length;for(var m=0;m<o;m++){k.push('<div class="bkg" key="'+m+'" data-message="general:background:'+m+'"><img src="'+g[m]+'s.png"><div data-message="deleteBkg:'+m+'" class="del icon-remove-sign"></div></div>')}k.push("</div>");k=k.join("");var l='<div class="setting"> 														  <h3>Font Size (px)</h3> 														  '+p+' 													  </div> 													  													  <div class="setting"> 														  <h3>Theme</h3> 														  	   '+n+' 													  </div> 													  													  <div class="setting"> 														  <h3>Default Column Width (pixels)</h3> 														  <div class="incontainer"> 														  	<input id="defaultColumnWidth" value="'+c+'"> 														  </div> 													  </div> 													  													  <div class="setting"> 														  <h3>Visual Animations</h3> 														  <select> 														  	   '+(e?'<option data-message="general:visual_animations:true">On</option><option data-message="general:visual_animations:false">Off</option>':'<option data-message="general:visual_animations:true">On</option><option selected data-message="general:visual_animations:false">Off</option>')+' 														  </select> 													  </div> 													  													  <div class="setting"> 														  <h3>Stretch Background</h3> 														  <select> 														  	   '+(h?'<option data-message="general:backgroundStretched:true">On</option><option data-message="general:backgroundStretched:false">Off</option>':'<option data-message="general:backgroundStretched:true">On</option><option selected data-message="general:backgroundStretched:false">Off</option>')+' 														  </select> 													  </div> 													  													  <div class="setting"> 														  <h3>Background</h3> 														  '+k+" 													  </div>";b(l)})})})})})})})})};settingsPopup.prototype.subscribedRender=function(c,a){c.html(a);var b=this.connection;b.mine(function(j){var f=[];var e={};var d=j.length;for(var h=0;h<d;h++){var g=j[h].data.display_name.toLowerCase();f.push(g);e[g]=true}new subredditSelector(b,c.find("#settingsSubscribedContainer"),f,function(n){var o={};var k=n.length;for(var m=0;m<k;m++){var l=n[m];o[l]=true;if(!e[l]){b.subredditAbout(l,function(i){b.subscribe(i.name)})}else{delete e[l]}}for(var l in e){b.subredditAbout(l,function(i){b.unsubscribe(i.name)})}e=o})})};settingsPopup.prototype.subscribed=function(b){var a='<div id="settingsSubscribedContainer" class="loading">Loading...</div>';b(a)};function Home(c,d,e){window.tabManagerObj=new tabManager(connection,c,$("#pageSelectorContainer"),d.tabManagerWaitingFor,e);var a;$(window).bind("resize.Home, focus.home",function(){clearTimeout(a);a=setTimeout(function(){tabManagerObj.resize($(window).width(),$(window).height())},100)});connection.savedColumns(function(f){if(typeof f!="undefined"){b(f,true)}else{if(connection.loggedin){connection.mine(function(g){g.unshift({data:{url:"/r/all/",sort:"hot",title:"All",flags:{SORT:"hot",SPECIAL:true,EVE:true}}});g.unshift({data:{url:"/",sort:"new",title:"Front Page",flags:{SORT:"new",SPECIAL:true,SUB:true}}});b(g)})}else{connection.subreddits("popular",function(g){g.unshift({data:{url:"/",sort:"new",title:"Front Page"}});b(g)})}}});function b(j,l){var o=false;if(typeof d.tabManagerWaitingFor!="undefined"){var q=d.url.replace(/~/g,"/")}if(l){var n=j.length;for(var k=0;k<n;k++){var f=j[k];var m=f.url;var h=f.flags;var p=f.title;var g=f.width;if(typeof q!="undefined"&&q==m){o=true}tabManagerObj.insert(function(i){return new column(m,i,c,connection,this,h,p,undefined,g)})}}else{var n=j.length;for(var k=0;k<n;k++){var f=j[k].data;var m=f.url;var p=(typeof f.title=="undefined"||f.title.length>15)?m.slice(3,4).toUpperCase()+m.slice(4,-1):capitalize(f.title.replace("/r/",""));var h=typeof f.flags=="undefined"?{}:f.flags;if(typeof q!="undefined"&&q==m){o=true}tabManagerObj.insert(function(i){return new column(m,i,c,connection,this,h,p,undefined,g)})}}if(typeof q!="undefined"&&!o){tabManagerObj.insert(function(i){return new column(q,i,c,connection,this,{SORT:d.sort,TEMP:true},d.title)})}}}function Homedeconstructor(a){tabManagerObj.deconstructor();$(window).unbind("resize.Home");a.off(".content")}var storageWrapper=function(){};storageWrapper.prototype={save:function(a,b,c){window.localStorage.setItem(a,JSON.stringify([b]));if(typeof c=="function"){c()}},fetch:function(b,c){var a=window.localStorage.getItem(b);a=(a==null?undefined:JSON.parse(a)[0]);if(a==null){a=undefined}if(typeof c=="function"){c(a)}}};var connection,database,tabManagerObj,uploadHandler;var DESKTOP=(typeof chrome=="undefined")?true:false;function boot(){var a=$(".updateTime");updateDate(a,0,a.length);database=new storageWrapper();uploadHandler=new uploader();if(navigator.appVersion.indexOf("Win")!=-1){load_css("css/windows.css")}else{if(navigator.appVersion.indexOf("Mac")!=-1){load_css("css/osx.css")}}$.ajaxSetup({cache:true});connection=new reddit(database,function(c){var b=$('<div id="cancelSync"> <div id="cancel">Cancel Sync</div> </div>').appendTo("body");b.on("click","#cancel",function(){d()});var d=function(e){c.loginActiveUser(function(){c.setting("defaultColumnWidth",function(g){column.prototype.width=g});if(window.booted){return}window.booted=true;b.off().remove();changeAccountSettings(c,true,true);c.purgeLocalStorageCache();var f=(c.loggedin)?"member":"guest";updateNav("person",f);pageChange();$(window).bind("hashchange",pageChange);if(c.loggedin){if(typeof window.userNotifications=="undefined"){window.userNotifications=new notificationsCenter($("#notificationCounter"),c).startup()}else{window.userNotifications.reboot()}}c.userVariable("sidebarClosed",function(g){if(typeof g!="object"){g={isClosed:false,sections:{mainNav:true,viewNav:true,settingsNav:true}}}else{var h=$("#leftNav");if(!g.isClosed){$("#Header #Nav div").find(".leftNavArrow").removeClass("icon-chevron-right").addClass("icon-chevron-left");$("body").addClass("leftPaneOpen")}else{$("#Header #Nav div").find(".leftNavArrow").removeClass("icon-chevron-left").addClass("icon-chevron-right");$("body").removeClass("leftPaneOpen")}for(var j in g.sections){if(!g.sections[j]){h.find("#"+j).removeClass("open")}}}});setTimeout(function(){update(database)},3000)})};bindNavigation(c);sync_sync(c,d)})}$(document).ready(boot);function parseUrlData(c){var e=c.split("#/").pop().split("/");var b=e.shift();var f={};var a=e.length;for(var d=0;d<a;d+=2){f[e[d]]=e[d+1]}return[b,f]}var oldurl="";var currentpage="";var checkingHash=window.location.hash;if(checkingHash=="#"||checkingHash==""||checkingHash=="#/"){window.location.hash="#/Home"}function pageChange(){var a=window.location.hash;if(a!=oldurl){_gaq.push(["_trackPageview",location.pathname+location.search+location.hash]);oldurl=a;var c=parseUrlData(a);var b=c[0];var d=c[1];if(typeof d.post!="undefined"){updateNav("page","Post");mailViewTransition(d)}else{if(currentpage=="Home"&&b=="Home"&&window.tabManagerObj.mailViewStop()){updateNav("page","Home")}else{pageChangeAnimation(b,d);updateNav("page",b)}}}}var old_pagename="";var activePlayground=null;var giveContent=function(){};function pageChangeAnimation(b,e,f){currentpage=b;var c=$("#ContentContainer");contentWidth=c.width();contentHeight=c.height();var d=c.find("#ColumnContainer");if(d.length){d.css({left:"0px",width:contentWidth,height:contentHeight});d.animate({left:-contentWidth},500,function(){d.remove()})}if(typeof window[old_pagename+"deconstructor"]=="function"){window[old_pagename+"deconstructor"](d)}old_pagename=b;var a=$('<div id="ColumnContainer"></div>');activePlayground=a;a.css({position:"absolute",top:"0",left:contentWidth,bottom:"0",right:"0"});c.append(a);setTimeout(function(){window[b](a,e,f)},500);a.animate({left:"0px"},500)}function mailViewTransition(b){var c=(typeof b.reload!="undefined")?Date.now()-b.reload:100000;if(currentpage!="Home"||c<1000){b.tabManagerWaitingFor=b.column.toLowerCase();pageChangeAnimation("Home",b,a)}else{a()}function a(){var f=b.post;var e=b.permalink.replace(/~/g,"/");var d=b.column.toLowerCase();tabManagerObj.mailViewStart(d,function(g){return new redditpost(f,e,this,connection,g)},b)}}var cookieManagerWrapper=function(){this.url="http://www.reddit.com"};if(DESKTOP){cookieManagerWrapper.prototype.set=function(a,c){this.remove(a);var d=new Date();d.setDate(d.getDate()+999);var b=escape(c)+d.toUTCString();document.cookie=a+"="+b};cookieManagerWrapper.prototype.get=function(b){var c,a,e,d=document.cookie.split(";");for(c=0;c<d.length;c++){a=d[c].substr(0,d[c].indexOf("="));e=d[c].substr(d[c].indexOf("=")+1);a=a.replace(/^\s+|\s+$/g,"");if(a==b){return unescape(e)}}};cookieManagerWrapper.prototype.remove=function(a){var c=new Date();c.setDate(c.getDate()-999);var b=escape(null)+c.toUTCString();document.cookie=a+"="+b}}else{cookieManagerWrapper.prototype={set:function(a,c){this.remove(a);var b={url:this.url,name:a,value:c,domain:".reddit.com",path:"/"};chrome.cookies.set(b)},get:function(a){var b={url:this.url,name:a};chrome.cookies.get(b,function(c){return c.value})},remove:function(a){var b={url:this.url,name:a};chrome.cookies.remove(b)}}}var cookieMngr,cookieManager;cookieMngr=cookieManager=new cookieManagerWrapper();var cachedPosts={};if(typeof volatileUserCacheData=="undefined"){var volatileUserCacheData={}}function reddit(a,b){this.database=a;this.user={friends:{},modlist:{},id:"guest",username:"",subscribed:{}};this.settings={};if(typeof b=="function"){b(this)}return this}reddit.prototype.base="http://www.reddit.com";reddit.prototype.jsonextension=".json?";reddit.prototype.crossDomain=false;reddit.prototype.loggedin=false;reddit.prototype.loggingIn=false;reddit.prototype.defaultSettings={load_all_comments_automatically:false,live_private_messages:true,live_notification_updates:true,show_desktop_notifications:true,visual_animations:false,macros_enabled:true,highlightNew:true,theme:"dark",postHoverOvers:true,subredditBar:true,enableFlair:true,NSFW:1,fontSize:13,defaultColumnWidth:300,textPreviewsEnabled:true,signature:"",backgrounds:["http://imgur.com/K3JyO","http://imgur.com/lWvky","http://imgur.com/BdnaD","http://imgur.com/OPsLD","http://imgur.com/zvj6t"],background:-1,backgroundStretched:true,historyToKeep:200,macros:{togglePopupsStay:nameToCode.cmdOrControl+",16",openSearch:nameToCode.cmdOrControl+",83",closePopup:"27",nextGalleryItem:"39",prevGalleryItem:"37",columnDropdown:"38",reply:nameToCode.cmdOrControl+",82",newThread:nameToCode.cmdOrControl+",71",messages:nameToCode.cmdOrControl+",69",openSidebar:nameToCode.cmdOrControl+",85",openSettings:nameToCode.cmdOrControl+",188",accounts:nameToCode.cmdOrControl+",68",goHome:nameToCode.cmdOrControl+",74",goBack:nameToCode.cmdOrControl+",37",goForward:nameToCode.cmdOrControl+",39",submit:nameToCode.cmdOrControl+",13",toggleScopeLeft:"65",toggleScopeRight:"68",toggleItemUp:"87",toggleItemDown:"83",upvote:"69",downvote:"81"}};reddit.prototype.loginActiveUser=function(b){var a=this;this.database.fetch("reddit_activeuser",function(c){if(typeof c!="undefined"){a.switchUser(c,function(){a.loggedin=true;if(typeof b=="function"){b(a)}})}else{a.loggedin=false;this.settings={};window.volatileUserCacheData={};if(typeof b=="function"){b(a)}}})};reddit.prototype.defaultSubs=["Reditr","funny","pics","aww","worldnews","politics","videos","gifs","todayilearned","iama","askreddit","music","movies","bestof","gaming","trees","technology","science","atheism","askscience","programming","books"];reddit.prototype.subs=function(b,c){var a="reddit_"+this.user.username+"_subs";if(typeof b=="function"){this.database.fetch(a,function(d){if(typeof d=="undefined"){d=reddit.prototype.defaultSubs}b(d)})}else{this.database.save(a,b);sync_update(self);if(typeof c=="function"){c()}}};reddit.prototype.tags=function(b,c){var a="reddit_"+this.user.username+"_tags";if(typeof b=="function"){self.database.fetch(a,function(d){if(typeof d=="undefined"){d={macmee:[{c:"#FFFFFF",b:"#FF0000",t:"Reditr Dev"}],kortank:[{c:"#FFFFFF",b:"#FF0000",t:"Reditr Dev"}]}}b(d)})}else{self.database.save(a,b);sync_update(self);if(typeof c=="function"){c()}}};reddit.prototype.setting=function(c,f,e){var b=this;var a="reddit_"+((this.loggedin)?this.user.username:"guest")+"_settings";var d=this.database;if(typeof f=="function"){if(typeof this.settings[c]!="undefined"){f(this.settings[c])}else{d.fetch(a,function(g){if(typeof g!="undefined"&&typeof g[c]!="undefined"){b.settings[c]=g[c]}else{b.settings[c]=b.defaultSettings[c]}f(b.settings[c])})}}else{d.fetch(a,function(g){b.settings[c]=f;if(typeof g!="undefined"){g[c]=f;d.save(a,g)}else{d.save(a,b.settings)}if(typeof e=="function"){e()}})}};reddit.prototype.removeUser=function(c,a,b){database.fetch("users",function(d){if(typeof d=="undefined"){d={}}delete d["reddit_"+c];database.save("users",d,function(){if(typeof b=="function"){b()}})})};reddit.prototype.switchUser=function(b,d){this.settings={};window.volatileUserCacheData={};var c=this.database;var a=this;c.fetch("reddit_"+b,function(e){c.save("reddit_activeuser",b);a.loggedin=true;if(typeof e=="undefined"){alert("There is a problem with the account you're trying to switch to. Please remove it and re-add it!");d(false);return}a.user=e;cookieManager.set("reddit_session",e.cookie.replace(/,/g,"%2C").replace(/:/g,"%3A"));setTimeout(function(){if(typeof d=="function"){d()}a.mine();a.me(function(f){if(f=="error"){a.loggedin=false;c.save("reddit_activeuser",undefined);c.fetch(a.user.username+"_session",function(h){if(typeof h=="undefined"||h==""){promptFancy("Please re-enter your password for account "+a.user.username,function(i){if(window.isMacgap||window.nodewebkit||window.microsoft){c.save(a.user.username+"_session",btoa(i))}if(!i){window.location.reload();return}g(i)},"password")}else{g(atob(h))}function g(i){a.login(a.user.username,i,function(j,k){if(k=="error"){if(j=="WRONG_PASSWORD"){alert("The password to your account "+a.user.username+" was incorrect!")}else{if(j=="RATELIMIT"){alert("Reddit has reported a rate limit error for your account "+a.user.username+". Please try logging in again in several minutes!")}}c.save(a.user.username+"_session","")}if(!window.microsoft){window.location.reload()}else{if(typeof d=="function"){d()}}})}});return}if(a.user.is_mod){a.modlist()}a.getFriends()})},200)})};reddit.prototype.updateCache=function(d,a,b){var c=cachedPosts[d];if(typeof c=="undefined"){return false}cachedPosts[d][a]=b;return true};var redditGetCache=reddit.prototype.getCache=function(c,a){var b=cachedPosts[c];return(typeof b=="undefined")?false:cachedPosts[c][a]};reddit.prototype.updateLocalStorageCache=function(g,d,h,i){var a=new Date();var e=new Date(a.getFullYear(),a.getMonth(),a.getDate()).getTime();var b=e+(h*86400000);var c="reddit_"+(this.loggedin)?this.user.username:"guest";var f=this.database;var j=false;f.fetch(c+"_cache",function(k){if(typeof k=="undefined"){k={}}if(typeof k[g]!="undefined"){j=k[g].expires}k[g]={contents:d,expires:b};f.save(c+"_cache",k);if(typeof i=="function"){i(k)}});f.fetch(c+"_cache_expires",function(k){if(typeof k=="undefined"){k={}}if(typeof k[b]=="undefined"){k[b]={}}if(j!=false){try{delete k[j][g]}catch(l){console.log("A local storage caching error has occured: ",l)}}k[b][g]=true;f.save(c+"_cache_expires",k)})};reddit.prototype.getLocalStorageCache=function(b,c){var a="reddit_"+(this.loggedin)?this.user.username:"guest";database.fetch(a+"_cache",function(d){if(typeof d=="undefined"||typeof d[b]=="undefined"){c({})}else{c(d[b].contents,d[b].expires)}})};reddit.prototype.purgeLocalStorageCache=function(){var a="reddit_"+(this.loggedin)?this.user.username:"guest";var b=Date.now();database.fetch(a+"_cache",function(c){database.fetch(a+"_cache_expires",function(g){for(var f in g){if(f<b){var d=g[f];for(var e in d){delete c[e]}delete g[f]}}database.save(a+"_cache",c);database.save(a+"_cache_expires",g)})})};reddit.prototype.userVariable=function(b,d){var c=this.database;var a="reddit_"+(this.loggedin)?this.user.username:"guest";c.fetch(a,function(e){if(typeof d=="function"){d((typeof e!="undefined")?e[b]:undefined);return}if(typeof e=="undefined"){e={}}e[b]=d;c.save(a,e)})};reddit.prototype.logout=function(a){cookieManager.remove("reddit_session");this.settings={};window.volatileUserCacheData={};this.loggedin=false;this.database.save("reddit_activeuser",undefined);this.user={friends:{},modlist:{},id:"guest",subscribed:{}};if(typeof a=="function"){a()}};reddit.prototype.login=function(f,c,e){f=f.toLowerCase();var b=this;var a=this.user;var d=this.database;if(this.loggingIn){if(typeof e=="function"){e("RUNNING")}return}this.loggingIn=true;$.post("https://ssl.reddit.com/api/login/"+f,{api_type:"json",user:f,passwd:c},function(l,m,j){var h=l.json;var k=j.responseText;if(h.errors.length){var i="ERROR";if(k.indexOf("RATELIMIT")!=-1){i="RATELIMIT"}else{if(k.indexOf("WRONG_PASSWORD")!=-1){i="WRONG_PASSWORD"}}if(typeof e=="function"){e(i,"error")}b.loggingIn=false}else{b.settings={};var g=h.data;database.fetch("users",function(n){if(typeof n=="undefined"){n={}}n["reddit_"+f]={username:f,type:"reddit"};database.save("users",n)});if(b.loggedin){database.fetch("reddit_activeuser",function(n){if(typeof n!="undefined"){b.logout(function(){b.switchUser(n)})}if(typeof e=="function"){e("SUCCESS_MULTIPLE",g)}});g.username=f;database.save("reddit_"+f,g);b.loggingIn=false;return}b.loggedin=true;cookieManager.set("reddit_session",g.cookie);b.me(function(){if(b.user.is_mod){b.modlist()}b.getFriends()});b.mine();database.fetch("reddit_"+f,function(n){if(typeof n!="undefined"){a=n}else{a.tabPage=1}});a.username=f;a.cookie=g.cookie;a.modhash=g.modhash;if(typeof a.friends=="undefined"){a.friends={}}if(typeof a.modlist=="undefined"){a.modlist={}}if(typeof a.id=="undefined"){a.id="guest"}if(typeof a.username=="undefined"){a.username=""}b.user=a;database.save("reddit_"+f,a);database.save("reddit_activeuser",f);if(typeof e=="function"){e("SUCCESS",g)}b.loggingIn=false}})};reddit.prototype.getFriends=function(){var a=this.user.friends={};$.getJSON("https://ssl.reddit.com/prefs/friends"+this.jsonextension,function(e){var d=e[0].data.children;var b=d.length;for(var c=0;c<b;c++){a[d[c].name]=d[c].id}})};reddit.prototype.me=function(c){if(!this.loggedin){if(typeof c=="function"){c("error")}return}var a=this.user;var b=this;$.getJSON(this.base+"/api/me"+this.jsonextension,function(e){var d=e.data;if(typeof d=="undefined"){cookieManager.remove("reddit_session");if(typeof c=="function"){c("error")}return}a.has_mail=d.has_mail;a.name=d.name;a.created=d.created;a.created_utc=d.created_utc;a.link_karma=d.link_karma;a.comment_karma=d.comment_karma;a.is_gold=d.is_gold;a.is_mod=d.is_mod;a.id=d.id;a.has_mod_mail=d.has_mod_mail;a.modhash=d.modhash;b.database.save("reddit_"+a.username,a);if(typeof c=="function"){c()}})};reddit.prototype.modlist=function(b){if(!this.loggedin){return false}var a=this.user.modlist={};$.getJSON(this.base+"/reddits/mine/moderator"+this.jsonextension,function(f){var d=f.data.children;var c=d.length;for(var e=0;e<c;e++){a[d[e].data.url.toLowerCase().replace(/\//g,"-")]=true}if(typeof b=="function"){b()}})};reddit.prototype.ismod=function(a){if(typeof this.user.modlist=="undefined"){return false}return(this.user.modlist[a.toLowerCase().replace(/\//g,"-")]==true)?true:false};reddit.prototype.isfriend=function(a){if(typeof this.user.friends=="undefined"){return false}return(typeof this.user.friends[a]!="undefined")?true:false};reddit.prototype.mine=function(c){var a=this;function b(d){d=d||"";$.getJSON(a.base+"/reddits/mine"+a.jsonextension,{limit:100,after:d},function(h){var f=(typeof h.data=="undefined")?[]:h.data.children;var j=a.user.subscribed={};var e=f.length;for(var g=0;g<e;g++){j[f[g].data.name]=true}if(typeof h.data!="undefined"&&h.data.after!=null){b(h.data.after)}else{if(typeof c=="function"){c((h!="")?f:"error")}}})}b()};reddit.prototype.getPosts=function(a,b,e,f,c){var b=b||0;var e=(e==null?"":e);a=a.replace(".json?",this.jsonextension);var d={count:b,after:e};if(c){d._=Date.now()}$.getJSON(this.base+a,d,function(k){if(!k.data){f([]);return}var h=k.data.children;f(h);var g=h.length;for(var j=0;j<g;j++){if(h[j].kind!="t1"){var k=h[j].data;cachedPosts[k.id]=k}}})};reddit.prototype.morecomments=function(d,c,e,b,f){var a=this.user;$.post(this.base+"/api/morechildren",{children:d,link_id:c,r:e,api_type:"json"},function(k){var h=k.json.data.things;if(h.length==0){f(false);return false}var p={};function g(t){var i={};var r=i.data={};var q=t.contentHTML;r.id=t.id.split("_").pop();r.name=t.id;r.body_html=q;r.parent_id=t.parent;r.replies=(t.replies==null)?p[r.name]={data:{children:[]}}:"";try{r.ups=t.content.match(/data-ups="(.*?)"/).pop()}catch(s){r.ups=0}try{r.downs=t.content.match(/data-downs="(.*?)"/).pop()}catch(s){r.downs=0}try{r.author=t.content.match(/\/user\/(.*?)"/).pop()}catch(s){return false}try{r.created_utc=Math.floor((new Date(t.content.match(/datetime="(.*?)"/).pop())).getTime()/1000)}catch(s){return false}if(q.indexOf("upmod")!=-1){r.likes=true}else{if(q.indexOf("downmod")!=-1){r.likes=false}else{r.likes=null}}return i}var j=[];var m=[];var o=h.length;for(var l=0;l<o;l++){var n=g(h[l].data);if(n){if(n.data.parent_id==b){j.push(n)}else{p[n.data.parent_id].data.children.push(n)}}}f(j)})};reddit.prototype.upvote=function(c,b){var a=this.getCache(c,"name");if(a===false){a="t1_"+c}this.updateCache(c,"likes",true);this.updateCache(c,"ups",this.getCache(c,"ups")+1);$.post(this.base+"/api/vote",{id:a,dir:1,uh:this.user.modhash},function(d){if(typeof d.jquery!=undefined){if(typeof b=="function"){b("success",d)}}})};reddit.prototype.downvote=function(c,b){var a=this.getCache(c,"name");if(a===false){a="t1_"+c}this.updateCache(c,"likes",false);this.updateCache(c,"downs",this.getCache(c,"downs")+1);$.post(this.base+"/api/vote",{id:a,dir:-1,uh:this.user.modhash},function(d){if(typeof d.jquery!=undefined){if(typeof b=="function"){b("success")}}})};reddit.prototype.remove=function(e,b,c,d){var a=this.getCache(e,"name");if(a===false){a=e}$.post(this.base+"/api/remove",{id:a,r:c,spam:b,uh:this.user.modhash},function(f){if(typeof d=="function"){d("success")}})};reddit.prototype.deletepost=function(d,b,c){var a=this.getCache(d,"name");if(a===false){a="t1_"+d}$.post(this.base+"/api/del",{id:a,r:b,uh:this.user.modhash},function(e){if(typeof c=="function"){c("success")}})};reddit.prototype.approve=function(a,b){$.post(this.base+"/api/approve",{id:a,uh:this.user.modhash},function(c){if(typeof b=="function"){b("success")}})};reddit.prototype.removevote=function(c,b){var a=this.getCache(c,"name");if(a===false){a="t1_"+c}$.post(this.base+"/api/vote",{id:a,dir:0,uh:this.user.modhash},function(d){if(typeof d.jquery!=undefined){if(typeof b=="function"){b("success")}}})};reddit.prototype.getpost=function(f,c,e,d){var b=cachedPosts[f];var a=(typeof b=="object")?true:false;if(a){e(b)}c=c.replace(".json?",this.jsonextension);$.getJSON(this.base+c,function(g){if(!a){b=cachedPosts[f]=g[0].data.children[0].data;e(b)}d(g[1].data.children)})};reddit.prototype.getcomments=function(b,a,c){$.getJSON(this.base+b+this.jsonextension+"&sort="+a,function(d){if(typeof c=="function"){c(d[1].data.children,d[0].data.children[0].data.num_comments)}})};reddit.prototype.subreddits=function(a,b){$.getJSON(this.base+"/reddits/"+a+this.jsonextension,function(d){var c=d.data.children;if(typeof b=="function"){b(c)}})};reddit.prototype.submit=function(a,b,c,f,d,g,h){var j={};var i=this;j.title=a;j.sr=c;j.kind=f;j.api_type="json";if(d!=null){j.iden=d}if(g!=null){j.captcha=g}if(j.kind=="self"){j.text=b}else{j.url=b}var e=this.user;j.uh=(typeof e!="undefined")?e.modhash:0;$.post(this.base+"/api/submit",j,function(n){var l=n.json;if(l.errors.length==0){var m=l.data.url;var k="noerror"}else{if(l.errors[0][0]=="BAD_CAPTCHA"){var m=l.captcha;var k=l.errors[0][0]}else{var m=l.errors[0][1];var k=l.errors[0][0]}}if(typeof h=="function"){h(k,m)}})};reddit.prototype.comment=function(a,c,b,d){$.ajax({type:"POST",url:this.base+"/api/comment",data:{r:c,thing_id:a,text:b,uh:this.user.modhash},success:function(g,i,h){var f=h.responseText;var e="SUCCESS";if(f.indexOf("you are doing that too much")!=-1){e="FREQUENCY"}if(typeof d=="function"){d(g,e)}},error:function(f,e){d(false,f.status)}})};reddit.prototype.hidepost=function(b,a){$.post(this.base+"/api/hide",{id:b,uh:this.user.modhash},function(c){if(typeof a=="function"){a("success")}})};reddit.prototype.unhidepost=function(b,a){$.post(this.base+"/api/unhide",{id:b,uh:this.user.modhash},function(c){if(typeof a=="function"){a("success")}})};reddit.prototype.report=function(b,a){$.post(this.base+"/api/report",{id:b,uh:this.user.modhash},function(c){if(typeof a=="function"){a("success")}})};reddit.prototype.deletePost=function(c,a,b){$.post(this.base+"/api/del",{id:c,uh:this.user.modhash,r:a,executed:"deleted"},function(d){if(typeof b=="function"){b("success")}})};reddit.prototype.editPost=function(c,a,b){$.post(this.base+"/api/editusertext",{thing_id:c,text:a,uh:this.user.modhash},function(f,i,h){var d;try{d=h.responseText.match(/"contentHTML": "([\s\S]*?)", /).pop();d=$("<div/>").html(d.replace(/\n/g,"")).text().replace(/(\\n)/g,"")}catch(g){d="error"}if(typeof b=="function"){b(a,d)}})};reddit.prototype.sidebar=function(b,c){var a=cachedPosts["sidebar_"+b];if(typeof a!="undefined"){if(typeof c=="function"){c(a)}}else{$.get(this.base+"/r/"+b,function(e){var d=(e.match(/<form action="#"[\s\S]*?form>/i)||[""]).pop();if(typeof toStaticHTML=="function"){d=toStaticHTML(d)}cachedPosts["sidebar_"+b]=d;if(typeof c=="function"){c(d)}})}};reddit.prototype.getModerators=function(d,e){var b=[];var a=[];if(typeof window.cachedPosts["mods_"+d]!="undefined"){var c=window.cachedPosts["mods_"+d];if(typeof e=="function"){e(c[0],c[1])}return}$.getJSON("http://www.reddit.com/r/"+d+"/about/moderators"+this.jsonextension,function(k){var f=k.data.children;var j=f.length;for(var h=0;h<j;h++){var g=f[h].name;a.push(g);b.push(g.toLowerCase())}window.cachedPosts["mods_"+d]=[a,b];if(typeof e=="function"){e(a,b)}})};reddit.prototype.siteadmin=function(a,b){a.uh=this.user.modhash;$.post(this.base+"/api/site_admin",a,function(c){if(typeof b=="function"){b()}})};reddit.prototype.addHistory=function(e,d,b){var c=window.volatileUserCacheData.history;var a=this;if(!c){this.database.fetch("reddit_"+this.user.username+"_history",function(f){if(!f){f=[]}else{if(f[0]&&f[0][0]==e){window.volatileUserCacheData.history=f;return false}}a.setting("historyToKeep",function(g){f.unshift([e,d,b]);if(f.length>g){f=f.splice(0,g)}a.database.save("reddit_"+a.user.username+"_history",f);window.volatileUserCacheData.history=f})})}else{if(c[0]&&c[0][0]==e){return false}c.unshift([e,d,b]);a.setting("historyToKeep",function(f){if(c.length>f){c=c.splice(0,f)}a.database.save("reddit_"+a.user.username+"_history",c);window.volatileUserCacheData.history=c})}};reddit.prototype.getHistory=function(b){var a=window.volatileUserCacheData.history;if(!a){this.database.fetch("reddit_"+this.user.username+"_history",function(c){if(!c){c=[]}window.volatileUserCacheData.history=c;if(typeof b=="function"){b(c)}})}else{if(typeof b=="function"){b(a)}}};reddit.prototype.clearHistory=function(a){window.volatileUserCacheData.history=[];this.database.save("reddit_"+this.user.username+"_history",[],function(){if(typeof a=="function"){a()}})};reddit.prototype.isCommentSaved=function(a,c){var b=window.volatileUserCacheData.favourites;if(!b){this.database.fetch("reddit_"+this.user.username+"_savedComments",function(d){if(!d){d={}}window.volatileUserCacheData.favourites=d;c(d[a]?true:false)})}else{c(b[a]?true:false)}};reddit.prototype.favouriteComments=function(b){var a=window.volatileUserCacheData.favourites;if(!a){this.database.fetch("reddit_"+this.user.username+"_savedComments",function(c){if(!c){c={}}window.volatileUserCacheData.favourites=c;b(c)})}else{b(a)}};reddit.prototype.saveComment=function(b,c){var a=this;this.database.fetch("reddit_"+this.user.username+"_savedComments",function(d){if(!d){d={}}d[b]=c;if(window.volatileUserCacheData.favourites){window.volatileUserCacheData.favourites[b]=c}else{window.volatileUserCacheData.favourites=d}a.database.save("reddit_"+a.user.username+"_savedComments",d,function(){sync_update(a)})})};reddit.prototype.unsaveComment=function(b){var a=this;this.database.fetch("reddit_"+this.user.username+"_savedComments",function(c){if(!c){c={}}delete c[b];if(window.volatileUserCacheData.favourites){delete window.volatileUserCacheData.favourites[b]}else{window.volatileUserCacheData.favourites=c}a.database.save("reddit_"+a.user.username+"_savedComments",c,function(){sync_update(a)})})};reddit.prototype.savePost=function(a,b){cachedPosts[a.substr(3,a.length)].saved=true;$.post(this.base+"/api/save",{id:a,executed:"saved",uh:this.user.modhash},function(c){if(typeof b=="function"){b()}})};reddit.prototype.unsavePost=function(a,b){cachedPosts[a.substr(3,a.length)].saved=false;$.post(this.base+"/api/unsave",{id:a,executed:"unsaved",uh:this.user.modhash},function(c){if(typeof b=="function"){b()}})};reddit.prototype.friend=function(c,a,d){var b=this;d=d||a;c.uh=b.user.modhash;$.post(this.base+"/api/friend",c,function(e){if(c.type=="friend"){b.user.friends[c.name]=e.jquery[29][3][0][0].id}if(typeof d=="function"){d(e.jquery,a)}})};reddit.prototype.unfriend=function(b,c){var a=this;b.uh=a.user.modhash;$.post(this.base+"/api/unfriend",b,function(){if(b.type=="friend"){delete a.user.friends[b.name]}if(typeof c=="function"){c()}})};reddit.prototype.getUser=function(c,b){var a=this;$.ajax({url:a.base+"/user/"+c+"/about.json?"+a.jsonextension,dataType:"json",data:{},success:function(e){var d={user:e.data};a.trophies(c,function(f){d.trophies=f;if(typeof b=="function"){b(d)}})},error:function(d){if(typeof b=="function"){b(false)}}})};reddit.prototype.trophies=function(a,c){var b=cachedPosts["trophies_"+a];if(typeof b!="undefined"){if(typeof c=="function"){c(b)}}else{$.get(this.base+"/user/"+a,function(e){var d=(e.match(/<table class="trophy\-table"[\s\S]*?table>/i)||[""]).pop();cachedPosts["trophies_"+a]=d;if(typeof c=="function"){c(d)}})}};reddit.prototype.saveColumns=function(a){this.database.save("reddit_"+this.user.username+"_columns",a);sync_update(this)};reddit.prototype.savedColumns=function(a){this.database.fetch("reddit_"+this.user.username+"_columns",a)};reddit.prototype.getModContent=function(b,a,c){$.getJSON(this.base+a+"about/"+b+".json",function(d){if(typeof c=="function"){c(d)}})};reddit.prototype.getSingleComment=function(c,b,d){var a=this.base+c+b+".json";$.getJSON(a,function(e){d(e[1].data.children[0].data)})};reddit.prototype.subscribe=function(a){$.post(this.base+"/api/subscribe",{uh:this.user.modhash,action:"sub",sr:a});this.user.subscribed[a]=true};reddit.prototype.unsubscribe=function(a){$.post(this.base+"/api/subscribe",{uh:this.user.modhash,action:"unsub",sr:a});this.user.subscribed[a]=false};reddit.prototype.issubscribed=function(b,c){var a=this;if(typeof c=="function"){this.subredditAbout(b,function(d){c((a.user.subscribed[d.name]==true)?true:false,d.name,b)});return}return(this.user.subscribed[b]==true)?true:false};reddit.prototype.subredditAbout=function(b,c){if(typeof cachedPosts["about_"+b]!="undefined"){c(cachedPosts["about_"+b]);return}var a=this;$.get(this.base+"/r/"+b+"/about"+this.jsonextension,function(d){c(d.data);cachedPosts["about_"+b]=d.data})};reddit.prototype.searchRedditNames=function(a,b){$.post(this.base+"/api/search_reddit_names"+this.jsonextension,{uh:this.user.modhash,query:a},function(c){b(c.names)})};reddit.prototype.searchForSubreddit=function(a,b){$.get(this.base+"/api/subreddits_by_topic"+this.jsonextension,{query:a},function(c){b(c)})};reddit.prototype.randomSubreddit=function(b){var a=this;$.get(this.base+"/r/random",function(c){var d=c.match(/\/r\/(.*?)\/\.rss/).pop();a.subredditExists(d,function(e){if(e){b(d)}else{a.randomSubreddit(b)}})})};reddit.prototype.edituserpost=function(a,b){$.post(this.base+"/api/editusertext",a,function(d){var c=d.jquery[11][3][0][0].data.content;c=c.match(/class="md"&gt;([\s\S]*?)&lt;\/div&gt;/g).pop();if(typeof b=="function"){b(c)}})};reddit.prototype.getMessage=function(b,a){$.getJSON(this.base+"/message/messages/"+b+".json",function(c){try{a(c)}catch(d){}})};reddit.prototype.markUnread=function(a){$.post(this.base+"/api/unread_message",{uh:this.user.modhash,id:a})};reddit.prototype.markRead=function(b,f){if(typeof b=="object"){var d=b.length;var e=0;function a(){if(++e==d){f()}}for(var c=0;c<d;c++){this.markRead(b[c],function(){a()})}return}$.post(this.base+"/api/read_message",{uh:this.user.modhash,id:b},function(){if(typeof f=="function"){f()}})};reddit.prototype.messageReply=function(a,b,c){$.post(this.base+"/api/comment",{uh:this.user.modhash,thing_id:a,text:b,id:"#commentreply_"+a},function(d,i,h){if(typeof c!="undefined"){try{var f=decodeURIComponent($("<div />").html(h.responseText.match(/&lt;!\-\- SC_OFF \-\-&gt;(.*?)&lt;!\-\- SC_ON \-\-&gt;/).pop()).text());c(f)}catch(g){c(false)}}})};reddit.prototype.sendMessage=function(f,d,c,b,a,e){$.post(this.base+"/api/compose",{api_type:"json",uh:this.user.modhash,to:f,subject:d,thing_id:"",text:c,id:"#compose-message",iden:b,captcha:a},function(j){var h=j.json;if(h.errors.length==0){var i="";var g="noerror"}else{if(h.errors[0][0]=="BAD_CAPTCHA"){var i=h.captcha;var g=h.errors[0][0]}else{var i=h.errors[0][1];var g=h.errors[0][0]}}if(typeof e=="function"){e(g,i)}})};var alreadyFlairStyle={};reddit.prototype.buildFlairCSS=function(c,d){if(!c){if(typeof d=="function"){d()}return}c=c.toLowerCase();var b=this.base;if(alreadyFlairStyle[c]||!c){if(typeof d=="function"){d()}return}alreadyFlairStyle[c]=true;var a=this;$.get(b+"/r/"+c,function(g){var e=g.match(/subreddit\-stylesheet\/(.*?)\.css/);var h=1;if(e!=null){var f="http://www.redditstatic.com/subreddit-stylesheet/"+e[1]+".css"}else{e=g.match(/stylesheet\.css\?v=(.*?)/);if(e==null||e.length==0){if(typeof d=="function"){d()}return}else{var f=b+"/r/"+c+"/stylesheet.css?v="+e[1];h=2}}$.get(f,function(j){if(h==2){j=j.replace(/\.flair \{/g,".flair{");j=j.replace(/(\r\n|\n|\r)/gm,"");j=j.replace(/\/\*([\s\S]*?)\*\//gm,"")}var k="";var i=j.match(/\.res\-nightmode \.flair{(.*?)}/g);if(i!=null&&i.length>0){k=i.join("").replace(/\.res-nightmode \.flair/,".darkTheme ."+c+".flair");j=j.replace(/\.res-nightmode \.flair/,"NO")}delete i;var i=j.replace(/{/g,"{\n").replace(/}/g,"}\n").match(/\.(.*?)flair(.*?){([\s\S]*?)}/g);if(i!=null&&i.length>0){k+=i.join("").replace(/\.flair/g,"."+c+".flair")}if(typeof toStaticHTML=="function"){k=toStaticHTML(k)}$("head").append("<style>"+k+"</style>");if(typeof d=="function"){d()}})})};reddit.prototype.fetchFlairHTML=function(c,e){c=c.toLowerCase();var b=0;var a="";this.buildFlairCSS(c,function(){b++;d()});$.post(this.base+"/api/flairselector",{uh:this.user.modhash,r:c,name:""},function(f){f=f.replace(/<(form|h2)([\s\S]*?)(form|h2)>/gi,"");a=f;b++;d()});function d(){if(b>1){e(a)}}};reddit.prototype.setNewFlair=function(c,d,a){this.toggleFlairEnabled(c,true);var b={subRedditStyleCheckbox:"on",flair_enabled:"on",name:this.user.name,flair_template_id:d,r:c,uh:this.user.modhash};if(typeof a!="undefined"&&a!=""){b.text=a}$.post(this.base+"/api/selectflair",b)};reddit.prototype.subredditExists=function(a,b){if(a==""){return false}$.getJSON(this.base+"/r/"+a+"/about"+this.jsonextension,function(c){b(true)}).error(function(){b(false)})};reddit.prototype.toggleFlairEnabled=function(c,a){console.log(c,a);var b={id:"",r:c,uh:this.user.modhash};if(a){b.flair_enabled="on"}$.post(this.base+"/api/setflairenabled",b)};var shameful_popup_zindex=100000;(function(a){a.popup=function(l,j){var k=(typeof l.id=="undefined")?Date.now():l.id;var c=a(".complexAlertBackdrop");if(!c.length){var c=a('<div class="complexAlertBackdrop" style="z-index: '+(window.shameful_popup_zindex++)+'"></div>').appendTo("body");setTimeout(function(){c.addClass("animate")},10);var i='<i class="icon-remove"></i><span>&nbsp;&nbsp;Close</span>'}var g=a(".complexAlertContainer");if(g.length){g.hide();var i='<i class="icon-arrow-left"></i><span>&nbsp;&nbsp;Back</span>'}var b=l.sidebar?'<div class="sidebar"><div class="contentContainer"><div class="content">'+l.sidebar+"</div></div></div>":"";var f=(l.menubar!=false)?("<div class='alertOptions'>"+((typeof l.buttons!="undefined")?l.buttons.replace(/\[suggestedCloseText\]/g,i):'<button data-message="close">'+i+"</button>")+"<div style='clear: both'></div></div>"):"";var e=a("<div class='complexAlertContainer' id='"+k+"' style='position: fixed; top: 0; bottom: 0; left: 0; right: 0; z-index: "+(window.shameful_popup_zindex++)+"'> 								  <div style='position: relative; width: 100%; height: 100%'> 									  <table class='complexAlert'> 										<tr valign='middle'> 											<td style='text-align: center;'> 												<div class='container'> 													<div class='alert'> 														"+((typeof l.title!="undefined")?"<div class='alertTitle'>"+l.title+"</div>":"")+" 														<div class='alertText content canscroll'>"+l.message+"</div> 														"+f+" 													</div> 													"+b+" 												</div> 											</td> 										</tr> 									</table> 								</div> 							</div>").prependTo("body");var h=e.find(".complexAlert");setTimeout(function(){h.addClass("animate")},a('head link[href*="css/stylesheet_blockanimations.css"]').length?1:200);var d=h.find(".content").first();a(window).resize(function(){d.css({"max-height":a(this).height()-100})}).trigger("resize");e.on("click",".complexAlert",function(m){m.stopPropagation();e.find('[data-message="close"]').click()});e.on("click",".complexAlert .container",function(m){m.stopPropagation()});e.find("input, textarea").first().focus();if(typeof j=="function"){e.on("click","*:not(input)[data-message]",function(m){var n=j.call(e,a(this).attr("data-message"),a(this),m);if(n=="close"){e.closePopup()}});e.on("keypress","*[data-message]",function(m){if(m.keyCode==13){var n=j.call(e,a(this).attr("data-message"),a(this));if(n=="close"){e.closePopup()}}})}return e};a.fn.closePopup=function(d){if(d){a(".complexAlertContainer, .complexAlertBackdrop").remove();return}var c=a(this);var e=c.find(".complexAlert");var b=a(".complexAlertBackdrop");c.off();e.removeClass("animate");setTimeout(function(){c.remove();var f=a(".complexAlertContainer");if(f.length){f.last().show()}else{b.remove()}},200)}})(jQuery);function promptFancy(d,f,c,b){if(c=="subreddit"){c="text";var h=true}var j="promptFancyInput"+Date.now();b=(typeof b=="undefined")?"":b;var i='<button class="right green" data-message="add"><i class="icon-ok"></i><span>&nbsp;&nbsp;Done</span></button> 				   <button class="left" data-message="close">[suggestedCloseText]</button>';var l='<div class="incontainer"><input style="margin-bottom: 0px" type="'+((typeof c!="undefined")?c:"text")+'" data-message="add" id="'+j+'" value="'+b+'"></div><div id="addSubreddit_results"></div>';var g;var k;g=$.popup({id:"promptFancy",title:d,message:l,buttons:i},function(n,m){if(n=="subreddit_item"){k.val(m.html()).focus().select();return}n=(n=="close")?false:$("#"+j).val();g.closePopup();setTimeout(function(){f(n)},250)});if(h){var a=window.connection;var e=g.find("#addSubreddit_results");k=g.find("input");k.doneTyping(function(){var m=k.val().toLowerCase().replace(/(\/r\/|r\/)/,"");k.addClass("loading");a.searchRedditNames(m,function(q){e.find("div:not(.selected)").remove();if(q.length!=0){e.append('<div data-message="subreddit_item">'+q.join('</div><div data-message="subreddit_item">')+"</div>")}var o=false;var n=q.length;for(var p=0;p<n;p++){if(m==q[p].toLowerCase()){o=true}}k.removeClass("loading");if(!o){a.subredditExists(m,function(r){if(r){e.append('<div data-message="subreddit_item">'+capitalize(m)+"</div>")}})}})})}}function confirmFancy(d,c){var b='<button class="right green" data-message="confirm"><i class="icon-ok"></i><span>&nbsp;&nbsp;Confirm</span></button> 				   <button class="left" data-message="close">[suggestedCloseText]</button>';var a;a=$.popup({message:d,buttons:b},function(e){a.closePopup();setTimeout(function(){c(e=="confirm"?true:false)},250)})}function modtools(c,b){var a=this;this.subreddit=c;this.connection=b;this.viewport="<div class='Viewport'> 		<div class='leftView'> 			<div href='edit' class='item'>community settings</div> 			<div href='moderators' class='item'>edit moderators</div> 			<div href='contributors' class='item'>edit approved submitters</div> 			<div href='traffic' class='item'>traffic stats</div> 			<div href='modqueue' class='item'>moderation queue</div> 			<div href='reports' class='item'>reported links</div> 			<div href='spam' class='item'>spam</div> 			<div href='banned' class='item'>ban users</div> 			<div href='unmoderated' class='item'>unmoderated links</div> 		</div> 		<div class='rightView'> 			<div class='loadingcss block'></div> 		</div> 	</div>";this.startup(function(){a.bindings()});return this}modtools.prototype.startup=function(b){var a=this;a.content=$.popup({id:"modpopup",title:a.subreddit+" Mod Tools",message:a.viewport,buttons:'<div id="optionButtons" class="buttongroup"><button class="Button" id="close" data-message="close">[suggestedCloseText]</button></div>'},function(k){if(k=="save_community_settings"){var c=a.subreddit.replace("/r/","").replace("/","");var d={allow_top:$("#allow_top").is(":checked")?true:false,description:$(".info #sidebar").val(),lang:$("#lang").find("option:checked").val(),link_type:$('input:checked[name="srcontent"]').val(),over_18:$("#over_18").is(":checked")?true:false,public_description:$("#description").val(),show_media:$("#show_media").is(":checked")?true:false,sr:a.subredditname,title:$("#title").val(),type:$('input[name="srtype"]:checked').val(),"header-title":$("#header_hover_text").val(),r:c,sr:a.id,wiki_edit_age:$("#wiki_edit_age").val(),wiki_edit_karma:$("#wiki_edit_karma").val(),wikimode:$('input:checked[name="wikimode"]').val()};a.connection.siteadmin(d,function(){a.home()})}if(k=="goback"){a.home()}if(k=="addMod"){var j=a.content.find("input#modName").val();var c=a.subreddit.replace("/r/","").replace("/","");if(j==""){return}var d={container:a.subredditname,name:j,type:"moderator",r:c};a.connection.friend(d,function(m){var l=m[29][3][0][0].id;a.content.find(".modlist").append('<div class="mod">'+j+' - <a id="'+l+'" class="removeMod">remove</a></div>')})}if(k=="cancelRemoveMod"){var h=a.content.find("input#selectMod").val();a.content.find("a#"+h).addClass("removeMod").text("remove")}if(k=="removeMod"){var h=a.content.find("input#selectMod").val();var c=a.subreddit.replace("/r/","").replace("/","");var d={container:a.subredditname,id:h,type:"moderator",r:c};a.content.find("a#"+h).parent().fadeOut(350);a.connection.unfriend(d)}if(k=="addCont"){var f=a.content.find("input#contName").val();var c=a.subreddit.replace("/r/","").replace("/","");if(f==""){return}var d={container:a.subredditname,name:f,type:"contributor",r:c};a.connection.friend(d,function(m){var l=m[29][3][0][0].id;a.content.find(".contlist").append('<div class="cont">'+f+' - <a id="'+l+'" class="removeCont">remove</a></div>')})}if(k=="cancelRemoveCont"){var g=a.content.find("input#selectCont").val();a.content.find("a#"+g).addClass("removeCont").text("remove")}if(k=="removeCont"){var g=a.content.find("input#selectCont").val();var c=a.subreddit.replace("/r/","").replace("/","");var d={container:a.subredditname,id:g,type:"contributor",r:c};a.content.find("a#"+g).parent().fadeOut(350);a.connection.unfriend(d)}if(k=="addBan"){var i=a.content.find("input#banName").val();var c=a.subreddit.replace("/r/","").replace("/","");if(i==""){return}var d={container:a.subredditname,name:i,type:"banned",r:c};a.connection.friend(d,function(m){var l=m[29][3][0][0].id;a.content.find(".banlist").append('<div class="ban">'+i+' - <a id="'+l+'" class="removeBan">remove</a></div>')})}if(k=="cancelRemoveBan"){var e=a.content.find("input#selectBan").val();a.content.find("a#"+e).addClass("removeBan").text("remove")}if(k=="removeBan"){var e=a.content.find("input#selectBan").val();var c=a.subreddit.replace("/r/","").replace("/","");var d={container:a.subredditname,id:e,type:"banned",r:c};a.content.find("a#"+e).parent().fadeOut(350);a.connection.unfriend(d)}return k});a.home();a.content.on("click","a.time",function(){$(this).addClass("loading")});if(typeof b=="function"){b()}};modtools.prototype.bindings=function(a){var b=this;var a=false||a;if(a){}b.content.find(".leftView").on("click.modtools",".item",function(g){var c=$(this).attr("href");var f=b.content.find(".rightView");var d="";f.html('<div class="loadingcss block"></div>');b.grabContent.call(b,c,function(e){if(c=="edit"){d=b.communitySettings(e)}else{if(c=="message/inbox"){}else{if(c=="moderators"){d=b.editModerators(e)}else{if(c=="contributors"){d=b.editContributors(e)}else{if(c=="traffic"){d=b.trafficStats(e)}else{if(c=="modqueue"){d=b.modqueue(e)}else{if(c=="reports"){d=b.reportedlinks(e)}else{if(c=="spam"){d=b.spamlinks(e)}else{if(c=="banned"){d=b.bannedusers(e)}else{if(c=="unmoderated"){d=b.unmoderatedlinks(e)}}}}}}}}}}f.html(d).find("textarea").autoHeight()})});b.content.find(".rightView").on("click.modtools",".item",function(g){var c=$(this).attr("href");var f=b.content.find(".rightView");var d="";f.html('<div class="loadingcss block"></div>');b.grabContent.call(b,c,function(e){if(c=="edit"){d=b.communitySettings(e)}else{if(c=="moderators"){d=b.editModerators(e)}else{if(c=="contributors"){d=b.editContributors(e)}else{if(c=="traffic"){d=b.trafficStats(e)}else{if(c=="modqueue"){d=b.modqueue(e)}else{if(c=="reports"){d=b.reportedlinks(e)}else{if(c=="spam"){d=b.spamlinks(e)}else{if(c=="banned"){d=b.bannedusers(e)}else{if(c=="unmoderated"){d=b.unmoderatedlinks(e)}}}}}}}}}f.html(d).find("textarea").autoHeight()})})};modtools.prototype.grabContent=function(b,c){var a=this;a.connection.getModContent(b,a.subreddit,function(d){if(typeof c=="function"){c(d)}})};modtools.prototype.home=function(){var a=this;var c=Date.now();var b='<button class="Button" data-message="close">Close</button>';a.content.find("#optionButtons").html(b);var e=a.content.find(".rightView");var d='<div class="info"> 		<div href="edit" id="communitysettings" class="item">Settings</div> 		<div href="traffic" id="stats" class="item">Traffic</div> 		<div href="message/inbox" id="modmail" class="item">Mod Mail</div> 		<div href="modqueue" id="modqueue" class="item">Modqueue</div> 	</div>';e.html(d)};modtools.prototype.communitySettings=function(c){var i=this;var a=c.data;i.id=a.subreddit_id;var d='<button class="Button" data-message="close">Close</button><button class="Button time" data-message="goback">Go Back</button><button class="Button time" data-message="save_community_settings">Save Options</button>';i.content.find("#optionButtons").html(d);var b=$('<select id="lang" name="lang"><option value="ar">&#1575;&#1604;&#1593;&#1585;&#1576;&#1610;&#1577; [ar] (*)</option><option value="be">&#1041;&#1077;&#1083;&#1072;&#1088;&#1091;&#1089;&#1082;&#1072;&#1103; &#1084;&#1086;&#1074;&#1072; [be] (*)</option><option value="bg">&#1073;&#1098;&#1083;&#1075;&#1072;&#1088;&#1089;&#1082;&#1080; &#1077;&#1079;&#1080;&#1082; [bg] (*)</option><option value="ca">catal&#224; [ca] (*)</option><option value="cs">&#269;esky [cs]</option><option value="da">dansk [da] (*)</option><option value="de">Deutsch [de]</option><option value="el">&#917;&#955;&#955;&#951;&#957;&#953;&#954;&#940; [el]</option><option value="en">English [en]</option><option value="eo">Esperanto [eo]</option><option value="es">espa&#241;ol [es]</option><option value="et">eesti keel [et] (*)</option><option value="eu">Euskara [eu]</option><option value="fa">&#1601;&#1575;&#1585;&#1587;&#1740; [fa] (*)</option><option value="fi">suomi [fi]</option><option value="fr">fran&#231;ais [fr]</option><option value="he">&#1506;&#1489;&#1512;&#1497;&#1514; [he] (*)</option><option value="hi">&#2350;&#2366;&#2344;&#2325; &#2361;&#2367;&#2344;&#2381;&#2342;&#2368; [hi] (*)</option><option value="hr">hrvatski [hr]</option><option value="hu">Magyar [hu] (*)</option><option value="hy">&#1344;&#1377;&#1397;&#1381;&#1408;&#1381;&#1398; &#1388;&#1381;&#1382;&#1400;&#1410; [hy] (*)</option><option value="id">Bahasa Indonesia [id] (*)</option><option value="is">&#237;slenska [is] (*)</option><option value="it">italiano [it]</option><option value="ja">&#26085;&#26412;&#35486; [ja] (*)</option><option value="ko">&#54620;&#44397;&#50612; [ko] (*)</option><option value="la">Latin [la] (*)</option><option value="lt">lietuvi&#371; kalba [lt] (*)</option><option value="lv">latvie&#353;u valoda [lv] (*)</option><option value="nl">Nederlands [nl]</option><option value="no">Norsk [no]</option><option value="pl">polski [pl]</option><option value="pt">portugu&#234;s [pt]</option><option value="ro">rom&#226;n&#259; [ro] (*)</option><option value="ru">&#1088;&#1091;&#1089;&#1089;&#1082;&#1080;&#1081; [ru]</option><option value="sk">sloven&#269;ina [sk] (*)</option><option value="sl">sloven&#353;&#269;ina [sl] (*)</option><option value="sr">&#1089;&#1088;&#1087;&#1089;&#1082;&#1080; &#1112;&#1077;&#1079;&#1080;&#1082; [sr]</option><option value="sv">Svenska [sv] (*)</option><option value="ta">&#2980;&#2990;&#3007;&#2996;&#3021; [ta] (*)</option><option value="th">&#3616;&#3634;&#3625;&#3634;&#3652;&#3607;&#3618; [th] (*)</option><option value="tr">T&#252;rk&#231;e [tr]</option><option value="uk">&#1091;&#1082;&#1088;&#1072;&#1111;&#1085;&#1089;&#1100;&#1082;&#1072; &#1084;&#1086;&#1074;&#1072; [uk] (*)</option><option value="vi">Ti&#7871;ng Vi&#7879;t [vi] (*)</option><option value="zh">&#20013;&#25991; [zh] (*)</option></select>');b.find("option[value="+a.language+"]").attr("selected","selected");var f='<input id="public_type" '+(a.subreddit_type=="public"?"checked":"")+' type="radio" name="srtype" value="public" /><label for="public_type">public</label>	<input id="restricted_type" '+(a.subreddit_type=="restricted"?"checked":"")+' type="radio" name="srtype" value="restricted" /><label for="restricted_type">restricted</label>	<input id="private_type" '+(a.subreddit_type=="private"?"checked":"")+' type="radio" name="srtype" value="private" /><label for="private_type">private</label>';var e='<input id="any_type" '+(a.content_options=="any"?"checked":"")+' type="radio" name="srcontent" value="any" /><label for="any_type">any</label>	<input id="link_type" '+(a.content_options=="link"?"checked":"")+' type="radio" name="srcontent" value="link" /><label for="link_type">links only</label>	<input id="self_type" '+(a.content_options=="self"?"checked":"")+' type="radio" name="srcontent" value="self" /><label for="self_type">text posts only</label>';var h='<input id="over_18" type="checkbox" '+(a.over_18?"checked":"")+' /><label for="over_18">viewers must be over eighteen years old</label><br />	<input id="allow_top" '+(a.default_set?"checked":"")+' type="checkbox" /><label for="allow_top">allow this reddit to be shown in the default set</label><br />	<input id="show_media" '+(a.show_media?"checked":"")+' type="checkbox" /><label for="show_media">show thumbnail images of content</label>';var j='<input value="disabled" name="wikimode" id="wikimode_disabled" type="radio" '+(a.wikimode=="disabled"?"checked":"")+' /><label for="wikimode_disabled">disabled</label>	<input value="modonly" name="wikimode" id="wikimode_modonly" '+(a.wikimode=="modonly"?"checked":"")+' type="radio" /><label for="modonly">mod editing</label>	<input value="anyone" name="wikimode" id="wikimode_anyone" '+(a.wikimode=="anyone"?"checked":"")+' type="radio" /><label for="anyone">anyone</label>';var g='<div class="info">		<h3>title</h3>		<input type="text" value="'+a.title+'" id="title" />		<h3>public description</h3>		<textarea type="text" id="description">'+a.public_description+'</textarea>		<h3>sidebar</h3>		<textarea type="text" id="sidebar">'+a.description+"</textarea>		<h3>language</h3>		"+$("<div />").html(b).html()+"		<h3>type</h3>		"+f+"		<h3>content options</h3>		"+e+"		<h3>wiki</h3>		"+j+'		<h4>Subreddit karma required to edit wiki</h4> 		<input type="text" value="'+a.wiki_edit_karma+'" id="wiki_edit_karma" />		<h4>Account age required to edit wiki</h4> 		<input type="text" value="'+a.wiki_edit_age+'" id="wiki_edit_age" />		<h3>other options</h3>		'+h+'		<h3>header mouseover text</h3>		<input type="text" value="'+a.header_hover_text+'" id="header_hover_text" />	</div>';return g};modtools.prototype.editModerators=function(h){var c=this;var g=h.data.children;var d='<button class="Button" data-message="close">Close</button><button class="Button time" data-message="goback">Go Back</button>';c.content.find("#optionButtons").html(d);var b=[];var a="";for(var e in g){a=(c.connection.user.username==g[e].name?"</div>":' - <a id="'+g[e].id+'" class="removeMod">remove</a></div>');b.push('<div class="mod">'+g[e].name+a)}c.content.on("click.edit",".removeMod",function(){$("#selectMod").val($(this).attr("id"));$(this).removeClass("removeMod").html('Are you sure?  <a data-message="removeMod" data-ignore="true">Yes</a> / <a data-message="cancelRemoveMod" data-ignore="true">No</a>')});var f='<div class="info"> 		<h3>Add Moderator</h3> 		<input class="short" type="text" id="modName" /> 		<a data-message="addMod" class="Button rightInput">Add</a> 		<h3>Moderators</h3> 		<div class="modlist"> 		'+b.join("")+' 		</div> 		<input type="hidden" id="selectMod" value="" /> 	</div>';return f};modtools.prototype.editContributors=function(h){var b=this;var d=h.data.children;var c='<button class="Button" data-message="close">Close</button><button class="Button time" data-message="goback">Go Back</button>';b.content.find("#optionButtons").html(c);var g=[];var a="";for(var e in d){a=(b.connection.user.username==d[e].name?"</div>":' - <a id="'+d[e].id+'" class="removeCont">remove</a></div>');g.push('<div class="cont">'+d[e].name+a)}b.content.on("click.edit",".removeCont",function(){$("#selectCont").val($(this).attr("id"));$(this).removeClass("removeCont").html('Are you sure?  <a data-message="removeCont" data-ignore="true">Yes</a> / <a data-message="cancelRemoveCont" data-ignore="true">No</a>')});var f='<div class="info"> 		<h3>Add Submitter</h3> 		<input class="short" type="text" id="contName" /> 		<a data-message="addCont" class="Button rightInput">Add</a> 		<h3>Submitters</h3> 		<div class="contlist"> 		'+g.join("")+' 		</div> 		<input type="hidden" id="selectCont" value="" /> 	</div>';return f};modtools.prototype.trafficStats=function(h){var q=this;var m=h.day;var k=h.month;var e=h.hour;var j='<button class="Button" data-message="close">Close</button><button class="Button time" data-message="goback">Go Back</button>';q.content.find("#optionButtons").html(j);var n=[],c=[],b=[],a=[],p=[],l=[],g=[];for(var f in m){var d=m[f][0]*1000;n.push([d,m[f][1]]);c.push([d,m[f][2]]);b.push([d,m[f][3]])}for(var f in k){var d=k[f][0]*1000;a.push([d,k[f][1]]);p.push([d,k[f][2]])}for(var f in e){var d=e[f][0]*1000;l.push([d,e[f][1]]);g.push([d,e[f][2]])}var o=$('<div id="trafficStats" class="info"> 		<div class="plotSection"> 		<h3>Month Uniques <a class="Button">Show</a> 		<div class="plotHolder"><div class="plot" style="width:350px;height:200px;" id="monthu"></div></div> 		</div> 		<div class="plotSection"> 		<h3>Month Page Views <a class="Button">Show</a> 		<div class="plotHolder"><div class="plot" style="width:350px;height:200px;" id="monthpv"></div></div> 		</div> 		<div class="plotSection"> 		<h3>Day Uniques <a class="Button">Show</a> 		<div class="plotHolder"><div class="plot" style="width:350px;height:200px;" id="dayu"></div></div> 		</div> 		<div class="plotSection"> 		<h3>Day Page Views <a class="Button">Show</a> 		<div class="plotHolder"><div class="plot" style="width:350px;height:200px;" id="daypv"></div></div> 		</div> 		<div class="plotSection"> 		<h3>Day Subscribers <a class="Button">Show</a> 		<div class="plotHolder"><div class="plot" style="width:350px;height:200px;" id="daysb"></div></div> 		</div> 		<div class="plotSection"> 		<h3>Hour Uniques <a class="Button">Show</a> 		<div class="plotHolder"><div class="plot" style="width:350px;height:200px;" id="houru"></div></div> 		</div> 		<div class="plotSection"> 		<h3>Hour Page Views <a class="Button">Show</a> 		<div class="plotHolder"><div class="plot" style="width:350px;height:200px;" id="hourpv"></div></div> 		</div> 	</div>');o.on("click.stats","a",function(){if($(this).text()=="Show"){$(this).text("Hide").next(".plotHolder").show()}else{$(this).text("Show").next(".plotHolder").hide()}});$.plot(o.find("#dayu"),[n],{xaxis:{mode:"time"}});$.plot(o.find("#daypv"),[c],{xaxis:{mode:"time"}});$.plot(o.find("#daysb"),[b],{xaxis:{mode:"time"}});$.plot(o.find("#monthu"),[{data:a,color:"#FF0000"}],{xaxis:{mode:"time"}});$.plot(o.find("#monthpv"),[{data:p,color:"#FF0000"}],{xaxis:{mode:"time"}});$.plot(o.find("#houru"),[{data:l,color:"#228b22"}],{xaxis:{mode:"time"}});$.plot(o.find("#hourpv"),[{data:g,color:"#228b22"}],{xaxis:{mode:"time"}});return o};modtools.prototype.modqueue=function(d){var m=this;var l=d.data.children;var k=[];var f='<button class="Button" data-message="close">Close</button><button class="Button time" data-message="goback">Go Back</button>';m.content.find("#optionButtons").html(f);var g="link";var a=0;var h="";var e="";var b="";for(var c=0;c<l.length;c++){if(l[c].kind=="t1"){g="comment";a=l[c].data.ups-l[c].data.downs;h=l[c].data.link_title;e=$("<div />").html(l[c].data.body_html).text()}else{if(l[c].kind=="t3"){g="link";a=l[c].data.score;h=l[c].data.title;e=""}}b="";if(l[c].data.likes==true){b="Likes"}else{if(l[c].data.likes==false){b="DisLikes"}}k.push('<div href="'+l[c].data.permalink+'" data-postid="'+l[c].data.name+'" class="Post"> 			<div class="Voting"><div class="upVote '+b+'"></div><div class="Score">'+a+'</div><div class="downVote '+b+'"></div></div> 			<div class="TopInfo"><span class="Title">'+h+' - <span class="Reports">'+l[c].data.num_reports+" reports</span></span></div> 			"+e+' 			<div class="BottomInfo"><div class="Options"><a class="Button spam">spam</a><a class="Button remove">remove</a><a class="Button approve">approve  '+g+"</a></div></div> 		</div>")}var j=$('<div class="info">'+k.join("")+"</div>");j.on("click.modqueue",".upVote",function(i){i.stopPropagation();m.upVote($(this))});j.on("click.modqueue",".downVote",function(i){i.stopPropagation();m.downVote($(this))});j.on("click.modqueue",".spam",function(n){n.stopPropagation();var i=$(this).parent().parent().parent();i.find("a.Active").removeClass("Active");var o=i.attr("data-postid");$(this).addClass("Active");m.connection.remove(o,true,m.subreddit.split("/")[2])});j.on("click.modqueue",".remove",function(n){n.stopPropagation();var i=$(this).parent().parent().parent();i.find("a.Active").removeClass("Active");var o=i.attr("data-postid");$(this).addClass("Active");m.connection.remove(o,false,m.subreddit.split("/")[2])});j.on("click.modqueue",".approve",function(n){n.stopPropagation();var i=$(this).parent().parent().parent();i.find("a.Active").removeClass("Active");var o=i.attr("data-postid");$(this).addClass("Active");m.connection.approve(o)});j.on("click.modqueue",".Post",function(n){n.stopPropagation();var o=$(this).attr("data-postid");var i=$(this).attr("href");window.location.href="#/Home/post/"+o+"/permalink/"+i.replace(/\//g,"~")+"/column/"+m.subreddit.replace(/\//g,"-")});return j};modtools.prototype.reportedlinks=function(d){var m=this;var l=d.data.children;var k=[];var f='<button class="Button" data-message="close">Close</button><button class="Button time" data-message="goback">Go Back</button>';m.content.find("#optionButtons").html(f);var g="link";var a=0;var h="";var e="";var b="";for(var c=0;c<l.length;c++){if(l[c].kind=="t1"){g="comment";a=l[c].data.ups-l[c].data.downs;h=l[c].data.link_title;e=$("<div />").html(l[c].data.body_html).text()}else{if(l[c].kind=="t3"){g="link";a=l[c].data.score;h=l[c].data.title;e=""}}b="";if(l[c].data.likes==true){b="Likes"}else{if(l[c].data.likes==false){b="DisLikes"}}k.push('<div href="'+l[c].data.permalink+'" data-postid="'+l[c].data.name+'" class="Post"> 			<div class="Voting"><div class="upVote '+b+'"></div><div class="Score">'+a+'</div><div class="downVote '+b+'"></div></div> 			<div class="TopInfo"><span class="Title">'+h+' - <span class="Reports">'+l[c].data.num_reports+" reports</span></span></div> 			"+e+' 			<div class="BottomInfo"><div class="Options"><a class="Button spam">spam</a><a class="Button remove">remove</a><a class="Button approve">approve  '+g+"</a></div></div> 		</div>")}var j=$('<div class="info">'+k.join("")+"</div>");j.on("click.modqueue",".upVote",function(i){i.stopPropagation();m.upVote($(this))});j.on("click.modqueue",".downVote",function(i){i.stopPropagation();m.downVote($(this))});j.on("click.modqueue",".spam",function(){var i=$(this).parent().parent().parent();i.find("a.Active").removeClass("Active");var n=i.attr("data-postid");$(this).addClass("Active");m.connection.remove(n,true,m.subreddit.split("/")[2])});j.on("click.modqueue",".remove",function(){var i=$(this).parent().parent().parent();i.find("a.Active").removeClass("Active");var n=i.attr("data-postid");$(this).addClass("Active");m.connection.remove(n,false,m.subreddit.split("/")[2])});j.on("click.modqueue",".approve",function(){var i=$(this).parent().parent().parent();i.find("a.Active").removeClass("Active");var n=i.attr("data-postid");$(this).addClass("Active");m.connection.approve(n)});j.on("click.modqueue",".Post",function(n){n.stopPropagation();var o=$(this).attr("data-postid");var i=$(this).attr("href");window.location.href="#/Home/post/"+o+"/permalink/"+i.replace(/\//g,"~")+"/column/"+m.subreddit.replace(/\//g,"-")});return j};modtools.prototype.spamlinks=function(d){var m=this;var l=d.data.children;var k=[];var f='<button class="Button" data-message="close">Close</button><button class="Button time" data-message="goback">Go Back</button>';m.content.find("#optionButtons").html(f);var g="link";var a=0;var h="";var e="";var b="";for(var c=0;c<l.length;c++){if(l[c].kind=="t1"){g="comment";a=l[c].data.ups-l[c].data.downs;h=l[c].data.link_title;e=$("<div />").html(l[c].data.body_html).text()}else{if(l[c].kind=="t3"){g="link";a=l[c].data.score;h=l[c].data.title;e=""}}b="";if(l[c].data.likes==true){b="Likes"}else{if(l[c].data.likes==false){b="DisLikes"}}k.push('<div href="'+l[c].data.permalink+'" data-postid="'+l[c].data.name+'" class="Post"> 			<div class="Voting"><div class="upVote '+b+'"></div><div class="Score">'+a+'</div><div class="downVote '+b+'"></div></div> 			<div class="TopInfo"><span class="Title">'+h+"</span></div> 			"+e+' 			<div class="BottomInfo"><div class="Options"><a class="Button approve">approve  '+g+"</a></div></div> 		</div>")}var j=$('<div class="info">'+k.join("")+"</div>");j.on("click.modqueue",".upVote",function(i){i.stopPropagation();m.upVote($(this))});j.on("click.modqueue",".downVote",function(i){i.stopPropagation();m.downVote($(this))});j.on("click.modqueue",".approve",function(){var i=$(this).parent().parent().parent();i.find("a.Active").removeClass("Active");var n=i.attr("data-postid");$(this).addClass("Active");m.connection.approve(n)});j.on("click.modqueue",".Post",function(n){n.stopPropagation();var o=$(this).attr("data-postid");var i=$(this).attr("href");window.location.href="#/Home/post/"+o+"/permalink/"+i.replace(/\//g,"~")+"/column/"+m.subreddit.replace(/\//g,"-")});return j};modtools.prototype.bannedusers=function(h){var b=this;var f=h.data.children;var c='<button class="Button" data-message="close">Close</button><button class="Button time" data-message="goback">Go Back</button>';b.content.find("#optionButtons").html(c);var e=[];var a="";for(var d in f){a=' - <a id="'+f[d].id+'" class="removeBan">remove</a></div>';e.push('<div class="Ban">'+f[d].name+a)}b.content.on("click.edit",".removeBan",function(){$("#selectBan").val($(this).attr("id"));$(this).removeClass("removeBan").html('Are you sure?  <a data-message="removeBan" data-ignore="true">Yes</a> / <a data-message="cancelRemoveBan" data-ignore="true">No</a>')});var g='<div class="info"> 		<h3>Ban User</h3> 		<input class="short" type="text" id="banName" /> 		<a data-message="addBan" class="Button rightInput">Add</a> 		<h3>Banned Users</h3> 		<div class="banlist"> 		'+e.join("")+' 		</div> 		<input type="hidden" id="selectBan" value="" /> 	</div>';return g};modtools.prototype.unmoderatedlinks=function(d){var l=this;var k=d.data.children;var j=[];var f="link";var a=0;var g="";var e="";var b="";for(var c=0;c<k.length;c++){if(k[c].kind=="t1"){f="comment";a=k[c].data.ups-k[c].data.downs;g=k[c].data.link_title;e=$("<div />").html(k[c].data.body_html).text()}else{if(k[c].kind=="t3"){f="link";a=k[c].data.score;g=k[c].data.title;e=""}}b="";if(k[c].data.likes==true){b="Likes"}else{if(k[c].data.likes==false){b="DisLikes"}}j.push('<div href="'+k[c].data.permalink+'" data-postid="'+k[c].data.name+'" class="Post"> 			<div class="Voting"><div class="upVote '+b+'"></div><div class="Score">'+a+'</div><div class="downVote '+b+'"></div></div> 			<div class="TopInfo"><span class="Title">'+g+' - <span class="Reports">'+k[c].data.num_reports+" reports</span></span></div> 			"+e+' 			<div class="BottomInfo"><div class="Options"></div></div> 		</div>')}var h=$('<div class="info">'+j.join("")+"</div>");h.on("click.modqueue",".upVote",function(i){i.stopPropagation();l.upVote($(this))});h.on("click.modqueue",".downVote",function(i){i.stopPropagation();l.downVote($(this))});h.on("click.modqueue",".Post",function(m){m.stopPropagation();var n=$(this).attr("data-postid");var i=$(this).attr("href");window.location.href="#/Home/post/"+n+"/permalink/"+i.replace(/\//g,"~")+"/column/"+l.subreddit.replace(/\//g,"-")});return h};modtools.prototype.upVote=function(d){var a=this.connection;var b=d.parent();var f=b.children(".downVote:first");var e=b.children(".Score:first");if(!d.hasClass("Likes")){d.addClass("Likes");var c=(f.hasClass("DisLikes")?2:1);f.removeClass("DisLikes");e.text(parseInt(e.text())+c);a.upvote(b.parent().attr("data-postid"))}else{d.removeClass("Likes");f.removeClass("DisLikes");e.text(parseInt(e.text())-1);a.removevote(b.parent().attr("data-postid"))}};modtools.prototype.downVote=function(d){var a=this.connection;var b=d.parent();var f=b.children(".upVote:first");var e=b.children(".Score:first");if(!d.hasClass("DisLikes")){d.addClass("DisLikes");var c=(f.hasClass("Likes")?-2:-1);f.removeClass("Likes");e.text(parseInt(e.text())+c);a.downvote(b.parent().attr("data-postid"))}else{d.removeClass("DisLikes");f.removeClass("Likes");e.text(parseInt(e.text())+1);a.removevote(b.parent().attr("data-postid"))}};function userInfo(d,b,c){var a=this;userInfo.prototype.lastUserInfoViewed=d;this.realTabManagerObj=c;this.username=d;this.connection=b;this.id="-user-"+d+"-.json";this.url="/user/"+a.username+"/.json";this.startup(function(){a.bindings()})}userInfo.prototype.lastUserInfoViewed="";userInfo.prototype.startup=function(f){var a=this;var b='<div class="Viewport"> 			<div class="leftView"> 				<div class="loadingcss block"></div> 			</div> 			<div class="rightView"> 			</div> 		</div>';var d='<button class="left Button" id="close" data-message="close">[suggestedCloseText]</button><div id="optionButtons" class="buttongroup"></div>';a.content=$.popup({id:"userinfo",title:a.username,message:b,buttons:d},function(k){if(k=="sendMessage"){a.content.closePopup();notifications(a.connection,window.tabManagerObj,{action:"compose",username:a.username})}else{if(k=="manageTags"){a.connection.tags(function(n){a.tags=n;redditpost.prototype.manageTags.call(a,a.username)});return}else{if(k=="addFriend"){var j=a.content.find(".addFriend").addClass("loading");var l={action:"add",type:"friend",container:"t2_"+a.connection.user.id,name:a.username};a.connection.friend(l,function(){console.log(j);j.removeClass("loading addFriend").addClass("removeFriend").html('<i class="icon-remove"></i><span>&nbsp;&nbsp;Remove Friend</span>').attr("data-message","removeFriend")})}else{if(k=="removeFriend"){var j=a.content.find(".removeFriend").addClass("loading");var i={action:"remove",type:"friend",container:"t2_"+a.connection.user.id,name:a.username};a.connection.unfriend(i,function(){j.removeClass("loading removeFriend").addClass("addFriend").html('<i class="icon-plus"></i><span>&nbsp;&nbsp;Add Friend</span>').attr("data-message","addFriend")})}else{if(k=="copyLink"){var h="http://reddit.com"+a.url.replace(".json","");var g=document.createElement("div");g.contentEditable=true;document.body.appendChild(g);g.innerHTML=h;g.unselectable="off";g.focus();document.execCommand("SelectAll");document.execCommand("Copy",false,null);document.body.removeChild(g)}else{if(k=="toggleColumn"){var j=a.content.find(".toggleColumn");if(j.text().trim()=="Add Column"){var m=tabManagerObj.insert(function(n){return new column(a.url,n,activePlayground,connection,this,{SPECIAL:true,SORT:"new",USER:true},a.username+"'s Posts")},"SYNC");a.content.closePopup();tabManagerObj.changePage(m);j.html('<i class="icon-remove"></i><span>&nbsp;&nbsp;Remove Column</span>')}else{tabManagerObj.removeColumn(a.id);j.html('<i class="icon-plus"></i><span>&nbsp;&nbsp;Add Column</span>')}}}}}}}return k});var c=new column("/user/"+a.username+".json",$(".rightView"),activePlayground,connection,false,{SPECIAL:true,SORT:"new",USER:true},a.username+"'s Posts").startup();var e=c.openPost;c.openPost=function(g){a.content.closePopup();e.call(c,g)};a.connection.getUser(a.username,function(g){if(!g){alert("The user "+a.username+" does not exist.");a.content.closePopup();return}var h='<button style="margin-right: -4px;" data-message="manageTags" class="Button"><i class="icon-tag"></i><span>&nbsp;&nbsp;Manage Tags</span></button> 			<button data-message="copyLink" class="Button"><i class="icon-link"></i><span>&nbsp;&nbsp;Copy Link</span></button>'+(a.connection.isfriend(a.username)?'<button data-message="removeFriend" class="removeFriend Button"><i class="icon-remove"></i><span>&nbsp;&nbsp;Remove Friend</span></button>':'<button data-message="addFriend" class="addFriend Button"><i class="icon-user"></i><span>&nbsp;&nbsp;Add Friend</span></button>')+'<button data-message="toggleColumn" class="toggleColumn Button">'+(a.realTabManagerObj.isPermanentColumn(a.url)?'<i class="icon-remove"></i><span>&nbsp;&nbsp;Remove Column</span>':'<i class="icon-plus"></i><span>&nbsp;&nbsp;Add Column</span>')+'</button><button data-message="sendMessage" class="Button"><i class="icon-envelope"></i><span>&nbsp;&nbsp;Send Message</span></button>';var i=g.user;var k=g.trophies;var j='<div class="userStats"> 					<div class="User">'+a.username+'</div> 					<div class="statSection"><span class="stat">'+i.link_karma+'</span><br /> <span class="statLabel">link karma</span></div> 										<div class="statSection"><span class="stat">'+i.comment_karma+'</span> 					<br /> <span class="statLabel">comment karma</span></div>						<div class="statSection"><span class="stat date">'+formatDate(i.created_utc)[0]+'</span> 					<br /> <span class="statLabel">registered</span></div> 				</div> 				<div class="trophies"><h3>Trophy Case</h3> 				'+k+" 				</div>";a.content.find(".leftView").html(j);a.content.find("#optionButtons").append(h)});if(typeof f=="function"){f()}};userInfo.prototype.bindings=function(){var a=this};function friendsList(b,c){var a=this;this.connection=b;this.tabManager=c;this.startup(function(){a.bindings()})}friendsList.prototype.startup=function(e){var b=this;var d='<div class="Viewport"> 		</div>';b.content=$.popup({id:"friendslist",title:"Friends",message:d,buttons:'<button class="Button" id="close" data-message="close"><i class="icon-remove"></i><span>&nbsp;&nbsp;Close</span></button><div id="optionButtons" class="left buttongroup"><button class="left Button" id="toggleNewFriend"><i class="icon-plus"></i><span>&nbsp;&nbsp;Add Friend</span></button><input type="text" placeholder="Seperate usernames by spaces" id="newFriendInput" /></div>'},function(f){if(f=="addFriend"){}else{if(f=="removeFriend"){}}return f});var a=[];for(var c in b.connection.user.friends){a.push('<div class="friend" data-username="'+c+'" id="'+b.connection.user.friends[c]+'"><div class="userName">'+c+'</div><div class="options"><button class="toggleFriend Button"><i class="icon-remove"></i></button></div></div><div class="clearBoth"></div></div>')}b.content.find(".Viewport").html(a.join(""));if(typeof e=="function"){e()}};friendsList.prototype.bindings=function(){var a=this;a.content.on("click.friendslist",".friend",function(){var b=new userInfo($(this).find(".userName").text(),a.connection,a.tabManager)});a.content.on("click.friendslist",".toggleFriend",function(d){d.stopPropagation();var c=$(this).addClass("loading");if(c.text()=="Add"){var f={action:"add",type:"friend",container:"t2_"+a.connection.user.id,name:c.parent().parent().attr("data-username")};a.connection.friend(f,function(){c.removeClass("loading").html('<i class="icon-remove"></i>')})}else{var b={action:"remove",type:"friend",container:"t2_"+a.connection.user.id,name:c.parent().parent().attr("data-username")};a.connection.unfriend(b,function(){c.removeClass("loading").text("Add")})}});a.content.on("keypress.friendslist","#newFriendInput",function(f){if(f.which==13){var d=a.content.find("#newFriendInput").removeClass("expand").val().split(" ");a.content.find("#toggleNewFriend").text("Add Friends");for(var c=0;c<d.length;c++){var b=$.trim(d[c]);var g={action:"add",type:"friend",container:"t2_"+a.connection.user.id,name:b};a.connection.friend(g,b,function(h,e){a.content.find(".Viewport").append('<div class="friend" data-username="'+e+'" id="'+h[29][3][0][0].id+'"><div class="userName">'+e+'</div><div class="options"><button class="toggleFriend Button"><i class="icon-remove"></i></button></div></div><div class="clearBoth"></div></div>')})}}});a.content.on("click.friendslist","#toggleNewFriend",function(f){a.content.find("#newFriendInput").focus();if($(this).text()!="Submit"){a.content.find("#newFriendInput").addClass("expand").val("");$(this).html('<i class="icon-remove"></i><span>&nbsp;&nbsp;Submit</span>')}else{var d=a.content.find("#newFriendInput").removeClass("expand").val().split(" ");$(this).text('<i class="icon-plus"></i><span>&nbsp;&nbsp;Add Friend</span>');for(var c=0;c<d.length;c++){var b=$.trim(d[c]);var g={action:"add",type:"friend",container:"t2_"+a.connection.user.id,name:b};a.connection.friend(g,b,function(h,e){a.content.find(".Viewport").append('<div class="friend" data-username="'+e+'" id="'+h[29][3][0][0].id+'"><div class="userName">'+e+'</div><div class="options"><button class="toggleFriend Button"><i class="icon-remove"></i></button></div></div><div class="clearBoth"></div></div>')})}}})};if(typeof volatileUserCacheData=="undefined"){var volatileUserCacheData={}}function column(a,f,g,c,h,d,i,k,b){var j=this;c.setting("NSFW",function(l){j.NSFW=l});if(typeof b!="undefined"&&b>150){this.width=b}var e=a.match(/r\/(.*?)\//);this.subreddit=(e!=null)?this.subreddit=e.pop().toLowerCase():false;if(typeof d.SORT=="undefined"&&(a=="/"||d.USER)){d.SORT="new"}else{if(typeof d.SORT=="undefined"){d.SORT="hot"}}this.flags=d;if(typeof k!="undefined"){this.refreshTime=k}this.url=a=a.toLowerCase();this.title=i;this.playground=g;this.tabManagerObj=(typeof h=="boolean")?this.pseudoTabManager():h;this.connection=c;this.id=a.replace(/\//g,"-");this.selector=f;this.updateIntervalPages=[];this.pagesActive=[];this.activePosts=[];return this}column.prototype.refreshIntervalRunning=false;column.prototype.refreshTime=120000;column.prototype.count=70;column.prototype.loading=false;column.prototype.yScrollPos=40;column.prototype.binded=false;column.prototype.running=false;column.prototype.width=300;column.prototype.currentFilterText="";column.prototype.activeColumn=undefined;column.prototype.setUrl=function(a){a=a.toLowerCase();this.url=a;this.id=a.replace(/\//g,"-");this.content.attr("id",this.id);this.refresh()};column.prototype.fetchDataAfter=function(d,e,c){var a=this.url;if(a.indexOf("subreddits_by")!=-1){var b=a.match(/query=(.*?)$/).pop();this.connection.searchForSubreddit(b,function(f){e(f,false)});return}this.connection.getPosts((a.indexOf(".json")!=-1)?((a.indexOf(".json?")!=-1)?a+"&sort="+this.flags.SORT:a+"?sort="+this.flags.SORT):a+this.flags.SORT+".json?",this.count,d,function(f){e(f)},c)};column.prototype.armBindings=function(){var a=this;this.selector.unbind("mouseover.initialize").bind("mouseover.initialize",function(){if(typeof a.postContainer=="undefined"){return}a.selector.unbind("mouseover.initialize");a.bindings(true)});if(this.refreshTime!=0){this.refreshInterval(true)}this.hoverOverPopups()};column.prototype.hoverOverPopups=function(){var a=this;this.connection.setting("postHoverOvers",function(b){if(b){a.selector.off(".popup").on("mouseenter.popup",".Post",function(c){smartContentPopup($(this))}).on("mouseleave.popup",".Post",function(c){smartContentPopupPrevent($(this))})}})};column.prototype.bindings=function(b,k){var g=this.binded;if(g&&b){return}if(g==false&&b==false){return}var f=this.content;var a=this.connection;var l=this;var h=this.postContainer;var c=this.selector;if(b==false){this.binded=false;this.postContainer.unbind(".columnEvents");f.off(".columnEvents");c.off(".columnEvents");this.selector.off();if(typeof k=="function"){k()}clearInterval(this.refreshInterval);for(var d in this.updateIntervalPages){clearInterval(this.updateIntervalPages[d])}this.updateIntervalPages=[];if(typeof this.sidebarObject!="undefined"){this.sidebarObject.off();this.sidebarObject.remove()}return}this.binded=true;var j=this.pagesActive;var e=j.length;l.initializeUpdateScoresLoop(null,false);if(e>0){for(var d=0;d<e;d++){l.initializeUpdateScoresLoop(j[d],false)}}if(navigator.appVersion.indexOf("Mac")!=-1){h.bind("mousewheel",function(m){var i=$(this).scrollTop();if(i<1&&m.originalEvent.wheelDelta>1){m.preventDefault();return false}else{if(i==($(this).children(".PostScroller").height()-$(this).height())&&m.originalEvent.wheelDelta<0){m.preventDefault();return false}}})}h.bind("scroll",function(i){clearTimeout(l.scrollEvent);l.scrollEvent=setTimeout(function(){l.handleScroll(i)},500)});this.hoverOverPopups();if(a.loggedin){f.on("click.columnEvents",".upVote",function(i){i.stopPropagation();l.upVote($(this),$(this).parent().parent().attr("id"))});f.on("click.columnEvents",".subscribeToggle",function(m){m.stopPropagation();var i=$(this);var n=i.attr("subreddit");if(i.html()=="Subscribe"){i.html("Unsubscribe").removeClass("green").addClass("red");a.subscribe(n)}else{i.html("Subscribe").removeClass("red").addClass("green");a.unsubscribe(n)}});f.on("click.columnEvents",".downVote",function(i){i.stopPropagation();l.downVote($(this),$(this).parent().parent().attr("id"))});f.on("click.columnEvents",".HidePost",function(i){i.stopPropagation();l.hidePost($(this).parent().parent())});f.on("click.columnEvents",".subredditOptions #Modtools",function(i){i.stopPropagation();l.createModtools(l.url,l.connection);$(this).parent().html("")});f.on("click.columnEvents",".subredditOptions #subscribeColumn",function(m){m.stopPropagation();var i=$(this);l.toggleSubscribe(i.attr("subreddit"),l.connection,i);$(this).parent().html("")})}c.on("click.columnEvents",function(){if(c.is(column.prototype.activeColumn)&&!l.makeColumnGlow){c.removeClass("glow");column.prototype.activeColumn=undefined;return}if(typeof column.prototype.activeColumn!="undefined"){column.prototype.activeColumn.removeClass("glow")}column.prototype.activeColumn=l.selector;c.addClass("glow")});f.on("mouseleave.columnEvents",function(){l.hideFilter()});f.on("click.columnEvents","#removeContents",function(i){f.find("#searchElements input").val("").focus();l.applyFilter("");i.stopPropagation()});f.on("keyup.columnEvents","#searchElements input",function(i){if(i.keyCode==27){$(this).val("").blur();$(".current").removeClass("current");f.find(".Post:first").addClass("current")}l.applyFilter($(this).val());if(l.makeColumnGlow!=true){l.makeColumnGlow=true;c.click()}clearTimeout(l.makeColumnGlowTimeout);l.makeColumnGlowTimeout=setTimeout(function(){l.makeColumnGlow=false},1000)});f.on("keydown.columnEvents","input",function(i){i.stopPropagation()});f.on("click.columnEvents",".quickOptions .refreshColumns",function(){l.refresh()});f.on("click.columnEvents",".quickOptions .galleryMode",function(){l.openGallery()});f.on("click.columnEvents",".subredditOptions #toggleAddDeleteColumn",function(i){i.stopPropagation();l.toggleAddDeleteColumn(l.id,$(this))});f.on("click.columnEvents",".subredditOptions .left.item",function(i){i.stopPropagation();l.tabManagerObj.moveColumn(l.id,"left")});f.on("click.columnEvents",".subredditOptions .right.item",function(i){i.stopPropagation();l.tabManagerObj.moveColumn(l.id,"right")});f.on("click.columnEvents",".columnOptions",function(i){i.stopPropagation();l.columnOptions.call(l,$(this),i)});f.on("click.columnEvents",".sortbyTrigger",function(i){l.startSortBy($(this))});f.on("click.columnEvents",".sortby",function(i){l.switchSort($(this).attr("id"));$(this).parent().html("")});f.on("click.columnEvents","#refreshData",function(i){l.refresh();$(this).parent().html("")});f.on("click.columnEvents","#galleryMode",function(i){l.openGallery();$(this).parent().html("")});f.on("click.columnEvents","#manageSubreddits",function(i){l.manageSubreddits();$(this).parent().html("")});f.on("click.columnEvents","#changeTitle",function(m){var i=this;l.setTitle(function(n){if(n){$(i).parent().html("")}})});f.on("click.columnEvents","#resize",function(i){l.widthChanger($(this))});f.on("click.columnEvents","#sideBar",function(i){l.sideBar();$(this).parent().html("")});f.on("click.columnEvents",".Post:not(.LoadingPost)",function(){l.openPost.call(l,$(this))});f.on("click.columnEvents",".Author",function(i){i.stopPropagation();var m=$(this).text();l.userProfile(m)});f.on("click.columnEvents",".Sorter",function(r){r.preventDefault();r.stopPropagation();if(l.flags.SEARCH){var s=["hot","relevance","new","top","comments"];var p=s.length}else{var s=["hot","new","controversial","top"]}var o=l.flags.SORT;var m=s.length;for(var n=0;n<m;n++){if(o==s[n]){var q=n+1;if(q==m){q=0}o=s[q];l.switchSort(o);return}}});if(typeof k=="function"){k()}return this};column.prototype.hideFilter=function(){var a=this;clearTimeout(this.hideFilterTimeout);this.hideFilterTimeout=setTimeout(function(){if(a.tabManagerObj.mailViewActive){return}if(a.yScrollPos<=40){a.yScrollPos=40;a.postContainer.animate({scrollTop:"40px"},150)}},250)};column.prototype.userProfile=function(b){var a=new userInfo(b,this.connection,this.tabManagerObj)};column.prototype.pseudoTabManager=function(){return{moveColumn:function(){},isPermanentColumn:function(){return false},setSort:function(){},makePermanent:function(){},removeColumn:function(){}}};column.prototype.columnOptions=function(h,j){var m=this.content.find(".subredditOptions");var c=this.connection;var o=this;if(m.find("div").length!=0){m.find("div").remove();return}var f=[];f.push("<div id='Navigation' class='left item'></div> 						   <div id='Navigation' class='right item'></div> 						   <div style='clear: both'></div> 						   <div id='changeTitle' class='item'><i class='icon-pencil'></i>&nbsp;&nbsp;Change Column Title</div>");if(!this.flags.SPECIAL&&this.subreddit&&("/"+this.url).indexOf("/r/")!=-1){f.push("<div id='manageSubreddits' class='item'><i class='icon-tasks'></i>&nbsp;&nbsp;Manage Subreddits</div>")}f.push("<div id='refreshData' class='item'><i class='icon-refresh'></i>&nbsp;&nbsp;Refresh Content</div>");if(!(this.flags.SPECIAL||this.id.indexOf("+")!=-1||this.id=="-")){f.push("<div id='sideBar' class='item'><i class='icon-bullhorn'></i>&nbsp;&nbsp;Sidebar</div>")}f.push("<div id='galleryMode' class='item'><i class='icon-picture'></i>&nbsp;&nbsp;Gallery Mode</div> 						   <div id='resize' class='item'><i class='icon-resize-horizontal'></i>&nbsp;&nbsp;Width: <span id='width'>"+this.width+"</span>px</div>");if(this.connection.ismod(this.url)){f.push("<div id='Modtools' class='item'><i class='icon-certificate'></i>&nbsp;&nbsp;Moderation Tools</div>")}f.push("<div id='toggleAddDeleteColumn' "+(o.tabManagerObj.isPermanentColumn(o.url)?"class='item'><i class='icon-trash'></i>&nbsp;&nbsp;Remove Column from Reditr":"class='item'><i class='icon-plus-sign'></i>&nbsp;&nbsp;Add Column to Reditr")+"</div> 						   <div id='new' class='item sortbyTrigger'><i class='icon-reorder'></i>&nbsp;&nbsp;Sort Options</div>");if(o.flags.SEARCH){f.push("<div id='relevance' class='item sortby'><i class='icon-bar-chart'></i>&nbsp;&nbsp;Sort by Relevance</div> 							   <div id='new' class='item sortby'><i class='icon-asterisk'></i>&nbsp;&nbsp;Sort by New</div> 							   <div id='top' class='item sortby'><i class='icon-list-ol'></i>&nbsp;&nbsp;Sort by Top</div> 							   <div id='comments' class='item sortby'><i class='icon-comments'></i>&nbsp;&nbsp;Sort by Comments</div> 							   <div id='hot' class='item sortby'><i class='icon-fire'></i>&nbsp;&nbsp;Sort by Hot</div>")}else{if(o.flags.SORT!=false){f.push("<div id='new' class='item sortby'><i class='icon-asterisk'></i>&nbsp;&nbsp;Sort by New</div> 							   <div id='hot' class='item sortby'><i class='icon-fire'></i>&nbsp;&nbsp;Sort by Hot</div> 							   <div id='controversial' class='item sortby'><i class='icon-legal'></i>&nbsp;&nbsp;Sort by Controversial</div> 							   <div id='top' class='item sortby'><i class='icon-list-ol'></i>&nbsp;&nbsp;Sort by Top</div>")}}if(!this.flags.SPECIAL&&c.loggedin&&this.subreddit){var k=Date.now();f.push('<div id="subscribedPlaceholder'+k+'"></div>');var n=this.subreddit.split("+");var b=[];var d=n.length;var a=0;for(var g=0;g<d;g++){(function(){var e=n[g];c.issubscribed(e,function(i,p){b.push("<div id='subscribeColumn' subreddit='"+p+"' class='item'><i class='icon-heart'></i>&nbsp;&nbsp;"+(i?"Unsubscribe from":"Subscribe to")+" "+e+"</div>");if(d==++a){l(b.join(""),k)}})})()}}function l(e,i){waitForSelector("#subscribedPlaceholder"+i,function(p){p.replaceWith(e)})}o.content.find(".subredditOptions").html(f.join(""))};column.prototype.columnOptionsDropdown=function(b,d){var a=this;var c=this.content;var f=c.find(".subredditOptions");if(f.hasClass("active")){f.removeClass("active")}else{f.addClass("active")}};column.prototype.createModtools=function(b,a){var c=new modtools(b,a)};column.prototype.handleScroll=function(){var b=this.postContainer.find(".PostScroller");var c=this.yScrollPos=this.postContainer.scrollTop();var a=this;this.playground.find(".smartContentPopup").remove();if(b.height()-(c+this.postContainer.height())<250&&!this.loading&&this.url.indexOf("subreddits_by")==-1){var e=this.postContainer.find(".LoadingPost");var d=b.children(".Post:not(.LoadingPost):last").attr("data-name");this.loading=true;this.count+=25;if(this.count>74){this.content.addClass("noAnimate")}a.fetchDataAfter(d,function(g){var f=a.createPostBuffer(g,true);e.remove();b.append(f);if(g.length==0){b.find(".LoadingPost").remove()}a.loading=false;a.initializeUpdateScoresLoop(d,true)})}};column.prototype.createPostBuffer=function(u,n){var p=this.activePosts;var k=this.connection;var o=this.subreddit;var l=this.NSFW;var c=typeof this.flags.highlight=="undefined"?false:this.flags.highlight;if(u.length==100&&!window.alertedAboutHundred){window.alertedAboutHundred=true;clearTimeout(window.hundredTimeout);window.hundredTimeout=setTimeout(function(){alert("You currently have Reddit set to fetch 100 posts at a time. This setting is not compatible with Reditr, and you must change it back to 25 in order to receive optimal performance from Reditr.")},3000)}var g=[];var w="";var q="NoThumb";var h,d,a,s,j='<div class="HidePost"></div>';var t=(n)?'<div class="Post LoadingPost"><div class="loadingcss block"></div></div>':"";var e=k.loggedin;var b="";for(var r in u){var m=u[r].data;var f=u[r].kind;if(typeof m=="undefined"){var v=u[r].name;g.push('<div type="context" class="Post isSubreddit" data-href="/r/'+v+'"> <div class="Comment">'+v+'</div><div style="clear:both;"></div>'+(e?'<button class="loading subSearch-'+v+' subscribeToggle"></button>':"")+"</div>");if(e){k.issubscribed(v,function(i,y,x){waitForSelector(".subSearch-"+x,function(z){z.attr("subreddit",y);if(i){z.removeClass("loading").addClass("red").html("Unsubscribe")}else{z.removeClass("loading").addClass("green").html("Subscribe")}})})}continue}if((l==2&&m.over_18)||(l==3&&!m.over_18)){continue}k.getLocalStorageCache(m.name,function(y){if(m.hidden){return}p[m.name]=true;h="";if(m.likes==true){h="Likes"}else{if(m.likes==false){h="DisLikes"}}var D=parseInt(m.created_utc);var x=formatDate(D);var H=(typeof m.dest!="undefined")?'<span class="Author">'+m.author+'</span> to <span class="Author">'+m.dest+"</span>":'<span class="Author">'+m.author+"</span>";var C=(m.num_comments-y.num_comments);var E=(typeof y.num_comments!="undefined"&&C>0)?'<span id="newComments"> ('+(m.num_comments-y.num_comments)+" new)</span>":"";var A=(typeof m.num_comments!="undefined")?" - "+m.num_comments+" comments":"";infobottom='<div class="InfoBottom"><span class="AuthorContainer">'+H+'<span id="commentInfo">'+A+E+'</span> </span> <span class="date '+x[1]+'" data-timestamp="'+D+'">'+x[0]+"</span></div>";var z=(c==m.id)?"current ":"";if(f=="t4"){var F="/message/messages/"+m.id;var B=(m["new"])?"unread":"read";b='<div type="t4" class="'+z+"Post "+B+'" data-name="'+m.name+'" data-url="http://www.reddit.com'+F+'" data-permalink="'+F+'" id="'+m.id+'" data-postid="'+m.id+'"><div class="Comment">'+m.subject+'</div><div style="clear:both;"></div>'+infobottom+"</div>"}else{if(f=="t1"&&typeof m.context!="undefined"){var G=(o==m.subreddit.toLowerCase())?"":capitalize(m.subreddit)+" - ";var F="/r/"+m.subreddit+"/comments/"+m.context.match(/comments\/(.*?)\?context/).pop()+".json?context=3";var B=(m["new"])?"unread":"read";var i=m.context.match(/comments\/(.*?)\//).pop();b='<div type="context" class="'+z+"Post "+B+'" data-postid="'+i+'" data-name="'+m.name+'" data-url="http://www.reddit.com'+F+'" data-permalink="'+F+'" id="'+m.id+'" data-postid="'+m.id+'"> <div class="Comment">'+G+m.body+'</div><div style="clear:both;"></div>'+infobottom+"</div>"}else{if(f=="t1"){var G=(o==m.subreddit.toLowerCase())?"":capitalize(m.subreddit);var F="/r/"+m.subreddit+"/comments/"+m.link_id.replace("t3_","")+"/post/"+m.id+".json?context=3";b='<div class="'+z+'Post" data-name="'+m.name+'" data-url="http://www.reddit.com'+F+'" data-permalink="'+F+'" id="'+m.id+'" data-postid="'+m.id+'"><div class="Voting"><div class="upVote '+h+'"></div><div class="Score">'+(m.ups-m.downs)+'</div><div class="downVote '+h+'"></div></div><div data-url="'+F+'" class="Title NoThumb">'+m.link_title+' <div class="Domain">('+G+')</div> </div><div class="Comment">'+$("<div />").html(m.body_html).text()+'</div><div style="clear:both;"></div>'+infobottom+"</div>"}else{var G=(o==m.subreddit.toLowerCase())?"":capitalize(m.subreddit)+" - ";if(m.thumbnail!=""&&m.thumbnail!="self"&&m.thumbnail!="default"&&m.thumbnail!="nsfw"){w='<img class="Thumb" src="'+m.thumbnail+'" />';q=""}else{if(m.thumbnail=="self"||m.thumbnail=="default"||m.thumbnail=="nsfw"){w='<div class="Thumb '+m.thumbnail+'"></div>';q=""}else{w="";q="NoThumb"}}a=(m.over_18)?'<span class="NSFW"></span>':"";b='<div class="'+z+"Post"+((typeof y.num_comments=="undefined")?"":" visited")+'" data-href="'+m.url+'" data-name="'+m.name+'" data-permalink="'+m.permalink+'" id="'+m.id+'" data-postid="'+m.id+'"><div class="Voting"><div class="upVote '+h+'"></div><div class="Score">'+m.score+'</div><div class="downVote '+h+'"></div></div><div data-url="'+m.url+'" class="Title '+q+'">'+w+j+a+m.title+' <div class="Domain">('+G+m.domain+')</div> </div><div style="clear:both;"></div>'+infobottom+"</div>"}}}g.push(b)})}g=g.join("")+t;return g};column.prototype.startSortBy=function(a){a.remove();this.content.find(".subredditOptions .sortby").show()};column.prototype.switchSort=function(d,c){var a=(this.url.indexOf("subreddits_by")==-1)?true:false;if(typeof this.content=="undefined"){return}var b=this;this.flags.SORT=d;if(c!=true){this.content.find(".Sorter").html(d)}clearTimeout(this.switchSortTimeout);this.switchSortTimeout=setTimeout(function(){b.bindings(false);b.refreshInterval(false);var f=b.postContainer=b.content.find("#PostContainer");f.html('<div class="loadingcss"></div>');b.loading=true;b.yScrollPos=40;var e=b;b.fetchDataAfter(null,function(i,h){if(i.length>0&&a){b.firstPost=i[0].data.name}var g="<div class=\"PostScroller\"> <div id='searchElements'><input placeholder='Type to filter' id='search'><div id='removeContents' class='icon deleteTextInput'></div></div> "+e.createPostBuffer(i,(typeof h=="undefined"?true:h))+"</div>";setTimeout(function(){f.html($(g));b.postContainer.scrollTop(40);b.searchElements=b.postContainer.find("#searchElements input");if(f.height()>f.find(".PostScroller").height()){f.find(".LoadingPost").remove()}f.find(".PostScroller").addClass("loaded")},850);e.bindings(true);e.loading=false;if(e.refreshTime!=0){e.refreshInterval(true)}});if(c!=true){b.tabManagerObj.setSort(b.id,d)}},1000)};column.prototype.refresh=function(){this.switchSort(this.flags.SORT,true)};column.prototype.openGallery=function(b){b=b||"default";var a=new gallery(this,b)};column.prototype.hidePost=function(c){var a=this.connection;var b=c.attr("data-name");c.fadeOut(300);a.hidepost(b)};column.prototype.upVote=function(d,g){var a=this.connection;var f=$('[data-postid="'+g+'"] .downVote');var e=$('[data-postid="'+g+'"] .Score');d=$('[data-postid="'+g+'"] .upVote');var b=d.parent();if(!d.first().hasClass("Likes")){d.addClass("Likes");var c=(f.first().hasClass("DisLikes")?2:1);f.removeClass("DisLikes");e.text(parseInt(e.first().text())+c);a.upvote(b.parent().attr("data-postid"))}else{d.removeClass("Likes");f.removeClass("DisLikes");e.text(parseInt(e.first().text())-1);a.removevote(b.parent().attr("data-postid"))}};column.prototype.downVote=function(d,g){var a=this.connection;var f=$('[data-postid="'+g+'"] .upVote');var e=$('[data-postid="'+g+'"] .Score');d=$('[data-postid="'+g+'"] .downVote');var b=d.parent();var b=d.parent();if(!d.first().hasClass("DisLikes")){d.addClass("DisLikes");var c=(f.first().hasClass("Likes")?-2:-1);f.removeClass("Likes");e.text(parseInt(e.first().text())+c);a.downvote(b.parent().attr("data-postid"))}else{d.removeClass("DisLikes");f.removeClass("Likes");e.text(parseInt(e.first().text())+1);a.removevote(b.parent().attr("data-postid"))}};column.prototype.startup=function(c){var b=this;if(this.running){return}this.running=true;this.loading=true;this.content=$("<div id='"+this.id+"' class='Column canscroll'> <div class='individualColumn loaded'> <div class='ColumnTitle'><span class='title'>"+b.title+"</span></div> <div class='loadingcss'></div> </div> </div>");this.selector.html(this.content);var a=volatileUserCacheData[this.id];if(typeof a!="undefined"&&c!=true){this.content.removeClass("loading").html(a.content);if(typeof this.flags.highlight!="undefined"){this.content.find(".current").removeClass("current");this.content.find("#"+this.flags.highlight).addClass("current")}this.activePosts=a.activePosts;this.postContainer=this.content.find("#PostContainer");this.searchElements=this.postContainer.find("#searchElements input");this.url=a.url;this.title=a.title;this.count=a.count;this.yScrollPos=a.yScrollPos;this.postContainer.scrollTop(a.yScrollPos);this.pagesActive=a.pagesActive;this.refreshTime=a.refreshTime;this.armBindings();this.loading=false;return this}var f=b.content.find(".individualColumn");var e=false;var d=setTimeout(function(){f.append('<div id="notResponding">Reddit.com isn\'t responding, <a>try again</a>.</div> <div id="deleteNotResponding">(Or <a>click here</a> to delete this column)</div>');f.find("#notResponding a").one("click",function(){e=true;delete volatileUserCacheData[b.id];b.running=false;b.startup()});f.find("#deleteNotResponding a").click("click",function(){b.removeColumn()})},10000);b.fetchDataAfter(null,function(k,j){if(e){return}clearTimeout(d);if(k.length>0&&b.url.indexOf("subreddits_by")==-1){b.firstPost=k[0].data.name;b.subreddit_id=k[0].data.subreddit_id}var h=((b.flags.SORT!=false)?"<div class='Sorter'>"+b.flags.SORT+"</div>":"")+"<div class='ColumnTitle'><span class='columnOptions icon settings'></span><div class='title'>"+b.title+"</div></div><div class='quickOptions'><div class='option refreshColumns'><i class='icon-refresh'></i>&nbsp;</div><div class='option galleryMode'><i class='icon-camera'></i>&nbsp;</div></div><div class='subredditOptions'></div><div id='PostContainer'><div class='PostScroller'><div id='searchElements'><input placeholder='Type to filter' id='search'><div id='removeContents' class='icon deleteTextInput'></div></div>";var i=b.createPostBuffer(k,(typeof j=="undefined"?true:j));var g="</div></div>";var l=h+i+g;setTimeout(function(){f.html(l);b.postContainer=b.content.find("#PostContainer");b.searchElements=b.postContainer.find("#searchElements input");b.postContainer.scrollTop(40);b.postContainer.find(".PostScroller").addClass("loaded");if(b.postContainer.height()>b.postContainer.find(".PostScroller").height()){b.postContainer.find(".LoadingPost").remove()}if(typeof b.loaded=="function"){b.loaded()}},850);b.armBindings();setTimeout(function(){b.loading=false},500)});return this};column.prototype.shutdown=function(a,c){if(typeof a=="undefined"){a=true}else{if(typeof a=="function"){c=a;a=true}}if(!this.running){return}this.running=false;this.applyFilter("");this.bindings(false);if(this.refreshTime!=0){this.refreshInterval(false)}var b=this.content;if(!this.loading&&a&&!this.flags.TEMP){volatileUserCacheData[this.id]={url:this.url,flags:this.flags,count:this.count,content:b.html(),yScrollPos:this.yScrollPos,title:this.title,pagesActive:this.pagesActive,refreshTime:this.refreshTime,activePosts:this.activePosts}}b.html("").addClass("loading");if(typeof c=="function"){c()}};column.prototype.sideBar=function(){var a=this;if(typeof this.sidebarObject!="undefined"){this.sidebarObject.removeClass("loaded");var a=this;setTimeout(function(){a.sidebarObject.remove();a.sidebarObject=undefined},500);return}var b=this.sidebarObject=$('<div class="sidebar"> <div class="loadingcss"></div> </div>').appendTo(this.content);setTimeout(function(){b.addClass("loaded")},1);this.connection.sidebar(a.title,function(c){b.html(c);b.on("click.postview"+a.id,"a[data-ignore!=true]",function(d){a.clickLink.call(a,$(this).attr("href"),d)})})};column.prototype.hide=function(){this.selector.hide()};column.prototype.show=function(){this.selector.show()};column.prototype.remove=function(){this.shutdown();delete volatileUserCacheData[this.id];var a=this;setTimeout(function(){a.content.remove()},100)};column.prototype.toggleAddDeleteColumn=function(b,a){if(!this.tabManagerObj.isPermanentColumn(b)){this.tabManagerObj.makePermanent(b);return}this.removeColumn()};column.prototype.removeColumn=function(b){var a=this;$.popup({title:"Are You Sure?",message:"Are you certain you wish to delete this column from Reditr?",buttons:'<button class="left" data-message="close"><i class="icon-remove"></i><span>&nbsp;&nbsp;Cancel</span></button> <button class="first" data-message="remove"><i class="icon-trash"></i><span>&nbsp;&nbsp;Remove</span></button><button class="last green space right" data-message="unsubscribe"><i class="icon-ok"></i><span>&nbsp;&nbsp;Remove & Unsubscribe</span></button>'},function(c){if(c=="unsubscribe"){a.connection.unsubscribe(a.subreddit_id)}if(c!="close"){tabManagerObj.removeColumn(a.id)}if(typeof b=="callback"){b()}return"close"})};column.prototype.toggleSubscribe=function(b,a,c){if(a.issubscribed(b)){a.unsubscribe(b);c.html("Subscribe to Subreddit")}else{a.subscribe(b);c.html("Unsubscribe from Subreddit")}};column.prototype.openPost=function(b){if(b.hasClass("isSubreddit")){var a=(b.attr("data-href")+"/").match(/\/r\/(.*?)\//).pop();new quickView(self.connection,capitalize(a),"/r/"+a+"/");return}window.armForEnter=b;this.markCurrent(b);var c=b.attr("data-permalink");var d=b.attr("data-postid");window.location.href="#/Home/post/"+d+"/permalink/"+c.replace(/\//g,"~")+"/column/"+this.id+"/title/"+this.title+"/url/"+this.url.replace(/\//g,"~")+"/sort/"+this.flags.SORT+"/highlight/"+b.attr("id")};column.prototype.markCurrent=function(a){$(".Post.current").removeClass("current");a.addClass("visited").addClass("current")};column.prototype.initializeUpdateScoresLoop=function(d,b){if(b){this.pagesActive.push(d)}var c=this;var a=this.connection;c.updateIntervalPages.push(setInterval(function(){c.fetchDataAfter(d,function(g){for(var f in g){var e=g[f].data;if(!e){continue}a.getLocalStorageCache(e.name,function(i){var h=c.postContainer.find("#"+e.id);h.find(".Score").text(g[f].data.score);if(i.num_comments=="reload"){i.num_comments=e.num_comments;self.connection.updateLocalStorageCache(e.name,i,2)}else{if(typeof i.num_comments!="undefined"&&e.num_comments>i.num_comments){h.find("#commentInfo").html(" - "+e.num_comments+' comments <span id="newComments">('+(e.num_comments-i.num_comments)+" new)</span>")}}})}})},60000))};column.prototype.prependNewPosts=function(){var b=this;var c=this.firstPost;var a=[];this.fetchDataAfter(null,function(g){var f=b.activePosts;var k=g.length;for(var h=0;h<k;h++){var m=g[h].data.name;if(m==c){break}if(f[m]){continue}a.push(g[h])}if(a.length>0){b.firstPost=g[0].data.name;var n=b.postContainer.scrollTop();var j=b.createPostBuffer(a,false);if(n>40){var e=$("<div>"+j+"</div>").insertAfter(b.searchElements.parent());var d=parseInt(e.outerHeight());e.replaceWith(j);b.postContainer.scrollTop(n+d)}else{var e=$('<div class="dynamicNewPosts noOpacity" style="position: absolute; top: -1000px">'+j+"</div>").insertAfter(b.searchElements.parent());var l=e.height();e.css({position:"static",height:"0px"});e.animate({height:l},250,function(){e.css("height","auto")});setTimeout(function(){e.replaceWith(j)},600)}b.applyFilter(b.currentFilterText)}b.count+=a.length;if(b.count>74){b.content.addClass("noAnimate")}},(b.title=="Subscribed")?true:false)};column.prototype.refreshInterval=function(b){if(b==false){this.refreshIntervalRunning=false;clearInterval(this.refreshIntervalId);return}if(this.url=="/"&&this.flags.SORT=="new"){this.refreshTime=30000}else{if(this.flags.SORT=="new"){this.refreshTime=180000}}this.refreshIntervalRunning=true;var a=this;clearInterval(this.refreshIntervalId);this.refreshIntervalId=setInterval(function(){a.prependNewPosts.call(a)},this.refreshTime)};column.prototype.widthChanger=function(a){if(a.find("input").length!=0){return}var c=this;var d=a.find("#width");d.hide();var b=$('<input class="widthSettingInput" value="'+d.html()+'">').insertAfter(d).focus().select();b.on("keypress",function(e){var h=e||window.event;var f=h.keyCode||h.which;f=String.fromCharCode(f);var g=/[0-9]|\./;if(!g.test(f)){h.returnValue=false;if(h.preventDefault){h.preventDefault()}}});b.bind("keydown",function(f){f.stopPropagation();if(event.keyCode==13){c.width=parseInt($(this).val());if(c.width>$(document).width()-140){c.width=$(document).width()-140}if(c.width<100){c.width=100}c.tabManagerObj.resizeColumn(c.id,c.width)}})};column.prototype.applyFilter=function(b){var a=this;this.filterTimeout=setTimeout(function(){if(b==""&&a.currentFilterText==""){return}a.currentFilterText=b;content=a.content;if(b.length==0){content.find(".Post").show();content.find("#searchElements #removeContents").hide();return}content.find("#searchElements #removeContents").show();var c=content.find(".Post");c.show();setTimeout(function(){c.filter(':not(:icontains("'+b+'"))').hide()},250)},250)};column.prototype.setTitle=function(c,b){if(typeof c!="function"&&typeof c!="undefined"){this.tabManagerObj.setTitle(this.id,c,b);this.title=c;this.selector.find(".ColumnTitle .title").html(c);return}var a=this;promptFancy("Enter a new title for this column",function(d){if(!d){if(typeof c=="function"){c(false)}return}d=d.replace(/<(.*?)>/g,"").trim();a.setTitle(d,b);if(typeof c=="function"){c(true)}},"text",a.title)};column.prototype.manageSubreddits=function(){var c=this.connection;var b=this;var h=("/"+this.url).indexOf("/r/");var e=(h!=-1)?this.url.substring(h+2):this.url;if(e.charAt(e.length-1)=="/"){e=e.substring(0,e.length-1)}var g='<div id="addSubreddit"></div>';var f='<button class="left" data-message="close"><i class="icon-remove"></i><span>&nbsp;&nbsp;Close</span></button> <button id="saveButton" class="green" data-message="save"><span><i class="icon-ok"></i>&nbsp;&nbsp;Save</span></button>';var d=null;var a=$.popup({id:"manageSubreddits",title:"Manage Subreddits",message:g,buttons:f},function(j,i){if(j=="save"){d.subreddits(function(l){if(l.length>0){var o=capitalize(l).join(", ");var k=("/r/"+l.join("+")+"/").toLowerCase();var n=k.replace(/\//g,"-");var m=b.tabManagerObj.setUrl(b.id,k,false);if(!m){alert("You already have a column with these subreddits.");return}else{b.url=k;b.id=n;b.subreddit=l.join("+");b.setTitle(o);b.refresh();j="close"}}})}return j});d=new subredditSelector(c,a.find("#addSubreddit"),e.split("+"),function(i){if(i.length>0){a.find("#saveButton").show()}else{a.find("#saveButton").hide()}})};function redditpost(f,e,b,d,a){a.loaded=function(){a.markCurrent($('[data-postid="'+f+'"]'))};var c=this;this.id=redditpost.prototype.incriment++;var c=this;this.permalink=e;this.columnObject=a;this.subreddit=a.subreddit;this.columnURL="/r/"+this.subreddit+"/";this.selector=b;this.connection=d;this.postid=f;this.name="t3_"+f;this.selector=b;this.storedComments={};this.storedTagBuffers={};d.setting("enableFlair",function(g){if(g&&!window.forceFlairOff){d.buildFlairCSS(c.subreddit)}});d.userVariable("commentSortType",function(g){c.sort=(typeof g=="undefined")?"hot":g});this.connection.getLocalStorageCache(this.name,function(i){c.lastViewed=(typeof i.lastViewed=="undefined")?9999990037210:i.lastViewed;var h=Date.now();i.lastViewed=Math.floor(h/1000);c.storage=i;c.connection.updateLocalStorageCache(c.name,i,2);var g=(e.indexOf(".json")==-1)?e+".json?sort="+c.sort:e;d.getpost(f,g,function(j){c.drawHeader.call(c,j)},function(j){c.drawComments.call(c,j)})});return this}redditpost.prototype.incriment=1;redditpost.prototype.replyBar=undefined;redditpost.prototype.deconstructor=function(){this.bindings(false)};redditpost.prototype.bindings=function(b){var e=this.id;var l=this;var c=this.selector;if(!b){$(window).unbind(".postview"+e);c.off(".postview"+e);$("body").off(".postview"+e);if(typeof this.replyBar!="undefined"){this.replyBar.close()}if(this.sort=="new"&&this.refreshTime!=0){this.refreshInterval(false)}return}var k;c.on("mouseenter.postview"+e,".Comment",function(m){var n=$(this);n.addClass("highlighted");n.parent().removeClass("highlighted");clearTimeout(k);k=setTimeout(function(){var o=c.find(".highlighted").last();c.find(".highlighted").removeClass("highlighted");o.addClass("highlighted");l.showCommentTools(n)},100)}).on("mouseleave.postview"+e,".Comment",function(m){var n=$(this);n.removeClass("highlighted");n.find(".highlighted").removeClass("highlighted");n.parent().addClass("highlighted")});c.on("click.postview"+e,".Comment",function(m){l.scrollToComment.call(l,$(this));m.stopPropagation()});c.on("click.postview"+e,"#navigateBy",function(m){l.navigateByInvoke(true);c.find("#CommentContent").addClass("navigateBy")});c.on("click.postview"+e,"#scrollToTop",function(m){l.selector.animate({scrollTop:"0px"})});c.on("click.postview"+e,"#navigateDone",function(m){l.navigateByInvoke(false);c.find("#CommentContent").removeClass("navigateBy")});c.on("click.postview"+e,"#navigateNext",function(m){l.navigateBySwitch("next",l.navigateBy.type)});c.on("click.postview"+e,"#navigatePrev",function(m){l.navigateBySwitch("prev",l.navigateBy.type)});c.on("click.postview"+e,".setNavigateType",function(n){var o=$(this);c.find(".commentButton.selected").removeClass("selected");o.addClass("selected");var m=o.attr("type");l.navigateBySwitch("next",m)});c.on("click.postview"+e,".setNavigateTypeUser",function(m){l.navigateBySelectUser($(this))});c.on("click.postview"+e,"#navigateByIterator",function(n){var m=l.navigateBy.type;l.navigateByInput($(this).find("#inputContainer"),parseInt($(this).find("#maxCount").text()),m)});c.on("click.postview"+e,".setNavigateTypeSearch",function(m){promptFancy("Type something to search for",function(n){if(!n){return}l.navigateBySearch=n;l.navigateBySwitch("next","Search")},"input",(typeof l.navigateBySearch=="undefined")?"":l.navigateBySearch)});c.on("click.postview"+e,".uTag",function(m){l.manageTags($(this).parent().parent().find(".Author").html(),$(this).html(),$(this).attr("id"));m.stopPropagation()});c.on("click.postview"+e,".Comment #addTag",function(m){l.manageTags($(this).parent().parent().find(".Author").html());m.stopPropagation()});c.on("click.postview"+e,".showhideleft",function(m){l.toggleHideComments.call(l,$(this).parent().attr("id"));m.stopPropagation()});c.on("click.postview"+e,".editPost",function(m){l.editPostPopup();m.stopPropagation()});c.on("click.postview"+e,".openSubreddit",function(m){l.clickLink("/r/"+l.subreddit,m);m.stopPropagation()});c.on("click.postview"+e,"a[data-ignore!=true]",function(m){l.clickLink.call(l,$(this).attr("href"),m);m.stopPropagation()});c.on("click.postview"+e,".CommentPermalinkContainer",function(m){l.copyLink($(this).parent().parent().attr("id").split("_").pop());m.stopPropagation()});c.on("click.postview"+e,".CommentPermalinkVisitContainer",function(m){l.visitPermalink($(this).parent().parent().attr("id").split("_").pop());m.stopPropagation()});c.on("click.postview"+e,".CommentSourceContainer",function(m){l.viewSource($(this).parent().parent().attr("id").split("_").pop());m.stopPropagation()});c.on("click.postview"+e,"#commentSort",function(m){l.sortCommentsDropdown.call(l,$(this),m);m.stopPropagation()});c.on("click.postview"+e,".postbutton.more",function(m){l.loadMoreComments.call(l,$(this),m);m.stopPropagation()});c.on("click.postview"+e,".Author",function(m){l.openUserInfo($(this).text());m.stopPropagation()});c.on("click.postview"+e,".copyLink",function(m){l.copyPostLink();m.stopPropagation()});c.on("click.postview"+e,".copyLinkUrl",function(m){l.copySiteLink();m.stopPropagation()});c.on("click.postview"+e,".visitLink, .actualTitle",function(m){l.visitPostLink();m.stopPropagation()});c.on("click.postview"+e,".openReddit",function(m){l.openReddit();m.stopPropagation()});c.on("click.postview"+e,"#reloadComments",function(){l.refreshComments()});c.on("click.postview"+e,"#loadAllComments",function(){$(".postbutton.more").click()});c.on("click.postview"+e,"#highlightNewToggle",function(){l.toggleHighlightNewComments($(this))});c.on("click.postview"+e,".savePost",function(){l.savePost($(this))});c.on("click.postview"+e,".removePost",function(){l.removePost($(this))});c.on("click.postview"+e,".reportPost",function(){l.reportPost($(this))});c.on("click.postview"+e,".openProfile",function(){l.openUserInfo(l.author)});c.on("click.postview"+e,".galleryFromPost",function(){l.columnObject.openGallery("fromPost")});c.on("click.postview"+e,".contentPreview img",function(){var n=$(this);var m=n.attr("data-url");imageZoom(m?m:n.attr("src"),n.attr("data-title"),parseInt(n.attr("data-key")),l.articleImageArray,l.articleCaptionArray,l.articlePreviewArray)});c.on("click.postview",".inlineContentArea img",function(o){o.stopPropagation();var n=$(this);var m=n.attr("data-url");imageZoom(n.attr("src"),n.attr("data-title"),parseInt(n.attr("data-key")),l.articleImageArray,l.articleCaptionArray,l.articlePreviewArray)});c.on("click.postview",".inlineViewHandle",function(m){m.stopPropagation();l.inlineView($(this))});var d=$("#header_container").height();var f=c.find(".commentsStickPlaceholder");var h=c.find(".commentsStick");var a=h[0];var j=false;var g;c.scroll(function(m){if(f.offset().top<d){if(!j){j=true;h.addClass("stick").css("top",$("#header_container").height()-1);f.addClass("stick")}}else{if(j){j=false;h.removeClass("stick").css("top","0");f.removeClass("stick")}}return;if(f.offset().top<d){a.style.display="none";clearInterval(g);g=setTimeout(function(){h.css("top",m.target.scrollTop);a.style.display="block";setTimeout(function(){h.css("top",m.target.scrollTop)},500)},250);if(!j){j=true;h.addClass("stick");f.addClass("stick")}}else{h.css("top","0px");j=false;h.removeClass("stick");f.removeClass("stick")}});$(window).bind("resize.postview"+e,function(){l.resize.call(l)});c.on("click.postview"+e,".CommentSaveContainer",function(n){n.stopPropagation();var m=$(this);l.saveComment(m.parent().parent().attr("id").split("_").pop(),m.find(".icon"),m)});c.on("mouseover.postview"+e,'a:not([href="/spoiler"], [href="/c"], [href="/s"])',function(m){smartContentPopup($(this))}).on("mouseleave.postview"+e,'a:not([href="/spoiler"], [href="/c"], [href="/s"])',function(m){smartContentPopupPrevent($(this))});if(connection.loggedin){c.on("click.postview"+e,".ups, .downs",function(){l.upvotePost.call(l,$(this))});c.on("click.postview"+e,".upVote, .downVote",function(m){l.upvoteComment.call(l,$(this));m.stopPropagation()});c.on("click.postview"+e,".reportContainer",function(m){l.reportComment.call(l,$(this).parent().parent().attr("id"),m);m.stopPropagation()});c.on("click.postview"+e,".deleteContainer",function(m){l.deleteComment.call(l,$(this).parent().parent().attr("id"),m);m.stopPropagation()});var i=function(){l.createReplyBar("Post",l.name,"","post")};c.on("click.postview"+e,"#replyGlobal",i);c.on("click.postview"+e,".replyContainerButton, .editContainerButton",function(q){q.stopPropagation();var n=$(this).parent().parent().attr("id");var m=$(this).parent().parent().find(".Author").html();var p=($(this).hasClass("editContainerButton"))?"edit":"comment";var o=(p=="edit")?l.storedComments[n]:"";l.createReplyBar(m,n,o,p)})}};redditpost.prototype.openUserInfo=function(b){var a=new userInfo(b,this.connection,this.columnObject.tabManagerObj)};redditpost.prototype.inlineView=function(c){var d=c.prev("a");var b=d.attr("href");var a=c.next(".inlineContentArea");if(a.length==0){c.after('<div class="inlineContentArea"><div class="loadingcss"></div></div>').html("-");a=c.next(".inlineContentArea");infoHandler(b,function(f,g){if(f.indexOf("<center>")==0){a.html($(f).html())}else{a.html(f)}if(typeof g=="function"){var e=g(a)}},800,600)}else{c.html("+");a.remove()}};redditpost.prototype.createReplyBar=function(g,e,f,d){var c=this;var a=this.selector;var b=this.connection;b.setting("textPreviewsEnabled",function(h){if(d=="edit"){var i=false;i=new replyBar(b,f,"Editing Comment","edit_"+e,function(j){this.loading(true);b.editPost(e,j,function(k,l){c.storedComments[e]=k;if(l=="error"){alert("Reddit rejected your edit, please reload Reditr and try again later.");i.loading(false);return}a.find("#"+e+".Comment > .md, #"+e+".Comment > .commentBody > .md").replaceWith('<div class="md">'+l+"</div>");i.clearDraft();i.close();c.replyBar=undefined})},false,h);if(i){c.replyBar=i}}else{var i=false;i=new replyBar(b,f,"Replying to "+g,"reply_"+e,function(j){this.loading(true);b.setting("signature",function(k){b.comment(e,c.subreddit,j+"\n\n"+k,function(p,l){if(!p||l!="SUCCESS"){if(l=="FREQUENCY"){alert("You must wait 5 minutes before posting again.")}else{if(l==403){alert('Reddit has returned a 403 forbidden error, stating: "you are not allowed to do that".')}}this.loading(false);return}var q=(d=="post"?18:30);var o="c";if(d=="comment"){o=(a.find("#"+e+".Comment").hasClass("c")?"cc":"c")}var m=p.jquery[q][3][0][0].data;var n=[];n[0]={data:{likes:true,author:b.user.name,name:m.id,id:m.id.replace("t1_",""),ups:1,downs:0,created_utc:Date.now()/1000,replies:null,body_html:m.contentHTML,body:j}};c.createCommentBuffer(n,o,function(r){c.storage.num_comments=++c.num_comments;c.connection.updateLocalStorageCache(c.name,c.storage,2);if(d=="post"){a.find("#CommentContent").prepend(r)}else{a.find("#"+e+".Comment").append(r)}i.loading(false);i.clearDraft();i.close();c.replyBar=undefined})})})},false,h);if(i){c.replyBar=i}}})};redditpost.prototype.drawHeader=function(r){if(typeof r.domain=="undefined"){r.domain="";r.url=""}var n=this.subreddit=r.subreddit;var l=this;var j=this.connection;if(r.domain.indexOf("self.")!=-1){this.selftext=r.selftext}var d=this.url=r.url;this.author=r.author;var m=this.authorLowercase=(typeof r.author=="undefined")?"":r.author.toLowerCase();this.num_comments=r.num_comments;var o=this.permalink.match(/r\/(.*?)\/comments\/(.*?)\/(.*?)\//);if(o){columnObject=this.columnObject;var t="~r~"+o[1]+"~comments~"+o[2]+"~"+o[3]+"~.json";var b="#/Home/post/"+this.postid+"/highlight/"+this.postid+"/permalink/"+t+"/column/"+columnObject.id+"/title/"+columnObject.title+"/url/"+columnObject.url.replace(/\//g,"~")+"/sort/"+columnObject.sort;j.addHistory("("+columnObject.title+") "+r.title,b,d)}var h=this.likes=r.likes;var g=this.ups=r.ups;var a=this.downs=r.downs;var q=this.selector;var c=parseInt(r.created_utc);var i=formatDate(c);this.storage.num_comments=r.num_comments;j.updateLocalStorageCache(r.name,this.storage,2);var p='<div class="header"> 					  <div id="mainPostTitle" class="posttitle"><span class="domain">('+r.domain+')</span> <span class="actualTitle">'+r.title+'</span> </div> 					  <div class="politics"> 					  	 <div class="upbutton '+((h)?"upsliked":"ups")+'"><i class="icon-arrow-up"></i><span>&nbsp;&nbsp;'+g+'</span> up</div> 					  	 <div class="downbutton '+((h==false)?"downsliked":"downs")+'"><i class="icon-arrow-down"></i><span>&nbsp;&nbsp;'+a+'</span> down</div> 					  	 <div style="clear: both"></div> 					  </div> 				   </div> 				   <div class="headerStatistics"> 				   		<div class="datedata">submitted <span class="'+i[1]+'" data-timestamp="'+c+'">'+i[0]+'</span> by <span class="Author">'+r.author+'</span> <span class="'+m+'userTagList"></span></div> 				   		<div class="comments">'+r.num_comments+" comments</div> 				   </div>";if(typeof j.user.username=="undefined"){j.user.username=""}var v=(typeof r.author=="undefined")?"":j.user.username.toLowerCase();var e=(r.domain.indexOf("self.")!=-1&&m==v)?'<button class="editPost openContainer"><i class="icon-pencil"></i>   Edit Post</button>':"";var s=(j.ismod("/r/"+n+"/")?'<button class="removePost openContainer"><i class="icon-trash"></i>   Remove</button>':"");var u=(!j.ismod("/r/"+n+"/")&&m==v?'<button class="deletePost openContainer"><i class="icon-trash"></i>   Delete</button>':"");var k=$('<div id="buttonContainer"> 						  '+((n.toLowerCase()==l.columnObject.subreddit)?"":'<button class="openSubreddit openContainer"><i class="icon-list-ul"></i>   /r/'+n+'<div id="inner"></div></button>')+" 						  "+(infoHandler(d.toLowerCase(),false)?'<button class="galleryFromPost openContainer"><i class="icon-camera"></i>   View in Gallery<div id="inner"></div></button>':"")+"						  "+e+' 						  <button class="savePost openContainer"><i class="icon-save"></i>'+(r.saved?"   Un-":"   ")+'Save<div id="inner"></div></button> 						  <button class="reportPost openContainer"><i class="icon-flag"></i>   Report<div id="inner"></div></button> 						  '+s+u+' 					      <button class="openProfile openContainer"><i class="icon-user"></i>   '+r.author+'\'s Profile<div id="inner"></div></button> 					      <button id="copyLink" class="copyLink openContainer"><i class="icon-copy"></i>   Copy Reddit<div id="inner"></div></button> 						  <button id="openReddit" class="openReddit openContainer"><i class="icon-eye-open"></i>   Open Reddit<div id="inner"></div></button> 					      '+((d.indexOf("reddit.com")==-1)?'<button id="copyLinkUrl" class="copyLinkUrl openContainer"><i class="icon-copy"></i>   Copy Link<div id="inner"></div></button>':"")+' 					      <button class="visitLink openContainer"><i class="icon-link"></i>   Open Link<div id="inner"></div></button> 					  </div>').prependTo(q);var f=$('<div class="contentPreview"> <div class="bigLoadingText"> loading post content </div> </div>').prependTo(q);q.find(".loadingcss").remove();q.prepend(p);infoHandler(d,function(x,y){f.html(x);if(typeof y=="function"){var z=y(f);if(z=="parseBareSource"){var w="https://ajax.googleapis.com/ajax/services/search/images?v=1.0&q="+r.title.substr(0,100)+"&callback=?";$.getJSON(w,function(C){var C=C.responseData.results;var F=C.length;if(F==0){return}var B=['<div id="bareSourceImages" class="contentPreview"><div class="infoDescription">'];var G=l.articleImageArray=[];var E=l.articleCaptionArray=[];var A=l.articlePreviewArray=[];for(var D=0;D<F;D++){var J=C[D];var I=J.titleNoFormatting;var H=I.search(/(\-|\||::)/);if(H!=-1){I=$.trim(I.substring(0,H-1))}I+=" ("+J.visibleUrl+")";B.push('<div class="img"><img data-key="'+D+'" data-title="'+I+'" data-url="'+J.unescapedUrl+'" src="'+J.tbUrl+'"><div class="imgtitle"><span>'+I+"</div></span></div>");G.push(J.unescapedUrl);E.push(I);A.push(J.tbUrl)}B.push("</div></div>");$(B.join("")).insertBefore(f)})}}},q.width()-20,q.height()/2);j.setting("highlightNew",function(w){l.commentsHeader=$('<div class="commentsStickPlaceholder"></div> 								 <div class="commentsHeader commentsStick"> 									<div class="title"> 										 <a data-ignore=true class="commentButton Button" id="replyGlobal"><i class="icon-comments-alt"></i>   Reply<div id="inner"></div></a><div class="commentAmount">'+r.num_comments+' Comments</div>									</div> 									<div id="commentButtonsContainer"> 										<span id="navigateControls"> 											<span id="navigateByIterator"></span> 											<div class="navigateByTypeContainer"> 												<div class="upper"> 													<a data-ignore=true type="Hot" class="setNavigateType commentButton Button"><i class="icon-fire"></i>   Hot<div id="inner"></div></a> 													<a data-ignore=true type="Time" class="setNavigateType commentButton Button"><i class="icon-dashboard"></i>   Time<div id="inner"></div></a> 													<a data-ignore=true type="DirectReplies" class="setNavigateType commentButton Button"><i class="icon-sitemap"></i>   Direct Replies<div id="inner"></div></a> 												</div> 												<a data-ignore=true type="Search" class="setNavigateTypeSearch commentButton Button"><i class="icon-search"></i>   Search<div id="inner"></div></a> 												<a data-ignore=true type="Submitter" class="setNavigateType commentButton Button"><i class="icon-user-md"></i>   Poster<div id="inner"></div></a> 												<a data-ignore=true type="New" class="setNavigateType commentButton Button"><i class="icon-asterisk"></i>   New<div id="inner"></div></a> 												<a data-ignore=true type="Mod" class="setNavigateType commentButton Button"><i class="icon-legal"></i>   Mod<div id="inner"></div></a> '+(j.loggedin?'<a data-ignore=true type="Friend" class="setNavigateType commentButton Button"><i class="icon-group"></i>   Friend<div id="inner"></div></a> 												<a data-ignore=true type="Me" class="setNavigateType commentButton Button"><i class="icon-user"></i>   Me<div id="inner"></div></a> ':"")+'<a data-ignore=true type="Links" class="setNavigateTypeUser commentButton Button"><i class="icon-link"></i>   User<div id="inner"></div></a> 												<a data-ignore=true type="Deleted" class="setNavigateType commentButton Button"><i class="icon-remove-sign"></i>   Deleted<div id="inner"></div></a> 												<a data-ignore=true type="Answered" class="setNavigateType commentButton Button"><i class="icon-check"></i>   Answer<div id="inner"></div></a> 												<a data-ignore=true type="Images" class="setNavigateType commentButton Button"><i class="icon-picture"></i>   Pic<div id="inner"></div></a> 												<a data-ignore=true type="Links" class="setNavigateType commentButton Button"><i class="icon-link"></i>   Link<div id="inner"></div></a> 											</div> 											<a data-ignore=true id="navigateDone" class="commentButton Button"><i class="icon-ok"></i>   Done<div id="inner"></div></a> 											<a data-ignore=true id="navigatePrev" class="commentButton Button"><i class="icon-arrow-left"></i>   Prev<div id="inner"></div></a> 											<a data-ignore=true id="navigateNext" class="commentButton Button"><i class="icon-arrow-right"></i>   Next<div id="inner"></div></a> 										</span> 										<span id="primaryControls"> 											<a data-ignore=true id="navigateBy" class="commentButton Button"><i class="icon-globe"></i>   Navigate By<div id="inner"></div></a> 											<a data-ignore=true id="scrollToTop" class="commentButton Button"><i class="icon-circle-arrow-up"></i>   Scroll Top<div id="inner"></div></a> 											<a data-ignore=true id="highlightNewToggle" class="commentButton Button"><i class="icon-magic"></i>'+(w?"   Don't Highlight":"   Highlight New")+'<div id="inner"></div></a> 											<a data-ignore=true id="loadAllComments" class="commentButton Button"><i class="icon-asterisk"></i>   Load All<div id="inner"></div></a> 											<a data-ignore=true id="reloadComments" class="commentButton Button"><i class="icon-refresh"></i>   Reload<div id="inner"></div></a> 											<a data-ignore=true id="commentSort" class="commentButton Button">'+l.sort+'<div id="inner"></div></a> 											<div id="commentSortTypes" class="right dropDown">												<div class="item">hot</div>												<div class="item">new</div>												<div class="item">controversial</div>												<div class="item">top</div>												<div class="item">old</div>												<div class="item">best</div>											</div> 										</span> 									</div> 								</div>').appendTo(q);l.comments=$('<div id="CommentContent"> <div class="bigLoadingText downloadingComments"> loading comments </div> </div>').appendTo(q);l.bindings(true)})};redditpost.prototype.drawComments=function(c,b){var a=this;this.createCommentBuffer(c,undefined,function(d){a.comments.html(d+'<div id="end"></div>');a.connection.setting("load_all_comments_automatically",function(e){if(e){$(".postbutton.more").click()}})})};redditpost.prototype.createCommentBuffer=function(c,m,n){var b=this.connection;var p=this;var i=this.storage;var d=this.subreddit;var e=d.toLowerCase();var h=this.storedTagBuffers;var k=this.authorLowercase;var o;var l=this.lastViewed;var f=[];var j=b.ismod(this.columnURL);var g=b.user.username.toLowerCase();var a=(k==g&&typeof this.selftext!="undefined")?true:false;b.tags(function(q){b.setting("highlightNew",function(s){var r=s?"newComment ":"fakeNewComment ";function u(y,E,O){var M=y.length;for(var L=0;L<M;L++){if(y[L].kind=="more"){var D=y[L].data.children;D=D.join(",");f.push('<div data-children="'+D+'" class="postbutton more">'+y[L].data.count+" more comments</div>");continue}var J=y[L].data;var N=J.author.toLowerCase();if(J.author==null){J.author="[deleted]"}if(J.created_utc>l&&g!=N){var C=r;if(a&&J.parent_id.substr(0,2)=="t3"){b.markRead(J.name,function(){clearTimeout(o);o=setTimeout(function(){window.userNotifications.scan()},1000)})}else{if(O==g){b.markRead(J.name,function(){clearTimeout(o);o=setTimeout(function(){window.userNotifications.scan()},1000)})}}}else{var C=""}var K=(i[J.name+"_hidden"])?true:false;if(J.likes==true){var I="Likes"}else{if(J.likes==false){var I="DisLikes"}else{var I=""}}if(b.loggedin&&g==N){p.storedComments[J.name]=J.body}var A=parseInt(J.created_utc);var F=formatDate(A);var Q=(J.author_flair_text!=null)?' - <span class="'+e+" flair flair-"+J.author_flair_css_class+'">'+J.author_flair_text+"</span>":"";var P="";if(typeof q[N]!="undefined"){if(typeof h[N]=="undefined"){var H=q[N];var B=H.length;for(var G=0;G<B;G++){P+='<div id="'+G+'" class="uTag" style="background-color: '+H[G].b+"; color: "+H[G].c+'">'+H[G].t+"</div>"}h[N]=P;if(k==N){p.selector.find(".headerStatistics ."+N+"userTagList").html(P);p.tookCareOfAuthorTags=true}}else{P=h[N]}}var z=decode_html_entities(J.body_html);z=z.replace(/<\/a>/gi,'</a><span class="inlineViewHandle">+</span>');f.push('<div data-timeposted="'+A+'" class="user-'+N+" "+(J.author==p.author?"OP ":"")+C+"Comment "+E+(K?" hidden":"")+'" id="'+J.name+'"> 									<div data-postid="'+J.id+'" class="Voting"><div class="upVote '+I+'"></div><div class="Score">'+(J.ups-J.downs)+'</div><div class="downVote '+I+'"></div></div> 									<div class="AuthorContainer"><span class="Author">'+J.author+'</span><span class="'+N+'userTagList">'+P+'</span><div class="icon tag" id="addTag"><div class="tagTip">Manage Tags</div></div></div>'+Q+'<div class="commentBody">'+z+'</div><span class="commentPostedTime '+F[1]+'" data-timestamp="'+A+'">'+F[0]+'</span><div class="showhideleft"></div>');if(typeof J.replies=="object"&&J.replies!=null){u(J.replies.data.children,(E=="c"?"cc":"c"),J.author)}f.push("</div>")}}u(c,(typeof m=="undefined")?"c":m);if(p.tookCareOfAuthorTags!=true&&typeof q[k]!="undefined"){var t=q[k];var w=t.length;var x="";for(var v=0;v<w;v++){x+='<div id="'+v+'" class="uTag" style="background-color: '+t[v].b+"; color: "+t[v].c+'">'+t[v].t+"</div>"}h[k]=x;p.selector.find(".headerStatistics ."+k+"userTagList").html(x);p.tookCareOfAuthorTags=true}n(f.join(""))})})};redditpost.prototype.refreshIntervalRunning=false;redditpost.prototype.refreshTime=10000;redditpost.prototype.refreshInterval=function(b){if(b==false){this.refreshIntervalRunning=false;clearInterval(this.refreshIntervalId);return}this.refreshIntervalRunning=true;var a=this;this.refreshIntervalId=setInterval(function(){a.prependNewComments.call(a)},this.refreshTime)};redditpost.prototype.refreshComments=function(){var a=this;var b=this.permalink.replace(/post\/(.*?).json/,"post.json").replace(/\?context=3|context=3/,"");this.connection.getLocalStorageCache(a.name,function(d){a.lastViewed=(typeof d.lastViewed=="undefined")?9999990037210:d.lastViewed;var c=Date.now();d.lastViewed=Math.floor(c/1000);d.num_comments="reload";a.storage=d;a.connection.updateLocalStorageCache(a.name,d,2);$('[data-postid="'+a.postid+'"] #newComments').remove();a.comments.html('<div class="loadingcss"></div>').addClass("loading");connection.getcomments(b,a.sort,function(g,f){if(g.length==0){a.comments.html("");return}a.commentsHeader.find(".posttitle").html(f+" Comments");a.storedComments=g;a.firstPost=a.storedComments[0].data.name;a.drawComments.call(a,g,false)})})};redditpost.prototype.savePost=function(b){var a=this;if(b.text()=="   Save"){b.text("   Un-save");a.connection.savePost(a.name)}else{b.text("   Save");a.connection.unsavePost(a.name)}};redditpost.prototype.removePost=function(b){var a=this;if(b.text()=="   Remove"){b.text("   Click to confirm")}else{if(b.text()=="   Click to confirm"){b.text("   Removed");a.connection.remove(a.postid,false,a.subreddit)}}};redditpost.prototype.deletePost=function(b){var a=this;if(b.text()=="   Delete"){b.text("   Click to confirm")}else{if(b.text()=="   Click to confirm"){b.text("   Deleted");a.connection.deletepost(a.postid,a.subreddit)}}};redditpost.prototype.reportPost=function(b){var a=this;if(b.text()=="   Report"){b.text("   Click to confirm")}else{if(b.text()=="   Click to confirm"){b.text("   Reported");a.connection.report(a.name)}}};redditpost.prototype.prependNewComments=function(){var b=this;var a=[];var c=b.firstPost;connection.getcomments(b.permalink,b.sort,function(g){var e=b.storedComments;var d=g.length;for(var f=0;f<d;f++){var h=g[f].data.name;if(h==c){break}if(e[h]){continue}a.push(g[f])}if(a.length>0){b.firstPost=a[a.length-1];b.createCommentBuffer(a,undefined,function(j){var i=$("<div>"+j+"</div>").prependTo(b.comments)})}})};redditpost.prototype.copyLink=function(b){var c=this.permalink.match(/r\/(.*?)\/comments\/(.*?)\/(.*?)\//);var a="http://reddit.com/r/"+c[1]+"/comments/"+c[2]+"/"+c[3]+"/"+b+"?context=3";clipboard_set(a);return a};redditpost.prototype.copySiteLink=function(){var a=this.url;clipboard_set(a);return a};redditpost.prototype.copyPostLink=function(){var a="http://reddit.com"+this.permalink.replace(".json","");clipboard_set(a);return a};redditpost.prototype.editPostPopup=function(){var a=this;var b='<div class="incontainer"><textarea style="margin-bottom: -3px;" id="editPostContent">'+a.selftext+"</textarea></div>";var c=$.popup({id:"editpost",title:"Edit Post",message:b,buttons:'<button class="left Button" id="close" data-message="close"><i class="icon-remove"></i><span>&nbsp;&nbsp;Close</span></button><div id="optionButtons" class="buttongroup"><button class="Button" data-message="submit"><i class="icon-ok"></i><span>&nbsp;&nbsp;Save</span></button></div>'},function(e){if(e=="submit"){a.selector.find(".infoDescription").html('<div class="loadingcss block"></div>');a.selftext=$("#editpost #editPostContent").val();var d={thing_id:a.name,text:a.selftext,r:a.subreddit,uh:a.connection.user.modhash};a.connection.edituserpost(d,function(g){var f="<div "+$("<div />").html(g).text()+"</div>";a.selector.find(".infoDescription").html(f)});e="close"}return e});$("#editPostContent").autoHeight().css("max-height",parseInt($("body").height()-300)+"px").reditor()};redditpost.prototype.visitPostLink=function(){popupBrowser(this.url)};redditpost.prototype.openReddit=function(){popupBrowser("http://reddit.com/"+this.permalink)};redditpost.prototype.viewSource=function(a,b){var c=$.popup({title:"Loading...",message:"Loading..."},function(d){return d});this.connection.getSingleComment(this.permalink,a,function(d){c.find(".alertTitle").html("You are viewing the source of "+d.author+"'s comment");c.find(".alertText").html('<textarea class="viewSource nomargins">'+d.body+"</textarea>");c.find(".alertText .viewSource").autoHeight()})};redditpost.prototype.visitPermalink=function(b){columnObject=this.columnObject;var d=this.permalink.match(/r\/(.*?)\/comments\/(.*?)\/(.*?)\//);var c="~r~"+d[1]+"~comments~"+d[2]+"~"+d[3]+"~"+b+".json";var a="#/Home/post/"+this.postid+"/permalink/"+c+"/column/"+columnObject.id+"/title/"+columnObject.title+"/url/"+columnObject.url.replace(/\//g,"~")+"/sort/"+columnObject.sort;window.location.href=a;if(typeof this.closeHook=="function"){this.closeHook()}};redditpost.prototype.saveComment=function(c,a,d){var b=this.connection;var f=this.permalink.match(/r\/(.*?)\/comments\/(.*?)\/(.*?)\//);var e="/r/"+f[1]+"/comments/"+f[2]+"/"+f[3]+"/"+c+".json";b.isCommentSaved(c,function(g){if(!g){b.saveComment(c,e);a.addClass("active");d.addClass("active")}else{b.unsaveComment(c);a.removeClass("active");d.removeClass("active")}})};redditpost.prototype.setColumn=function(a){this.columnObject=a};redditpost.prototype.upvotePost=function(a){var e=this.postid;var r=this.selector;var l=this.connection;if(a.hasClass("ups")){var t=true;var u=false;var q="upvote";var s="downbutton";var x="downsliked";var f="downs";var d="downVote";var i="DisLikes";var b=-1;var m=1;var o="ups";var y="upsliked";var v="upVote";var w="Likes";var g=1;var h=1}else{var t=false;var u=true;var q="downvote";var s="upbutton";var x="upsliked";var f="ups";var d="upVote";var i="Likes";var b=-1;var m=-1;var o="downs";var y="downsliked";var v="downVote";var w="DisLikes";var g=1;var h=-1}var k=this.likes;var n=$("body").find(".Post[data-postid="+e+"]").find(".Voting");var p=n.find(".Score");var c=parseInt((p.html()||"0").trim());if(k==u){var j=r.find("."+s);j.removeClass(x).addClass(f);j.find("span").html("&nbsp;&nbsp;"+(this[f]+=b));n.find("."+d).removeClass(i);p.html(c+=m)}a.removeClass(o).addClass(y);a.find("span").html("&nbsp;&nbsp;"+(this[o]+=g));n.find("."+v).addClass(w);p.html(c+=h);l[q](e);this.likes=t};redditpost.prototype.upvoteComment=function(h){var b=this.connection;var l=h.parent();var f=l.find(".Score");var i=parseInt(f.html());var a=l.attr("data-postid");if(h.hasClass("upVote")){var g="upvote";var e="upVote";var c="Likes";var m="DisLikes";var k="downVote";var d=1}else{var g="downvote";var e="downVote";var c="DisLikes";var m="Likes";var k="upVote";var d=-1}if(h.hasClass(e)&&h.hasClass(c)){b.removevote(a);h.removeClass(c);f.html(i-=d);return}var j=l.find("."+k);if(h.hasClass(c)){return}if(j.hasClass(m)){j.removeClass(m);f.html(i+=d)}h.addClass(c);f.html(i+=d);b[g](a)};redditpost.prototype.clickLink=function(b,f,h){f.preventDefault();if(b.search(/.(jpg|jpeg|bmp|gif|png)/i)!=-1){imageZoom(b)}else{if(b.search(/r\/(.*?)\/comments\/(.*?)\//)!=-1){var d=b.match(/r\/(.*?)\/comments\/(.*?)\//);var g=d[2];var c="~r~"+("/"+b).split("/r/").pop().replace(/\//g,"~");var a=(b+"/").match(/\/r\/(.*?)\//).pop();window.location.href="#/Home/post/"+g+"/permalink/"+c+"/column/-r-"+a+"-/url/~r~"+a+"~/title/"+capitalize(a)+"/highlight/"+g;if(typeof this.closeHook=="function"){this.closeHook()}if(typeof h=="function"){h(true)}}else{if((typeof this.postid!="undefined"&&typeof this.permalink!="undefined")&&(b.search(/\/r\/(.*?)$/)!=-1||b.search(/\/r\/(.*?)\/$/)!=-1)){var a=(b+"/").match(/\/r\/(.*?)\/$/).pop();window.location.href="#/Home/post/"+this.postid+"/permalink/"+this.permalink.replace(/\//g,"~")+"/column/-r-"+a+"-/url/~r~"+a+"~/title/"+capitalize(a)+"/highlight/"+g;if(typeof this.closeHook=="function"){this.closeHook()}if(typeof h=="function"){h(true)}}else{if(b.toLowerCase()=="/spoiler"){if(typeof h=="function"){h(false)}return}else{popupBrowser(b);if(typeof h=="function"){h(false)}}}}}};redditpost.prototype.sortCommentsDropdown=function(b,d){var a=this;var c=b.parent();var f=b.next("#commentSortTypes");f.css({top:b.position().top+b.height()+"px",left:(b.position().left-(f.outerWidth()-b.outerWidth()))+"px",display:"block"});f.find(".item").one("click",function(){var e=a.selector;var j=e.find("#commentSortTypes");var g=e.find("#commentSort");var i=$(this);var h=g.text();g.text(i.text());i.text(h);a.sort=g.text();a.connection.userVariable("commentSortType",a.sort);a.refreshInterval(false);a.comments.html('<div class="loadingcss"></div>').addClass("loading");connection.getcomments(a.permalink,a.sort,function(k){a.storedComments=k;a.firstPost=a.storedComments[0].data.name;a.drawComments.call(a,k,false)});if(a.sort=="new"&&a.refreshTime!=0){a.refreshInterval(true)}});setTimeout(function(){$(document).one("click",function(g){f.find(".item").unbind("click");$("#commentSortTypes").hide()})},500)};redditpost.prototype.reportComment=function(a,b){confirmFancy("Are you sure you want to report this comment?",function(c){if(c){self.connection.report(a)}})};redditpost.prototype.deleteComment=function(b,d){var a=this;var c='<button class="right" data-message="true">Yes</button> 				   <button class="left" data-message="close">No</button>';$.popup({title:"Confirm Delete Comment",message:"Are you sure you want to delete this comment?",buttons:c},function(e){if(e=="true"){a.connection.deletePost(b,a.subreddit);var f=$("#"+b);f.find(".Author").first().html("[deleted]");f.find(".md").first().html("[deleted]")}return"close"})};redditpost.prototype.loadMoreComments=function(c,g){var a=this;var d=c.parent();var b=c.text("Loading");var f=redditGetCache(this.postid,"name");if(!f){f="t1_"+this.postid}this.connection.morecomments(c.attr("data-children"),f,this.subreddit,c.parent().attr("id"),function(e){var h=(d.hasClass("c")?"cc":"c");a.createCommentBuffer(e,h,function(i){b.fadeOut(250,function(){c.remove();d.append($(i).fadeIn(500))})})})};redditpost.prototype.resize=function(){};redditpost.prototype.toggleHideComments=function(e){var d=$("#"+e);var c=d.find(".toggleHideIcon");var a=false;var b=(this.storage[e+"_hidden"])?true:false;if(!b){c.removeClass("hide").addClass("show");d.addClass("hidden");a=true}else{c.removeClass("show").addClass("hide");d.removeClass("hidden")}if(!a){delete this.storage[e+"_hidden"]}else{this.storage[e+"_hidden"]=a}this.connection.updateLocalStorageCache(this.name,this.storage,2)};redditpost.prototype.scrollToComment=function(c,b){if(c.hasClass("current")&&!b){c.removeClass("current");return}var a=this.selector;a.find(".Comment.current").removeClass("current");c.addClass("current");var e=(a.height()-c.children(".md").height()-200)/2;var d=c.offset();if(typeof d!="undefined"){d=d.top;clearTimeout(this.scrollToCommentTimeout);this.scrollToCommentTimeout=setTimeout(function(){a.animate({scrollTop:(a.scrollTop()+d-132-e)+"px"})},50)}};redditpost.prototype.hoverOverTitle=function(a,b){if(b){a.scrollAmount=6}else{a.scrollAmount=0}};redditpost.prototype.showCommentTools=function(c){var a=this.connection;var b=a.ismod(this.columnURL);var e=c.find(".Author").html();var d=a.user.name;a.isCommentSaved(c.attr("id").split("_").pop(),function(h){var g=h?" active":"";var f='<div class="Options"> 					  	  '+(a.loggedin?'<div class="iconContainer replyContainerButton"> <div class="icon reply"></div> <a data-ignore="true" class="text Option CommentReply">Reply</a> </div>':"");if(a.loggedin){f+='<div class="iconContainer reportContainer"> <div class="icon report"></div> <a data-ignore="true" class="text Option CommentReport">Report</a> </div> 					  '+((b||d==e)?'<div class="iconContainer deleteContainer"> <div class="icon delete"></div> <a data-ignore="true" class="text Option CommentDelete">Delete</a> </div>':"")+" 					  "+(e==d?'<div class="iconContainer editContainerButton"> <div class="icon edit"></div> <a data-ignore="true" class="text Option CommentEdit">Edit This</a> </div>':"")}f+='<div class="iconContainer CommentSourceContainer"> <div class="icon source"></div> <a data-ignore="true" class="text Option CommentSource">Source</a> </div> 							  <div class="iconContainer CommentPermalinkContainer"> <div class="icon link"></div> <a data-ignore="true" class="text Option CommentPermalink">Copy URL</a> </div> 							  <div class="iconContainer CommentPermalinkVisitContainer"> <div class="icon globe"></div> <a data-ignore="true" class="text Option CommentPermalinkVisit">Permalink</a> </div> 							  <div class="iconContainer CommentSaveContainer'+g+'"> <div class="icon star'+g+'"></div> <a data-ignore="true" class="text Option CommentSave">Save Comment</a> <a data-ignore="true" class="text Option CommentUnsave active">Unsave Comment</a> </div> 					</div>';c.children(".Options").remove();c.append(f)})};redditpost.prototype.manageTags=function(g,e,f){var c=this;var d=g.toLowerCase();var b=this.connection;var a=this.storedTagBuffers;b.tags(function(u){var i=(typeof f=="undefined")?"new":f;function t(y,v){var A=['<select id="listTags"><option value="new:#000000:#FFFFFF:">New Tag</option>'];if(typeof y!="undefined"){var w=y.length;for(var x=0;x<w;x++){var z=y[x].t;A.push("<option "+(v==z?"selected ":"")+'value="'+x+":"+y[x].c+":"+y[x].b+":"+z+'">'+z+"</option>")}}A.push("</select>");return A.join("")}var j=[["#FFFFFF","White"],["#C0C0C0","Silver"],["#808080","Gray"],["#000000","Black"],["#FF0000","Red"],["#800000","Maroon"],["#FFFF00","Yellow"],["#808000","Olive"],["#00FF00","Lime"],["#008000","Green"],["#00FFFF","Aqua"],["#008080","Teal"],["#0000FF","Blue"],["#000080","Navy"],["#FF00FF","Fuchsia"],["#800080","Purple"],["#FF6EC7","Pink"],["#FF5721","Orange"]];var k=j.length;function l(w,z,y){var v='<h3>Font Colour</h3> 						  <select id="fontColour">';for(var x=0;x<k;x++){v+="<option "+(j[x][0]==w?"selected ":"")+"value="+j[x][0]+">"+j[x][1]+"</option>"}v+="</select>";v+='<h3>Background Colour</h3> 					   <select id="backgroundColour">';for(var x=0;x<k;x++){v+="<option "+(j[x][0]==z?"selected ":"")+"value="+j[x][0]+">"+j[x][1]+"</option>"}v+="</select>";v+='<h3>Tag Text</h3> 					   <div class="incontainer"><input data-message="save" id="text" placeholder="Tag Message" value="'+y+'"></div> 					   <h3>Preview</h3> 					   <div id="TagPreviewContainer" style="color: '+w+"; background-color: "+z+'">'+y+"</div>";return v}var r='<button class="left" data-message="close">[suggestedCloseText]</button><button class="right space green" data-message="save">Add</button><button style="display: none" class="right" data-message="delete"><i class="icon-trash"></i><span>&nbsp;&nbsp;Remove Tag</span></button>';var n=(typeof f=="undefined")?l("#000000","#ffffff",""):l(u[d][f].c,u[d][f].b,u[d][f].t);var q,p,h,s,m;var o=$.popup({id:"tagManager",buttons:r,title:"Manage Tags For "+g,message:"<h3>Select Tag</h3>"+t(u[d],e)+'<div id="playground">'+n+"</div>"},function(E,A){if(E=="save"&&i=="new"){var x=o.find("#fontColour").val();var w=o.find("#backgroundColour").val();var D=o.find("#text").val().replace(/<(.*?)>/g,"");if(D==""){return}var y={c:x,b:w,t:D};if(typeof u[d]=="undefined"){u[d]=[]}u[d].push(y);b.tags(u);o.find("#text").val("");p.html("").css("color","black").css("background-color","white");h.replaceWith(t(u[d]));h=o.find("#listTags")}else{if(E=="save"){var x=o.find("#fontColour").val();var w=o.find("#backgroundColour").val();var D=o.find("#text").val().replace(/<(.*?)>/g,"");if(D==""){return}var y={c:x,b:w,t:D};u[d][i]=y;b.tags(u);h.replaceWith(t(u[d],D));h=o.find("#listTags")}else{if(E=="delete"){u[d].splice(i,1);if(u[d].length==0){delete u[d]}b.tags(u);if(typeof u[d]=="undefined"){u[d]=[]}h.replaceWith(t(u[d]));h=o.find("#listTags");o.find("#text").val("");p.html("").css("color","black").css("background-color","white");s.hide();m.html("Add")}}}if(typeof c.storedTagBuffers=="undefined"){c.storedTagBuffers=a={}}var B=u[d];if(typeof B!="undefined"){var v=B.length;var C="";for(var z=0;z<v;z++){C+='<div id="'+z+'" class="uTag" style="background-color: '+B[z].b+"; color: "+B[z].c+'">'+B[z].t+"</div>"}a[d]=C;$("."+d+"userTagList").html(C)}return E});q=o.find("#playground");p=o.find("#TagPreviewContainer");h=o.find("#listTags");s=o.find('button[data-message="delete"]');m=o.find('button[data-message="save"]');o.on("keyup.tagBinding","#text",function(){p.html($(this).val().replace(/<(.*?)>/g,""))});o.on("change.tagBinding","#fontColour",function(){p.css("color",$(this).val())});o.on("change.tagBinding","#backgroundColour",function(){p.css("background-color",$(this).val())});o.on("change.tagBinding","#listTags",function(){var v=$(this).val().split(":");i=v[0];q.html(l(v[1],v[2],v[3]));q=o.find("#playground");p=o.find("#TagPreviewContainer");h=o.find("#listTags");if(i!="new"){s.show();m.html('<i class="icon-ok"></i><span>&nbsp;&nbsp;Save</span>')}else{s.hide();m.html('<i class="icon-plus"></i><span>&nbsp;&nbsp;Add</span>')}});if(typeof e!="undefined"&&typeof f!="undefined"){s.show();m.html('<i class="icon-ok"></i><span>&nbsp;&nbsp;Save</span>')}})};redditpost.prototype.toggleHighlightNewComments=function(a){connection.setting("highlightNew",function(b){if(b){connection.setting("highlightNew",false);a.html("Highlight New");$(".newComment").removeClass("newComment").addClass("fakeNewComment")}else{connection.setting("highlightNew",true);a.html("Don't Highlight");$(".fakeNewComment").removeClass("fakeNewComment").addClass("newComment")}})};redditpost.prototype.navigateByInvoke=function(c){var a=this.selector;if(c){if(typeof this.navigateBy=="undefined"){var b=(this.subreddit.toLowerCase()=="iama")?"Answered":"Hot";this.navigateBy={type:b,navigateByIterator:a.find("#navigateByIterator"),currentItemId:""};a.find('[type="'+b+'"]').addClass("selected");this.navigateBySwitch("next",b)}a.find("#navigateControls").show();a.find("#primaryControls").hide()}else{a.find("#navigateControls").hide();a.find("#primaryControls").show()}};redditpost.prototype.navigateByFetchSelectorMethod=function(h,c){var d=this.selector;var m=this;if(h=="DirectReplies"){c(function(){return d.find("#CommentContent > .Comment")})}else{if(h=="Me"){c(function(){return d.find(".Comment.user-"+this.connection.user.username.toLowerCase())})}else{if(h=="User"){c(function(){return d.find(m.navigateByUsernameSelector)})}else{if(h=="Submitter"){c(function(){return d.find(".Comment.OP")})}else{if(h=="Time"){var f={};var b=[];var l=0.001;d.find(".Comment").each(function(){var n=$(this);var o=parseInt(n.attr("data-timeposted"));if(typeof f[o]!="undefined"){o+=l;l+=0.001}var i=n.attr("id");f[o]=i;b.push(o)});b.sort(function(n,i){return i-n});var g=$();var a=b.length;for(var e=0;e<a;e++){g[e]=$("#"+f[b[e]])[0]}g.length=a;g.context=undefined;c(function(){return g})}else{if(h=="Hot"){var f={};var b=[];var l=0.001;d.find(".Comment").each(function(){var n=$(this);var o=parseInt(n.find(".Voting .Score").html());if(typeof f[o]!="undefined"){o+=l;l+=0.001}var i=n.attr("id");f[o]=i;b.push(o)});b.sort(function(n,i){return i-n});var g=$();var a=b.length;for(var e=0;e<a;e++){g[e]=$("#"+f[b[e]])[0]}g.length=a;g.context=undefined;c(function(){return g})}else{if(h=="New"){c(function(){return d.find(".newComment, .fakeNewComment")})}else{if(h=="Search"){c(function(){return d.find('.Comment:icontains("'+m.navigateBySearch+'")')})}else{if(h=="Deleted"){c(function(){return d.find('.Comment[class*="[deleted]"]')})}else{if(h=="Mod"){this.connection.getModerators(this.subreddit,function(n,o){var i=".user-"+o.join(", .user-");c(function(){return d.find(i)})})}else{if(h=="Friend"){var k="";var j=this.connection.user.friends;for(var e in j){k+=", .user-"+e.toLowerCase()}c(function(){return d.find(k.substr(2))})}else{if(h=="Answered"){var g=$();d.find("#CommentContent > .Comment > .Comment.OP").each(function(){g=g.add($(this).parent())});c(function(){return g})}else{if(h=="Images"){var g=$();d.find(".Comment > .commentBody").each(function(){if($(this).html().search(/(\.png|\.gif|\.jpeg|\.jpg|\.bmp|imgur|tinypic|photobucket|tumblr)/i)!=-1){g=g.add($(this).parent())}});c(function(){return g})}else{if(h=="Links"){var g=$();d.find(".Comment > .commentBody").each(function(){if($(this).html().search(/<a/i)!=-1){g=g.add($(this).parent())}});c(function(){return g})}}}}}}}}}}}}}}};redditpost.prototype.navigateBySwitch=function(b,e){var c=this;var a=this.selector;var d=this.navigateBy;if(d.type!=e||d.currentItemId==""){d=this.navigateBy={navigateByIterator:d.navigateByIterator,type:e,currentItemId:"",alreadyViewed:[]}}this.navigateByFetchSelectorMethod(e,function(f){if(b=="next"){if(d.currentItemId==""){var g=f();if(g.length==0){d.navigateByIterator.html('<span id="inputContainer">0</span> / <span id="maxCount">0</span>');return}var j=g.first();d.currentItemId=j.attr("id");d.counter=1;d.maxItems=g.length;d.alreadyViewed.push(d.currentItemId);d.navigateByIterator.html('<span id="inputContainer">1</span> / <span id="maxCount">'+g.length+"</span>");c.scrollToComment(j,true)}else{var i=d.alreadyViewed;var l=f();var j=undefined;l.each(function(){var m=$(this);if($.inArray(m.attr("id"),i)==-1){j=m;return false}});if(typeof j=="undefined"){d.currentItemId="";c.navigateBySwitch("next",e);return}d.currentItemId=j.attr("id");d.maxItems=l.length;d.alreadyViewed.push(d.currentItemId);d.navigateByIterator.html('<span id="inputContainer">'+ ++d.counter+'</span> / <span id="maxCount">'+l.length+"</span>");c.scrollToComment(j,true)}}else{if(d.currentItemId==""||d.alreadyViewed.length==0){var l=f();var h=d.counter=d.maxItems=l.length;var j=l.last();var i=[];l.each(function(){i.push($(this).attr("id"))});d.alreadyViewed=i;d.currentItemId=j.attr("id");d.navigateByIterator.html('<span id="inputContainer">'+h+'</span> / <span id="maxCount">'+h+"</span>");c.scrollToComment(j,true)}else{var i=d.alreadyViewed;var k=i.pop();if(k==d.currentItemId){if(i.length==0){d.currentItemId="";c.navigateBySwitch("prev",e);return}k=i.pop()}i.push(k);var j=a.find("#"+k);d.currentItemId=j.attr("id");d.navigateByIterator.html('<span id="inputContainer">'+ --d.counter+'</span> / <span id="maxCount">'+d.maxItems+"</span>");c.scrollToComment(j,true)}}})};redditpost.prototype.navigateByInput=function(b,h,f){var d=this;var a=this.selector;var e=this.navigateBy;if(b.find("input").length>0){return}var g=b.html();var c=$('<input value="'+g+'">');b.html(c);c.focus().select();b.off().on("keyup","input",function(i){if(i.keyCode==13){d.navigateByFetchSelectorMethod(f,function(j){var m=parseInt(c.val());if(isNaN(m)){m=1}b.html(m);if(m<1){m=1}if(m>h){m=h}var k=[];var n=j();var l=undefined;count=0;n.each(function(){var o=$(this);k.push(o.attr("id"));if(++count==m){l=o;return false}});if(typeof l=="undefined"){e.currentItemId="";d.navigateBySwitch("next",f);return}e.currentItemId=l.attr("id");e.maxItems=n.length;e.alreadyViewed=k;e.counter=m;e.navigateByIterator.html('<span id="inputContainer">'+m+'</span> / <span id="maxCount">'+n.length+"</span>");d.scrollToComment(l,true)})}})};redditpost.prototype.navigateBySelectUser=function(g){var n=this;var b=this.selector;var c=[];var f={};b.find(".Comment .Author").each(function(){var i=$(this).text();if(typeof f[i]=="undefined"&&i!="[deleted]"){c.push(i);f[i]=true}});c.sort(function(o,i){if(o.toLowerCase()<i.toLowerCase()){return -1}if(o.toLowerCase()>i.toLowerCase()){return 1}return 0});userBuffer="";var a=c.length;for(var e=0;e<a;e++){userBuffer+='<div data-username="'+c[e].toLowerCase()+'">'+c[e]+"</div>"}var k='<button class="green right" data-message="done"><i class="icon-ok"></i><span>&nbsp;&nbsp;Done</span></button> 				   <button class="left" data-message="close">[suggestedCloseText]</button>';var d='<div class="incontainer"><input data-message="close" placeholder="Enter Usernames Here with a space inbetween each" value="'+(typeof n.navigateByUsernameList!="undefined"?n.navigateByUsernameList:"")+'"></div> 				  <div class="userList">'+userBuffer+"</div>";var l=undefined;var j=$.popup({id:"navigateByPopup",buttons:k,title:"Choose Users",message:d},function(p,o){if(p=="done"){var q=l.val();var i=q.toLowerCase();n.navigateByUsernameList=q;n.navigateByUsernameSelector=".user-"+$.trim(i.replace(/  /g," ")).replace(/ /g,", .user-");b.find(".commentButton.selected").removeClass("selected");g.addClass("selected");n.navigateBy={navigateByIterator:n.navigateBy.navigateByIterator};n.navigateBySwitch("next","User");p="close"}return p});l=j.find("input");var h=j.find(".userList div");function m(){var p=l.val();h.filter(".selected, .highlighted").removeClass("selected").removeClass("highlighted");var o='div:icontains("'+$.trim(p.toLowerCase().replace(/  /g," ")).replace(/ /g,'"), div:icontains("')+'")';h.filter(o).addClass("highlighted");var i='[data-username="'+$.trim(p.toLowerCase().replace(/  /g," ")).replace(/ /g,'"], [data-username="')+'"]';h.filter(i).addClass("selected")}if(typeof n.navigateByUsernameList!="undefined"){m()}l.on("keyup",m);j.on("click",".userList div",function(o){o.preventDefault();o.stopPropagation();var p=$(this).html();var i=" "+l.val()+" ";if(i.search(new RegExp(" "+p+" ","i"))==-1){l.val($.trim(i+p).replace(/  /g," ")+" ");$(this).addClass("selected")}else{l.val($.trim(i.replace(new RegExp(" "+p+" ","i")," ")).replace(/  /g," ")+" ");$(this).removeClass("selected")}l.focus();return false})};function notificationsCenter(a,c){this.selector=a;this.connection=c;var b=this;return this}notificationsCenter.prototype.messages=-1;notificationsCenter.prototype.desktopNotification=function(d,c){this.connection.setting("show_desktop_notifications",function(a){if(a){desktopNotification(d,c)}})};notificationsCenter.prototype.startup=function(){var a=this;a.messages=-1;a.scan();this.connection.setting("live_notification_updates",function(b){if(b){a.interval=setInterval(function(){a.scan.call(a)},60000)}});return this};notificationsCenter.prototype.shutdown=function(){clearInterval(this.interval);return this};notificationsCenter.prototype.setBadge=function(a){window.setBadge(a)};notificationsCenter.prototype.scan=function(){var a=this;this.connection.getPosts("/message/unread.json",25,null,function(g){if(g.length==a.amountNew){return}var e=a.amountNew=g.length;a.newItems=g;if(e==0){var f='<div class="info">Messages</div>';a.setBadge("")}else{if(e==1){var f='<div class="messageCount">1</div><div class="info">1 New Message</div>';a.setBadge("1")}else{if(e>1){var f='<div class="messageCount">'+e+'</div><div class="info">'+e+" New Messages</div>";a.setBadge(e)}}}a.selector.html(f);if(e<1){a.selector.removeClass("alert")}else{a.selector.addClass("alert")}if(a.messages!=-1){var b=e-a.messages;var h=false;var c=false;if(b>4){a.desktopNotification("New Messages!","You just received "+b+" new messages.");h=true;c=true}else{for(var d=0;d<b;d++){if(g[d].kind=="t4"){h=true;a.desktopNotification("New message from "+g[d].data.author,g[d].data.body)}else{c=true;a.desktopNotification("You were quoted by "+g[d].data.author,g[d].data.body)}}}}a.messages=e})};notificationsCenter.prototype.restart=function(){this.messages=-1;this.scan()};function notifications(j,b,s){if(typeof s=="undefined"){s={}}if(typeof s.action=="undefined"&&window.userNotifications.amountNew>0&&!s.ignoreDropdown){notifications_messagesDropdown(window.userNotifications.newItems);return false}var n='<div id="leftSide" class="Viewport noSort"></div> 				   <div id="leftSide" class="compose" style="display: none"> 				   <div class="incontainer usernameContainer"> <input id="username" placeholder="Usernames (separate multiple users by space) OR /r/subreddit for modmail"> </div> 				   <div class="incontainer titleContainer"> <input id="title" placeholder="Subject (ie: I found the King of the North!)"> </div> 				   <div class="textcontainer"> <textarea placeholder="Message"></textarea> </div> 				   </div> 				   <div id="rightSide" class="ViewportPost"></div> 				   <div class="clear"></div>';var p='<div class="left"> 					  <select id="messagesType"> 					   	  <option data-message="compose">Compose</option> 					   	  <option data-message="all" selected>All</option> 					   	  <option data-message="unread">Unread</option> 					   	  <option data-message="messages">PMs</option> 					   	  <option data-message="sent">Sent</option> 					   	  <option data-message="comments">Comments</option> 					   	  <option data-message="posts">Posts</option> 					   	  <option data-message="myposts">My Posts</option> 					   	  <option data-message="mod">Mod</option> 				      </select> 				   </div> 				   <div class="right"> 				   		  <button data-message="close" class="close">[suggestedCloseText]</button> 				   		  <button data-message="send" style="display: none" class="send green"><i class="icon-envelope-alt"></i><span>&nbsp;&nbsp;Send</span></button> 				   </div>';var t='<div class="topControls"> <a data-message="checkAll">Select All</a> <a data-message="uncheckAll">Unselect All</a> <a data-message="markRead">Mark Read</a> <a data-message="markUnread">Mark Unread</a></div>';var g=null;var h=false;var k=false;var m,r,i,f,o,c;g=$.popup({title:t,id:"notificationsPopup",message:n,buttons:p},function(D,x){var C=$(this);if(c=="compose"&&D!="compose"&&D!="send"){$(".bottomInterface").show();g.find(".Viewport, .close, .ViewportPost, .alertTitle").show();g.find(".compose, .send").hide()}else{if(c=="myposts"){g.find(".Viewport").addClass("noSort");g.find(".alertTitle").show()}}c=D;if(D=="unread"){m.url="/message/unread.json";m.refresh()}else{if(D=="markRead"){g.find(".Post.checked.unread").each(function(){var F=$(this);var E=F.attr("data-name");j.markRead(E);F.removeClass("unread")});g.find('[data-message="uncheckAll"]').click()}else{if(D=="markUnread"){g.find(".Post.checked").each(function(){var F=$(this);var E=F.attr("data-name");j.markUnread(E);F.addClass("unread")});g.find('[data-message="uncheckAll"]').click()}else{if(D=="checkAll"){g.find(".Post:not(.checked)").trigger("clickCheckbox");g.find('.Post:not(.checked) input[type="checkbox"]').click()}else{if(D=="uncheckAll"){g.find(".Post.checked").trigger("clickCheckbox");g.find('.Post.checked input[type="checkbox"]').click()}else{if(D=="send"){if(k){return}k=true;g.find(".send").addClass("loading");var u=g.find("#username").val().split(" ");var D=g.find("textarea").val();var A=g.find("#title").val();var w=g.find("#captchaEnter").attr("iden");var z=g.find("#captchaEnter").val();var B=false;var y=u.length;for(var v=0;v<y;v++){j.sendMessage(u[v],A,D,w,z,function(E,H){if(E=="BAD_CAPTCHA"){g.find(".send").removeClass("loading");k=false;if(!B){B=true;var G='<img style="margin-left: 10px;margin-bottom: -2px;" id="captchaCode" src="http://reddit.com/captcha/'+H+'.png" />';var F='<div class="titleContainer incontainer">								<input style="width:615px;margin-bottom: 1px;" placeholder="Enter the captcha code above" type="text" iden="'+H+'" id="captchaEnter"> 							</div>';g.find("#title").parent().after(G+F)}else{alert("You entered the captcha incorrectly, try again.");g.find("#captchaCode").attr("src","http://reddit.com/captcha/"+H+".png")}}else{if(E=="noerror"){k=false;g.closePopup()}else{k=false;alert(H);g.find(".send").removeClass("loading")}}})}}else{if(D=="all"){m.url="/message/inbox.json";m.refresh()}else{if(D=="compose"){$(".bottomInterface").hide();g.find(".Viewport, .close, .ViewportPost, .alertTitle").hide();g.find(".compose, .send").show();g.find("#username").focus();if(!h){h=true;g.find("textarea").reditor()}}else{if(D=="sent"){m.url="/message/sent.json";m.refresh()}else{if(D=="mod"){m.url="/message/moderator.json";m.refresh()}else{if(D=="messages"){m.url="/message/messages.json";m.refresh()}else{if(D=="comments"){m.url="/message/comments.json";m.refresh()}else{if(D=="posts"){m.url="/message/selfreply.json";m.refresh()}else{if(D=="myposts"){g.find(".alertTitle").hide();m.url="/user/"+j.user.name+".json";m.refresh();g.find(".Viewport").removeClass("noSort")}else{if(D=="close"){if(typeof o!="undefined"){o.deconstructor()}window.userNotifications.scan();m.shutdown(false)}}}}}}}}}}}}}}}return D});f=g.find("#leftSide");rightSide=g.find("#rightSide");m=new column("/message/inbox.json",g.find("#leftSide"),activePlayground,j,false,{SPECIAL:true,SORT:"new"},"Messages");m.refreshTime=10000;m.loaded=function(){if(typeof s.openMessage!="undefined"){m.openPost($("#notificationsPopup #"+s.openMessage))}};m.startup();var a=g.find("#messagesType");a.toggleSwitch();g.on("hover, clickCheckbox",".Post",function(){if(!$(this).hasClass("hasCheckbox")){$(this).addClass("hasCheckbox").prepend('<label class="checkboxContainer"><input type="checkbox"></label>')}});var e,d,q=true;g.on("click",'.Post input[type="checkbox"]',function(u){u.stopPropagation();clearTimeout(e);clearTimeout(d);q=false;d=setTimeout(function(){q=true},500);$(this).parent().parent().toggleClass("checked")});r=m.openPost;m.openPost=function(u){e=setTimeout(function(){if(!q){return}var x=u.attr("data-permalink");var y=u.attr("data-postid");var v=u.attr("data-name");var w=u.attr("type");if(u.hasClass("unread")){u.removeClass("unread");j.markRead(v)}f.addClass("slideLeft");rightSide.addClass("slideRight");u.addClass("visited");if(typeof o!="undefined"){o.deconstructor();o=undefined;rightSide.html("")}if(w=="context"||typeof w=="undefined"){window.cachedNotificationsPost={type:"redditpost",postid:y,permalink:x};o=new redditpost(y,x,rightSide,j,m)}else{if(w=="t4"){window.cachedNotificationsPost={type:"redditmessages",postname:v};o=new redditmessages(v,rightSide,j)}}o.closeHook=function(){window.userNotifications.scan();g.find('[data-message="close"]').click()}},250)};if(typeof window.cachedNotificationsPost!="undefined"){f.addClass("slideLeft");rightSide.addClass("slideRight");var l=window.cachedNotificationsPost;if(l.type=="redditpost"){o=new redditpost(l.postid,l.permalink,rightSide,j,m)}else{o=new redditmessages(l.postname,rightSide,j)}o.closeHook=function(){window.userNotifications.scan();g.find('[data-message="close"]').click()}}if(s.action=="compose"){g.find('[data-message="compose"]').click();g.find("#username").val(s.username)}}function notifications_messagesDropdown(g){var f=$("#notificationsQuick");if(f.length>0){f.off().remove();return}var h=['<div id="notificationsQuick" class="menubarDropdown"> 					   <div class="header node"> 					   		<div class="title">Notifications</div> 					   		<div class="newMessage">New Message</div> 					   		<div style="clear: both"></div> 					   	</div> 					   	<div class="itemContainer" style="max-height: '+($(document).height()-100)+'px">'];var d={};var c=g.length;for(var j=0;j<c;j++){var e=g[j].data;var l=parseInt(e.created_utc);var a=formatDate(l);var k='<span class="date '+a[1]+'" data-timestamp="'+l+'">sent '+a[0]+"</span>";if(e.context==""){h.push('<div class="node message" data-messageid="'+e.id+'" data-name="'+e.name+'"> 							<div class="delete">Clear</div> 							<div class="title"><strong>'+e.author+'</strong> sent you a message</div> 							<div class="message">'+e.body+'</div> 							<div class="timeInfo">'+k+"</div> 						 </div>")}else{var m=e.context.match(/comments\/(.*?)\//).pop();if(typeof d[m]=="undefined"){d[m]=[e.name]}else{d[m].push(e.name)}h.push('<div post="'+m+'" class="node post" data-context="'+e.context+'" data-name="'+e.name+'"> 							<div class="delete">Clear</div> 							<div class="title"><strong>'+e.author+"</strong> replied in <strong>"+e.subreddit+'</strong></div> 							<div class="message">'+e.body+'</div> 							<div class="timeInfo">'+k+"</div> 						 </div>")}}h.push('<div class="footer node"> See All </div></div></div>');var b=$(h.join("")).appendTo("body");b.on("click",".node, .header, .footer, .newMessage, .node .delete",function(p){var o=$(this);if(o.hasClass("delete")){p.preventDefault();p.stopPropagation();var n=o.parent();connection.markRead(n.attr("data-name"),function(){window.userNotifications.scan()});n.remove();return false}else{if(o.hasClass("message")){notifications(connection,tabManagerObj,{ignoreDropdown:true,openMessage:o.attr("data-messageid")});b.off().remove()}else{if(o.hasClass("newMessage")){notifications(connection,tabManagerObj,{ignoreDropdown:true,action:"compose"});b.off().remove()}else{if(o.hasClass("post")){var i=o.attr("data-context").match(/\/r\/(.*?)\/comments\/(.*?)\/(.*?)\/(.*?)\?/);window.location.href="#/Home/post/"+i[2]+"/permalink/~r~"+i[1]+"~comments~"+i[2]+"~"+i[3]+"~"+i[4]+".json?context=3/column/-r-"+i[1]+"-/title/"+capitalize(i[1])+"/url/~r~"+i[1]+"~/sort/hot";b.off().remove();connection.markRead(d[o.attr("post")],function(){window.userNotifications.scan()})}else{if(o.hasClass("footer")){notifications(connection,tabManagerObj,{ignoreDropdown:true});b.off().remove()}}}}}p.stopPropagation()});setTimeout(function(){$("body").click(function(){b.off().remove()})})}function redditmessages(a,b,d){var c=this;var f=this.id=Date.now();this.storedTagBuffers={};this.livePrivateMessages=true;d.setting("live_private_messages",function(g){if(g==false){c.livePrivateMessages=g}});var e=this.postid=a.split("_").pop();this.postname=a;this.container=b;this.connection=d;this.username=d.user.name.toLowerCase();this.messageInsertedCache={};b.html('<div class="bigLoadingText downloadingComments"> Downloading Comments </div>');d.getMessage(e,function(j){var i=j.data.children[0].data;var h=i.author.toLowerCase();var g=i.dest;c.otherUser=(h==c.username)?g.toLowerCase():h;c.subject=j.data.children[0].data.subject.replace(/re: /g,"");c.messageCount=j.data.children.length;c.makeBuffer(j,undefined,undefined,function(k){b.html('<div id="CommentContent">'+k+"</div>");c.commentsContainer=b.find("#CommentContent");b.animate({scrollTop:b.prop("scrollHeight")},700);d.setting("textPreviewsEnabled",function(l){c.replyBarObj=new replyBar(d,"","Replying to "+h,"pm",function(m){var n=this.clear().loading(true);c.connection.messageReply(c.postname,m,function(q){n.loading(false);c.lastUpdateTime=Date.now();if(q==false){textarea.val(m);alert("Reddit did not receive your message.")}else{c.messageCount++;var p=Date.now()/1000;var o=formatDate(p);c.commentsContainer.append('<div class="message"> 																<div class="topstrip"> 															     	<span class="title">'+c.connection.user.name+'</span> 															     	<span class="date '+o[1]+'" data-timestamp="'+p+'">'+o[0]+'</span> 															    </div> 															    <div class="content">'+q.replace(/\\n/g,"")+"</div> 														    </div>");c.container.animate({scrollTop:c.container.prop("scrollHeight")},700)}})},true,l)});c.lastUpdateTime=Date.now();c.startAutoUpdate(3);b.on("click.chat"+f,"a",function(l){c.clickLink.call(c,$(this).attr("href"),l);l.stopPropagation()})})});b.on("click",".uTagPM",function(){redditpost.prototype.manageTags.call(c,$(this).parent().parent().find("#Author").html(),$(this).html(),$(this).attr("id"))})}redditmessages.prototype.lastUpdateTime=0;redditmessages.prototype.calculateNextRuntime=function(a){return 2000};redditmessages.prototype.markRead=function(a){this.connection.markRead(a);$('div[data-name="'+a+'"]').removeClass("unread")};redditmessages.prototype.makeBuffer=function(f,h,d,g){var c=this;var b=[];var e=this.messageInsertedCache;redditmessages_object=this;var a=this.storedTagBuffers;if(typeof d=="undefined"){d=0}this.connection.tags(function(i){function j(p){var l=p.data.children;var q=l.length;for(var o=d;o<q;o++){var u=l[o].data;if(u["new"]){redditmessages_object.markRead(u.name)}if(e[u.id]){continue}e[u.id]=true;var r=parseInt(u.created_utc);var m=formatDate(r);var t="";var k=u.author.toLowerCase();if(typeof i[k]!="undefined"){if(typeof a[k]=="undefined"){var s=i[k];var n=s.length;for(var o=0;o<n;o++){t+='<div id="'+o+'" class="uTag uTagPM" style="background-color: '+s[o].b+"; color: "+s[o].c+'">'+s[o].t+"</div>"}a[k]=t}else{t=a[k]}}b.push('<div class="message"> 								 <div class="topstrip"> 							     	<span class="title"><span id="Author">'+u.author+'</span><span class="'+k+'userTagList">'+t+'</span></span> 							     	<span class="date '+m[1]+'" data-timestamp="'+r+'">'+m[0]+'</span> 							     </div> 							     <div class="content">'+$("<div />").html(u.body_html.replace("&lt;!-- SC_OFF --&gt;","").replace("&lt;!-- SC_ON --&gt;","")).text()+"</div> 							 </div>");if(typeof u.replies=="object"){j(u.replies)}}}j(f);g(b.join(""))})};redditmessages.prototype.updateMessages=function(){var a=this;var b=this.messageInsertedCache;this.connection.getPosts("/message/unread.json",25,null,function(j){var c=j.length;var k=false;for(var e=0;e<c;e++){if(j[e].data.author.toLowerCase()==a.otherUser&&j[e].kind=="t4"&&j[e].data.subject.replace(/re: /g,"")==a.subject){var f=j[e].data;if(f["new"]){a.markRead(f.name)}if(b[f.id]){continue}b[f.id]=true;k=true;var h=parseInt(f.created_utc);var g=formatDate(h);var d='<div class="message"> 								 <div class="topstrip"> 							     	<span class="title">'+f.author+'</span> 							     	<span class="date '+g[1]+'" data-timestamp="'+h+'">'+g[0]+'</span> 							     </div> 							     <div class="content">'+$("<div />").html(f.body_html.replace("&lt;!-- SC_OFF --&gt;","").replace("&lt;!-- SC_ON --&gt;","")).text()+"</div> 							   </div>";a.commentsContainer.append(d);a.container.animate({scrollTop:a.container.prop("scrollHeight")},700)}}if(k){a.lastUpdateTime=Date.now()}a.startAutoUpdate(Date.now()-a.lastUpdateTime)})};redditmessages.prototype.shouldStopRunning=false;redditmessages.prototype.stopAutoUpdate=function(){clearTimeout(this.lastUpdateTimeout);this.shouldStopRunning=true};redditmessages.prototype.startAutoUpdate=function(b){if(this.shouldStopRunning||!this.livePrivateMessages){return}var a=this;this.lastUpdateTimeout=setTimeout(function(){a.updateMessages.call(a)},this.calculateNextRuntime(b))};redditmessages.prototype.deconstructor=function(){this.replyBarObj.close();this.stopAutoUpdate();this.container.off(".chat"+this.id)};redditmessages.prototype.clickLink=function(b,f){f.preventDefault();if(b.search(/r\/(.*?)\/comments\/(.*?)\//)!=-1){var d=b.match(/r\/(.*?)\/comments\/(.*?)\//);var g=d[2];var c="~r~"+("/"+b).split("/r/").pop().replace(/\//g,"~");var a=(b+"/").match(/\/r\/(.*?)\//).pop();window.location.href="#/Home/post/"+g+"/permalink/"+c+"/column/-r-"+a+"-/url/~r~"+a+"~/title/"+capitalize(a);if(typeof this.closeHook=="function"){this.closeHook()}}else{if(b.search(/\/r\/(.*?)$/)!=-1||b.search(/\/r\/(.*?)\/$/)!=-1){var a=(b+"/").match(/\/r\/(.*?)\/$/).pop();new quickView(this.connection,capitalize(a),"/r/"+a+"/");if(typeof this.closeHook=="function"){this.closeHook()}}else{if(b.toLowerCase()=="/spoiler"){return}else{popupBrowser(b)}}}};function historyDropdown(b){var a=$("body");var c=$("#historyDropdown");if(c.length){c.remove();return false}b.getHistory(function(g){var d=g.length;var e=[];for(var f=0;f<d;f++){e.push('<div class="node historyRecord" data-key="'+f+'" data-href="'+g[f][2]+'">'+g[f][0]+"</div>")}c=$('<div id="historyDropdown" class="menubarDropdown" style="overflow-y: scroll; max-height: '+($(document).height()-100)+'px !important"> 					  	 <div class="header node"> 					  	 	 <div class="title">'+d+' Items in History</div> 					  	 	 <div id="clearHistory" class="newMessage">Clear History</div> 					  	 	 <div style="clear: both"></div> 					  	 </div> 					  	 <div class="itemContainer">'+e.join("")+"</div> 					  </div>").appendTo(a);setTimeout(function(){a.off(".historyPopup").on("click.historyPopup",function(){c.remove();a.off(".historyPopup")});c.on("click.historyPopup",function(h){h.preventDefault();h.stopPropagation();return false})},500);c.on("click.historyPopup",".historyRecord",function(i){var h=parseInt($(this).attr("data-key"));window.location.href=g[h][1];c.remove()});c.on("click.historyPopup","#clearHistory",function(h){b.clearHistory();c.remove()});c.on("mouseenter.historyPopup",".historyRecord",function(h){smartContentPopup($(this))}).on("mouseleave.historyPopup",".historyRecord",function(h){smartContentPopupPrevent($(this))})})}function tabManager(f,e,h,d,g){var c=this.colWidth;this.tabManagerWaitingFor=d;this.callback=g;this.redditConnection=f;var a=this;this.navigationSelector=h;this.id=Date.now();f.userVariable("tabPage",function(i){a.currentPage=(typeof i=="undefined")?1:i});var b=this.playground=e;this.width=b.width();this.height=b.height();this.sideSpacing=this.width%c;this.columns={};this.columnsOrder=[];this.pageWidths=[];this.pageSelector=$("<div id='pageSelector'></div>");h.html(this.pageSelector);this.populatePageSelector();this.nextPageButton=$("<div id='next' class='pageNav pageNavNext' style='position: absolute; right: 0; top: 0px; bottom: 0px'></div>").appendTo(b);this.bindings(true);return this}tabManager.prototype.colWidth=300;tabManager.prototype.columnSpacing=9;tabManager.prototype.colTop=11;tabManager.prototype.colBottom=50;tabManager.prototype.pages=1;tabManager.prototype.currentPage=1;tabManager.prototype.amountTotalColumns=0;tabManager.prototype.mailViewLeftPixelAmount=-6;tabManager.prototype.mailViewActive=false;tabManager.prototype.insertX=tabManager.prototype.columnSpacing;tabManager.prototype.columnsOrderValue=0;tabManager.prototype.tabManagerWaitingFor=false;tabManager.prototype.bindings=function(b){var a=this;var f=this.id;var d=this.pageSelector;var c=this.playground;var e=this.navigationSelector;if(b==false){d.off("click.tabManager"+f);c.off("click.tabManager"+f);e.off("click.tabManager"+f);d.off("click.tabManager"+f);return}d.on("click.tabManager"+f,".push:not(.pageManager)",function(){if(typeof a.pagePreviewSelector!="undefined"){a.pagePreviewSelector.remove()}a.pagePreviewSelector=undefined;var g=parseInt($(this).attr("data-forpage"));a.changePage(g)});c.on("click.tabManager"+f,".pageNav",function(){a.changePage(a.currentPage+1)});e.on("click.tabManager"+f,".pageManagerColumn",function(){a.switchToColumn($(this).attr("id"));if(typeof a.pageManagerObject!="undefined"){a.pageManagerObject.remove();a.pageManagerObject=undefined}});e.on("click.tabManager"+f,".pageManagerColumn .remove",function(h){h.stopPropagation();var g=$(this).parent();a.removeColumn(g.attr("id"));g.remove()});d.on("mouseenter.tabManager"+f,".notPage",function(){a.pagePreview($(this).attr("data-forpage"))}).on("mouseleave.tabManager"+f,".notPage",function(){a.pagePreviewSelector.remove();a.pagePreviewSelector=undefined});e.on("hover.tabManager"+f,".menubarDropdown",function(){a.pagePreviewSelector.remove();a.pagePreviewSelector=undefined});d.on("click.tabManager"+f,".pageManager",function(){a.pageManager($(this))})};tabManager.prototype.pagePreview=function(c){var b=this.getColumnTitlesAtPage(c);var d="";for(var a=0;a<b.length;a++){d+='<div class="node">'+b[a]+"</div>"}this.pagePreviewSelector=$('<div id="pagePreview" class="menubarDropdown">'+d+"</div>").prependTo(this.navigationSelector)};tabManager.prototype.getColumnTitlesAtPage=function(a){var d=this.columns;var c=[];for(var b in d){var e=d[b];if(typeof e!="undefined"&&e.page==a){c.push(e.sourceObject.title)}}return c};tabManager.prototype.startupAndShutdown=function(f){var e=this.columns;var b=this.columnsOrder;var a=b.length;for(var d=0;d<a;d++){var c=e[b[d].id];if(c.page==f){if(!c.sourceObject.running){var g=c.sourceObject;g.startup();g.show()}}else{if(c.sourceObject.running){var g=c.sourceObject;g.shutdown();g.hide()}}}};tabManager.prototype.deconstructor=function(){this.bindings(false);var e=this.columns;var b=this.columnsOrder;var a=b.length;for(var d=0;d<a;d++){var c=e[b[d].id];if(c.sourceObject.running){c.sourceObject["shutdown"]()}}};tabManager.prototype.fixForwardBackButtons=function(a){this.nextPageButton.css("left",this.pageWidths[a]+"px");this.nextPageButton.css("display",(a==this.pages)?"none":"block")};tabManager.prototype.populatePageSelector=function(){var c=this.pageSelector;var a=[];for(var b=1;b<=this.pages;b++){a.push('<div class="push '+((this.currentPage==b)?"currentPage":"notPage")+'" data-forpage="'+b+'">'+b+"</div>")}a.push('<div class="push pageManager"> &nbsp; <div class="icon alien"></div> </div> <div class="clear"></div>');c.html(a.join(""))};tabManager.prototype.changePage=function(c){if(c==-1){this.lastPage();return}if(/^\d+$/.test(c)==false){this.switchToColumn(c);return}var b=this.currentPage;if(c==b){return}var a=this;var d=this.pageSelector;$("[data-page="+b+"]").hide();$("[data-page="+c+"]").show();a.startupAndShutdown(c);tabManager.prototype.currentPage=c;this.currentPage=c;this.redditConnection.userVariable("tabPage",c);this.fixForwardBackButtons(c);d.find(".currentPage").removeClass("currentPage").addClass("notPage");d.find("[data-forpage="+c+"]").addClass("currentPage").removeClass("notPage")};tabManager.prototype.lastPage=function(){if(window.location.hash.indexOf("/post/")==-1){this.changePage(this.pages)}};tabManager.prototype.insert=function(f,c){var e=f.call(this,undefined);var a=e.id=e.id;if(typeof this.columns[a]!="undefined"){return a}var g=(e.width>this.width-100)?this.width-100:e.width;var b=this.width;var h=this.currentPage;var j=this.pageWidths;var k=this.insertX;this.insertX+=g+this.columnSpacing;if((k+g)>b){j[this.pages]=k;this.pages++;k=this.columnSpacing;this.insertX=k+g+this.columnSpacing;clearTimeout(this.populatePageSelectorTimer);var l=this;this.populatePageSelectorTimer=setTimeout(function(){l.populatePageSelector()},500)}else{j[this.pages]=this.insertX}var i=Math.ceil((k+g)/b);if(i>this.pages){this.pages++}var d=$('<div data-page="'+this.pages+'" class="container" style="position: absolute; display: none; left: '+k+"px; top: "+this.colTop+"px; bottom: "+this.colBottom+"px; width: "+g+'px"></div>');e.selector=d;this.playground.append(d);this.columnsOrder.push({id:a,order:this.columnsOrderValue+=10,flags:e.flags,url:e.url,title:e.title});this.columns[a]={selector:d,page:this.pages,sourceObject:e,insertX:k,flags:e.flags};if(c=="SYNC"){this.redditConnection.saveColumns(this.columnsOrder)}if(this.tabManagerWaitingFor==a&&typeof this.callback=="function"){this.tabManagerWaitingFor=false;var l=this;setTimeout(function(){l.callback()},500)}else{if(h==this.pages&&!this.mailViewActive){d.show();e.startup()}}this.fixForwardBackButtons(h);return -1};tabManager.prototype.resize=function(o){if(this.mailViewActive){return}var q=this.columnSpacing;var e=this.playground;var k=this.currentPage;var c=this.pageWidths;var g=this.width=e.width();this.height=e.height();var g=this.width=g-35;var p=g-100;var r=this.insertX=q;var f=1;var a=this.columns;var j=this.columnsOrder;var n=j.length;for(var m=0;m<n;m++){var h=a[j[m].id];var s=h.sourceObject.width;if(s>p){s=p}var d=r;r+=s+q;var l=$(h.selector);if(o){l.width(s)}var b=Math.ceil((r+s)/g);if((d+s)>g){c[f]=d;f++;d=q;r=d+q+s}else{c[f]=r}l.attr("data-page",f).css("left",d+"px");h.page=f}this.pages=f;this.insertX=r;this.nextPageButton.css("left",c[k]+"px");e.find(".container").hide();$("[data-page="+k+"]").show();this.populatePageSelector();if(k>f){this.changePage(f)}else{this.fixForwardBackButtons(k);this.startupAndShutdown(k)}};tabManager.prototype.mailViewStart=function(n,m,j){var o=this;if(typeof this.columns[n]=="undefined"){this.tabManagerWaitingFor=n;this.callback=function(){o.mailViewStart(n,m,j)};this.insert(function(i){return new column(j.url.replace(/~/g,"/"),i,activePlayground,this.redditConnection,this,{SORT:j.sort,TEMP:true,highlight:j.highlight},j.title)});return}var c=this.columnWorkingWith!=this.columns[n]&&typeof this.columnWorkingWith!="undefined";var h=(this.currentPost!=j.post)?true:false;this.currentPost=j.post;$('[data-postid="'+j.post+'"] #newComments').remove();if(!this.mailViewActive||c){this.mailViewActive=true;var q=null;var f=this.columns;var b=this.columnsOrder;var l=b.length;for(var g=0;g<l;g++){var p=f[b[g].id];if(n==p.sourceObject.id){if(!p.sourceObject.running){var a=p.sourceObject;a.show();a.startup()}}else{if(p.sourceObject.running){var a=p.sourceObject;a.shutdown();a.hide()}}}if(c){var e=this.columnWorkingWith;if(!e.flags.TEMP){e.selector.css({left:this.columnWorkingWith.insertX+"px",top:this.colTop+"px",bottom:this.colBottom+"px"}).removeClass("stickleft").removeClass("stickleftNoAnimate")}}this.columnWorkingWith=q=f[n];var d=q.selector;d.addClass(c?"stickleftNoAnimate":"stickleft");if(c){this.currentpost.setColumn(q.sourceObject)}if(h){if(typeof this.currentpost!="undefined"){this.currentpost.deconstructor()}$("#PostView").remove();this.pageSelector.hide();this.nextPageButton.hide();var k=$('<div id="PostView" class="canscroll" style="display: none; position: absolute; top: 0; bottom: 0; right: 0; left: '+(this.colWidth+this.mailViewLeftPixelAmount)+'px"> <div class="loadingcss"></div> </div>').appendTo(this.playground);setTimeout(function(){k.show()},500);this.currentpost=m.call(k,q.sourceObject)}}else{this.currentpost.deconstructor();$("#PostView").remove();var k=$('<div id="PostView" class="canscroll" style="position: absolute; top: 0; bottom: 0; right: 0; left: '+(this.colWidth+this.mailViewLeftPixelAmount)+'px"></div>').appendTo(this.playground);this.currentpost=m.call(k,this.columnWorkingWith.sourceObject)}};tabManager.prototype.mailViewStop=function(){if(!this.mailViewActive){return false}this.mailViewActive=false;this.currentPost=false;var k=this.columnWorkingWith;var b=k.sourceObject.id;k.selector.css({left:k.insertX+"px",top:this.colTop+"px",bottom:this.colBottom+"px"}).removeClass("stickleft").removeClass("stickleftNoAnimate");this.currentpost.deconstructor();$("#PostView").remove();this.pageSelector.show();this.nextPageButton.show();var g=this.currentPage;var d=g!=k.page&&(typeof k.flags=="object"&&!k.flags.TEMP);if(d){this.changePage(k.page)}this.columnWorkingWith=undefined;var e=this.columns;var c=this.columnsOrder;var h=c.length-1;for(var f=h;f>-1;f--){var j=e[c[f].id];if(typeof c[f].flags!="undefined"&&c[f].flags.TEMP){j.sourceObject.remove();delete e[c[f].id];c.splice(f,1);h--}else{if(j.sourceObject.running!=true&&!d&&j.page==g){var a=j.sourceObject;a.show();a.startup()}}}this.resize();return true};tabManager.prototype.moveColumn=function(g,k){var b=this.columns;var l=this.columnsOrder;if(k=="left"){if(l[0].id==g){return}}if(k=="right"){if(l[l.length-1].id==g){return}}var n=l.length-1;var c=null;for(var m=n;m>-1;m--){if(l[m].id==g){c=m;break}}if(k=="left"){var q=c;var h=c-1}else{var q=c+1;var h=c}var p=l.splice(q,1).pop();var f=l[h];var r=b[f.id];var a=b[p.id];var e=r.page;var s=r.insertX;var o=a.page;var d=a.insertX;r.page=o;r.insertX=d;a.page=e;a.insertX=s;l.splice(h,0,p);var j=(k=="left")?e:o;this.changePage(j);this.saveColumns();this.resize()};tabManager.prototype.saveColumns=function(){this.redditConnection.saveColumns(this.columnsOrder)};tabManager.prototype.removeColumn=function(f){f=f.toLowerCase();var e=this.columns;var b=this.columnsOrder;var a=b.length-1;for(var d=a;d>-1;d--){var c=e[b[d].id];if(b[d].id==f){if(this.mailViewActive){c.flags.TEMP=true;b[d].flags.TEMP=true}else{if(typeof c!="undefined"){c.sourceObject.remove();delete e[b[d].id]}b.splice(d,1)}}}this.resize();this.redditConnection.saveColumns(this.columnsOrder)};tabManager.prototype.isPermanentColumn=function(b){var a=this.columns[b.replace(/\//g,"-").toLowerCase()];return(typeof a!="undefined"&&!a.flags.TEMP)?true:false};tabManager.prototype.makePermanent=function(g){var f=this.columns;var c=this.columnsOrder;var b=c.length-1;var a=undefined;for(var e=b;e>-1;e--){var d=f[c[e].id];if(c[e].id==g){a=e;break}}if(typeof c[a].flags!="undefined"){delete c[a].flags.TEMP}if(typeof f[g].flags!="undefined"){delete f[g].flags.TEMP}this.redditConnection.saveColumns(this.columnsOrder)};tabManager.prototype.setSort=function(h,g){var f=this.columns;var c=this.columnsOrder;var b=c.length-1;var a=undefined;for(var e=b;e>-1;e--){var d=f[c[e].id];if(c[e].id==h){a=e;break}}if(typeof c[a].flags=="undefined"){c[a].flags={}}c[a].flags.SORT=g;this.redditConnection.saveColumns(this.columnsOrder)};tabManager.prototype.setTitle=function(b,g,c){var d=this.columns;var a=this.columnsOrder;var f=a.length-1;var h=undefined;for(var e=f;e>-1;e--){var j=d[a[e].id];if(a[e].id==b){h=e;break}}if(typeof a[h].flags=="undefined"){a[h].flags={}}a[h].title=g;if(typeof c=="undefined"||c==true){this.redditConnection.saveColumns(this.columnsOrder)}};tabManager.prototype.setUrl=function(b,d,c){d=d.toLowerCase();var h=d.replace(/\//g,"-");var a=this.columnsOrder;var e=this.columns;if(typeof e[h]!="undefined"){return false}var g=a.length-1;var j=undefined;for(var f=g;f>-1;f--){var k=e[a[f].id];if(a[f].id==b){j=f;break}}a[j].url=d;if(typeof a[j].flags=="undefined"){a[j].flags={}}a[j].id=h;e[h]=e[b];delete e[b];$("#"+b).attr("id",h);if(typeof c=="undefined"||c==true){this.redditConnection.saveColumns(this.columnsOrder)}return true};tabManager.prototype.pageManager=function(f){if(typeof this.pageManagerObject!="undefined"){this.pageManagerObject.remove();this.pageManagerObject=undefined;return}var h=this.navigationSelector;var b=['<div id="pageManagerContainer" class="menubarDropdown canscroll" style="max-height: '+($("body").height()-100)+'px">'];var d=this.columnsOrder;var a=d.length;for(var e=0;e<a;e++){b.push('<div class="pageManagerColumn node" id="'+d[e].id+'"> <div class="icon remove"></div> <div class="text">'+d[e].title+'</div> <div class="icon verticalArrows"></div> </div>')}b.push('<input id="search" placeholder="Start typing...">');b.push("</div>");var g=this.pageManagerObject=$(b.join("")).appendTo(h);var c=this;g.sortable({containment:"parent",update:function(){c.pageManagerSort.call(c)}});var c=this;setTimeout(function(){$("body").one("click",function(){g.remove();c.pageManagerObject=undefined})},1000);h.find("#search").focus();h.on("click.tabManager"+this.id,"#search",function(i){i.preventDefault();i.stopPropagation()});h.on("keyup.tabManager"+this.id,"#search",function(j){var i=$(this).val();if(j.keyCode==13){h.find('.pageManagerColumn:icontains("'+i+'")').first().click();return}if(i==""){h.find(".pageManagerColumn").show();return}h.find(".pageManagerColumn").hide();h.find('.pageManagerColumn:icontains("'+i+'")').show()})};tabManager.prototype.pageManagerSort=function(){var c=this.columnsOrder;var e={};var a=c.length;for(var d=0;d<a;d++){e[c[d].id]=c[d]}var b=[];this.pageManagerObject.find(".pageManagerColumn").each(function(){b.push(e[$(this).attr("id")])});this.redditConnection.saveColumns(b);this.columnsOrder=b;this.resize()};tabManager.prototype.switchToColumn=function(c){var a=this.columns[c];var b=this.columns[c].page;setTimeout(function(){a.selector.addClass("glow")},500);setTimeout(function(){a.selector.removeClass("glow")},1500);this.changePage(b)};tabManager.prototype.resizeColumn=function(f,d){var b=this.columnsOrder;var a=b.length-1;var e=null;for(var c=a;c>-1;c--){if(b[c].id==f){e=c;break}}if(d==column.prototype.width){delete b[e].width}else{b[e].width=d}self.tabManagerObj.resize(true);self.tabManagerObj.saveColumns()};function subredditSelector(b,d,h,c){if(typeof h=="function"||typeof h=="undefined"){c=h;h=[]}this.selector=d=$(d);var k=null;var l=this;onChangeCallbackExists=(typeof c=="undefined")?false:true;var e=[];var j=h.length;for(var g=0;g<j;g++){e.push('<div class="selected subredditSelectorItem">'+h[g]+"</div>")}d.html('<div class="subredditSelector"> 				      <div class="toggleSwitchContainer"> 					      <select id="viewType"> 					      	  <option selected>Editor</option> 					      	  <option>List</option> 					      </select> 					  </div> 					  <div id="editor" class="active"> 					   	  <div class="incontainer"> 					   	  	  <input placeholder="Type in a subreddit and hit enter"> 					   	  </div> 					   	  <div id="addSubreddit_results">'+e.join("")+'</div> 				   	  </div> 				   	  <div id="list" style="display: none"> 				   	  	  <div id="textareaContainer" class="incontainer"></div> 				   	  </div> 				   </div>');d.off(".subredditSelector").on("click.subredditSelector","#addSubreddit_results div",function(){$(this).toggleClass("selected");if(onChangeCallbackExists){l.subreddits(c)}k.select().focus()});var a="Editor";d.find("#viewType").toggleSwitch().off(".subredditSelector").on("change.subredditSelector",function(){var n=$(this).val();if(a=="Editor"&&n=="List"){a=n;var m=d.find("#list");l.subreddits(function(o){m.find("#textareaContainer").html('<textarea placeholder="Specify one subreddit per line">'+o.join("\n")+"</textarea>").find("textarea").autoHeight().doneTyping(function(){if(onChangeCallbackExists){l.subreddits(c)}})});d.find("#editor").hide().removeClass("active");m.show().addClass("active")}else{if(a=="List"&&n=="Editor"){a=n;var i=d.find("#editor");l.subreddits(function(o){i.find("#addSubreddit_results").html('<div class="subredditSelectorItem selected">'+o.join('</div><div class="subredditSelectorItem selected">')+"</div>")});i.show().addClass("active");d.find("#list").hide().removeClass("active")}}});k=d.find("input").focus();var f=d.find("#addSubreddit_results");k.doneTyping(function(){k.addClass("loading");var i=k.val().toLowerCase();i=i.replace("/r/","");if(i.substr(0,2)=="r/"){i=i.substr(2)}b.searchRedditNames(i,function(p){f.find("div:not(.selected)").remove();if(p.length!=0){f.append('<div class="subredditSelectorItem">'+p.join('</div><div class="subredditSelectorItem">')+"</div>")}var n=false;var m=p.length;for(var o=0;o<m;o++){if(i==p[o].toLowerCase()){n=true}}if(!n){b.subredditExists(i,function(q){if(q){f.append('<div class="subredditSelectorItem">'+capitalize(i)+"</div>")}})}k.removeClass("loading")})})}subredditSelector.prototype.subreddits=function(f){selector=this.selector;if(selector.find(".active").attr("id")=="list"){var c=selector.find("textarea").val();var b=c.toLowerCase().split(/\r\n|\r|\n/g);var e=[];var a=b.length;for(var d=0;d<a;d++){if(b[d]!=""){e.push($.trim(b[d]).toLowerCase())}}f(e)}else{var e=[];selector.find(".subredditSelectorItem.selected").each(function(){e.push($(this).html().toLowerCase())});f(e)}};function parseSubreddit(a,b){reddit.prototype.subredditAbout(a,function(d){if(!d){b("");return false}var c="<div class='subredditInfo infoDescription'> 						 <center> 						 <span style='font-size: 150%'>/r/"+capitalize(a)+"</span> 						 <br><br> 						 <strong>Subscribed:</strong><br> 						 "+d.subscribers+" 						 <br><br> 						 <strong>Active Users:</strong><br> 						 "+d.accounts_active+" 						 <br><br> 						 <strong>Created On:</strong><br> 						 "+formatDate(d.created)[0]+" 						 </center> 					 </div>";b(c)})}function parseImage(a,e,d,b){var c=new Image();c.onload=function(){var k=this.width;var f=this.height;var h=(typeof d=="undefined")?window.outerWidth:d;var l=(typeof b=="undefined")?window.outerHeight:b;var j,g;var j=k;var g=f;if(k>h){j=h;g=f*(h/k)}if(g>l){var i=l/g;g=l;j=j*i}e('<center><img src="'+a+'" style="width: '+j+"px; height: "+g+'px"></center>',function(){return{handledBy:"parseImage"}})};c.src=a}function parseTinyPic(b,d,c,a){$.get(b,function(f){var e=decodeURIComponent(f.match(/fo\.addVariable\("ipt"\, "(.*?).jpg"\);/).pop());parseImage(e,d,c,a)})}function parseFlickr(b,d,c,a){$.get(b,function(g){var e=g.match(/<meta property="og:image" content="(.*?)" \/>/im);if(e!=null){var f=e[1]}else{var e=g.match(/rel="image_src" href="(.*?)"/im);var f=e[1]}parseImage(f,d,c,a)})}function parseTwitter(a,b){$.getJSON("https://api.twitter.com/1/statuses/oembed.json",{url:a,align:"left",omit_script:"true"},function(c){b(c.html)})}function parseImgur(b,e,d,a){var c=b.match(/\/a\/(.*?)($|#)/)[1];$.ajax({url:"https://api.imgur.com/3/gallery/album/"+c+"/images",type:"GET",beforeSend:function(g,f){g.setRequestHeader("Authorization","Client-ID 6d5f34e8c30918b")},success:function(m){var l=[];var f=[];var j=[];var k=['<div id="bareSourceImages"><div class="infoDescription">'];var m=m.data;for(var h in m){var n=m[h];l.push(n.link);f.push(n.title);var g=n.link.replace(/\.(png|bmp|gif|jpg|jpeg|bmp)/i,"s.$1");j.push(g);k.push('<div class="img"> 								 	<img data-key="'+h+'" data-title="'+n.title+'" data-url="'+n.link+'" src="'+g+'"> 								 	'+(n.title!=""?'<div class="imgtitle"><span>'+n.title+"</span></div>":"")+" 								 </div>")}k.push("</div></div>");e(k.join(""),function(i){i.on("click","img",function(p){p.preventDefault();p.stopPropagation();var o=$(this);imageZoom(o.attr("data-url"),o.attr("data-title"),parseInt(o.attr("data-key")),l,f,j)});return{TTL:30}})}})}function parseYoutube(b,g,c,a){try{var f=b.match(/v=(.*?)(&|$)/i)[1];connection.setting("ytVideoType",function(e){g('<iframe class="youtubePlayer" src="http://www.youtube.com/embed/'+f+(e=="html5"?"?html5=1":"")+'"></iframe>')})}catch(d){g("")}}function parseYoutubeShortURL(b,e,c,a){var d=b.split("/").pop();connection.setting("ytVideoType",function(f){e('<iframe class="youtubePlayer" src="http://www.youtube.com/embed/'+d+(f=="html5"?"?html5=1":"")+'"></iframe>')})}function parseReddit(a,d){var c=a.match(/comments\/(.*?)\//);if(c!=null){c=c[1]}else{d("");return}var b=$("<div />").html(nl2br(redditGetCache(c,"selftext_html")).replace("&lt;!-- SC_OFF --&gt;","").replace("&lt;!-- SC_ON --&gt;","")).text();if(b=="null"){b=redditGetCache(c,"title")}if(b=="false"){$.getJSON(a+".json",function(f){try{var h=f[1]["data"]["children"][0]["data"]["selftext_html"];if(h==""||h==null){h=f[1]["data"]["children"][0]["data"]["body_html"]}var h=$("<div />").html(h.replace("&lt;!-- SC_OFF --&gt;","").replace("&lt;!-- SC_ON --&gt;","")).text();d("<div class='infoText'> <div class='infoDescription'>"+h+"</div> </div>")}catch(g){}})}else{d("<div class='infoText'> <div class='infoDescription'>"+b+"</div> </div>")}}function parseDeviantArt(b,d,c,a){if(b.indexOf("#")!=-1){b="http://fav.me/"+(b+"/").match(/#\/(.*?)\//).pop()}$.getJSON("http://backend.deviantart.com/oembed?url="+b+"&format=json",function(e){parseImage(e.thumbnail_url,d,c,a)})}function parseInstagram(b,d,c,a){$.get(b,function(f){var e=f.match(/property="og:image" content="(.*?)"/i).pop();parseImage(e,d,c,a)})}function parseXkcd(a,b){$.get(a,function(d){var c=d.match(/<div id="comic"[\s\S]*?div>/i).pop();b(c)})}function parsePostimage(a,b){$.get(a,function(d){var c=d.match(/<img [\s\S]*? \/>/i).pop();b(c)})}function parseVimeo(a,c){var b=a.split("/")[3];c('<iframe class="vimo" src="http://player.vimeo.com/video/'+b+'"></iframe>')}function parseTwitch(a,c){var b=a.split("/")[3];c('<object type="application/x-shockwave-flash" height="400" width="656" id="live_embed_player_flash" data="https://www.twitch.tv/widgets/live_embed_player.swf?channel='+b+'" bgcolor="#000000"><param name="allowFullScreen" value="true" /><param name="allowScriptAccess" value="always" /><param name="allowNetworking" value="all" /><param name="movie" value="https://www.twitch.tv/widgets/live_embed_player.swf" /><param name="flashvars" value="hostname=www.twitch.tv&channel='+b+'&auto_play=true&start_volume=25" /></object><iframe id="chat_embed" src="http://twitch.tv/chat/embed?channel='+b+'&amp;popout_chat=true" style="border: none; width: 400px; height: 350px"></iframe>')}function parseMixcloud(a,b){$.getJSON("http://www.mixcloud.com/oembed",{url:a,format:"json"},function(d){var c=d.html.replace('src="//','src="http://').replace('value="//','value="https://');b(c)})}function parseBareSource(b,d,c,a){$.getJSON("https://www.readability.com/api/content/v1/parser"+(reddit.prototype.crossDomain?"?callback=?":""),{url:b,token:"e97c4f658162139ec8e04c4cbb2e80518c66757f"},function(e){d("<div class='infoDescription heightRestriction'> <div id='readability'><a href='http://www.readability.com/m?url="+b+"' target='blank'>Provided by Readability</a></div> <div class='title'>"+e.title+"</div> <div class='more'>Show More..</div> <div class='desc'> "+e.content.replace(/<img(.*?)>/g,"")+"</div> </div>",function(f){f.find(".more").click(function(){f.find(".heightRestriction").removeClass("heightRestriction");$(this).remove()});return"parseBareSource"})})}function infoHandler(b,h,d,a){var f=(h==false)?false:true;var g=b.toLowerCase();if(g.indexOf("instagram.com")!=-1){if(f){parseInstagram(b,h,d,a)}return true}else{if(g.indexOf("deviantart.com")!=-1||g.indexOf("fav.me")!=-1){if(f){parseDeviantArt(b,h,d,a)}return true}else{if(g.indexOf("reddit.com/r/")!=-1){if(f){parseReddit(b,h)}return false}else{if(g.indexOf("imgur.com/a/")!=-1){if(f){parseImgur(b,h,d,a)}return true}else{if(g.indexOf("tinypic.com/view.php?pic=")!=-1){b=b.replace("&amp;s","&s");if(f){parseTinyPic(b,h,d,a)}return true}else{if(g.indexOf("tinypic.com/r/")!=-1){var e=(g+"/").match(/\/r\/(.*?)\/(.*?)\//);if(f){parseTinyPic("http://tinypic.com/view.php?pic="+e[1]+"&s="+e[2]+"",h,d,a)}return true}else{if($.inArray(g.split(".").pop(),["png","jpg","jpeg","bmp","gif","tiff"])!=-1){if(f){parseImage(b,h,d,a)}return true}else{if(g.indexOf("imgur.com")!=-1){var c=b.match(/com\/(.*?)($|\?|_)/i)[1];if(f){parseImage("http://imgur.com/"+c+".png",h,d,a)}return true}else{if(g.indexOf("flickr.com")!=-1){if(f){parseFlickr(b,h,d,a)}return true}else{if(g.indexOf("youtube.com")!=-1){if(f){parseYoutube(b,h)}return true}else{if(g.indexOf("youtu.be")!=-1){if(f){parseYoutubeShortURL(b,h)}return true}else{if(g.indexOf("quickmeme.com")!=-1){var c=b.split("/")[4];if(f){parseImage("http://i.qkme.me/"+c+".jpg",h,d,a)}return true}else{if(g.indexOf("qkme.me")!=-1){var c=b.replace("http://qkme.me","").replace(/\?id=[0-9]+/,"");if(f){parseImage("http://i.qkme.me/"+c+".jpg",h,d,a)}return true}else{if(g.indexOf("twitter.com")!=-1){if(f){parseTwitter(b,h)}return false}else{if(g.indexOf("xkcd.com")!=-1){if(f){parseXkcd(b,h)}return true}else{if(g.indexOf("vimeo.com")!=-1){if(f){parseVimeo(b,h)}return true}else{if(g.indexOf("mixcloud.com")!=-1){if(f){parseMixcloud(b,h)}return true}else{if(g.indexOf("twitch.tv")!=-1){if(f){parseTwitch(b,h)}return true}else{if(g.indexOf("postimage.org")!=-1){if(f){parsePostimage(b,h,d,a)}return true}else{if((g+"/").search(/\/r\/(.*?)\/$/)!=-1){if(f){parseSubreddit((g+"/").match(/\/r\/(.*?)\/$/).pop(),h)}return false}else{if(f){parseBareSource(b,h)}return false}}}}}}}}}}}}}}}}}}}}}var body;$(document).ready(function(){body=$("body")});function smartContentPopupPrevent(a){if(window.preventPreviewClose){return}var d=a.attr("timeout");if(typeof d!="undefined"){clearTimeout(d)}var c=a.attr("p");if(typeof c=="undefined"){return}var b=$("#"+c);body.unbind("mousemove."+c);b.remove();a.removeAttr("p")}function smartContentPopup(a){if(window.preventPreviewClose){return}var d=a.attr("href");if(typeof d=="undefined"){d=a.attr("data-href")}if(typeof d=="undefined"){return false}if(typeof a.attr("p")!="undefined"){return}var c=a.attr("timeout");if(typeof c!="undefined"){clearTimeout(c)}var b=setTimeout(function(){var n=a.offset().left;var m=a.offset().top;var o=a.outerWidth();var h=a.outerHeight();var i=n;var g=m;var f=g+h;var q=body.outerWidth();var l=body.outerHeight();var k=q-(i+o);function j(t,r,w){if(typeof w=="undefined"){w=0}var v=r.outerWidth();var x=r.outerHeight();var u=(k>i)?(i+o):(i-v);var s=g-(x-h)/2;if(s<0){s=0}if((s+x)>l){s=l-x-30}r.css({left:u,top:s});if(w-->0){setTimeout(function(){j(t,r,w)},100)}}if(!window.preventPreviewClose){body.find(".smartContentPopup").not(e).remove()}var e,p;p=Date.now();a.attr("p",p);e=$('<div id="'+p+'" class="smartContentPopup" style="z-index: '+(window.shameful_popup_zindex++)+' !important"> <div class="loadingcss"></div> </div>').appendTo(body);j(a,e,0);infoHandler(d,function(s,u){e.html(s+'<div class="keyOnScreen">Toggle Shift + '+codeToName[nameToCode.cmdOrControl]+" to keep this popup on your screen</div>");if(typeof u=="function"){var r=u(e);var t=(typeof r.TTL!="undefined")?r.TTL:0}else{var t=0}j(a,e,t)},((k>i)?k:i)-30,l-30);body.bind("mousemove."+p,function(s){var r=a.offset();if(!window.preventPreviewClose&&(r.left>s.pageX||r.top>s.pageY||(r.left+a.width())<s.pageX||(r.top+a.height())<s.pageY)){body.unbind("mousemove."+p);e.remove();a.removeAttr("p")}})},1000);a.attr("timeout",b)}function subReddits(a){a.setting("subredditBar",function(c){var b="#SubredditBar";if(!c){$(b).hide();$("#ContentContainer").addClass("noSubredditBar");return}else{$("#ContentContainer").removeClass("noSubredditBar");$(b).show()}a.subs(function(h){subredditBarExists=true;var o='<div class="Subreddit" style="display: none">QuickView</div><div class="Subreddit" style="display: none">'+h.join('</div><div class="Subreddit" style="display: none">')+"</div>";var l=$(b).html("");var p=$('<div id="less"></div>').appendTo(l);var r=$('<div id="content"></div>').appendTo(l);var n=$('<div id="more"></div>').appendTo(l);r.html($(o));var q=r.find(".Subreddit");var m=18;var g=18;function j(){if(f!=d){n.show()}else{n.hide()}if(f!=1){p.show()}else{p.hide()}}var f,k,d;function e(){var t=r.width()-m;var s=0;f=1;k=1;d=1;q.each(function(){var v=$(this);var u=s;s+=v.outerWidth()+3;if(s>t){k++;d++;s=v.outerWidth()+3+g;u=g}v.attr("data-subredpage",k).css({left:u,display:"none"})});j();$("[data-subredpage="+f+"]").show()}setTimeout(e,1000);var i;$(window).unbind("resize.subRedditBar").bind("resize.subRedditBar",function(){clearTimeout(i);i=setTimeout(function(){e()},500)});l.off();l.on("click","#more",function(s){q.hide();$("[data-subredpage="+(++f)+"]").show();j()});l.on("click","#less",function(s){q.hide();$("[data-subredpage="+(--f)+"]").show();j()});l.on("click",".Subreddit",function(){var t=$(this).text();if(t=="QuickView"){promptFancy("Enter the name of a subreddit (i.e. pets)",function(u){if(u==""||u==false||u==null){return}u=u.replace("/r/","");if(u.substr(0,2)=="r/"){u=u.substr(2)}s(u)})}else{s(t)}function s(v){var u="/r/"+v+"/";new quickView(a,v,u)}})})})}(function(a){a.fn.reditor=function(){var c=this;c.instance=Date.now();c.extend({get_selection:function(){var g=this.get(0);if("selectionStart" in g){var f=g.selectionEnd-g.selectionStart;return{start:g.selectionStart,end:g.selectionEnd,length:f,text:g.value.substr(g.selectionStart,f)}}},set_selection:function(f,h){var g=this.get(0);if("selectionStart" in g){g.focus();g.selectionStart=f;g.selectionEnd=h}return this.get_selection()},replace_selection:function(g){var i=this.get(0);selection=this.get_selection();var f=selection.start;var h=f+g.length;i.value=i.value.substr(0,f)+g+i.value.substr(selection.end,i.value.length);this.set_selection(f,h);return{start:f,end:h,length:g.length,text:g}},wrap_selection:function(e,j,i,g){var h=this.get_selection().text;var f=this.replace_selection(e+h+j);if(i!==undefined&&g!==undefined){f=this.set_selection(f.start+i,f.start+i+g)}else{if(h==""){f=this.set_selection(f.start+e.length,f.start+e.length)}}return f},cut:function(h,e){var g=this.val();var f=g.substr(0,h)+g.substr(e+1);this.val(f)},multiline:function(i){var e=this.get_selection();var j=e.text;var k=this.val();var g=i.length;var l=i.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&");var m=new RegExp(l,"g");if(j.indexOf(i)!=-1){var n=j.split(i);var h=n.length;var f=j.replace(m,"");k=k.substr(0,e.start)+f+k.substr(e.end);this.val(k);c.set_selection(e.start,e.end-((h*g)-g))}else{var n=j.split(/\r|\r\n|\n/);var h=n.length;var f=i+j.replace(/\n\r?/g,"\n"+i);k=k.substr(0,e.start)+f+k.substr(e.end);this.val(k);this.set_selection(e.start,e.end+(g*h))}},destroy:function(){this.parent().off(".WYSIWYG"+this.instance)}});c.wrap('<div class="reditor" />');var b='<div class="ButtonGroup"><a id="Bold" class="Button middle"><span class="icon-bold"></span></a><a id="Italic" class="Button middle"><span class="icon-italic"></span></a><a id="Quote" class="Button middle"><span class="icon-comments-alt"></span></a><a id="Strike" class="Button middle"><span class="icon-strikethrough"></span></a><a id="Bullet" class="Button middle"><span class="icon-list"></span></a><a id="Link" class="Button middle"><span class="icon-link"></span></a><a id="Code" class="Button middle">Code</a><a id="Super" class="Button">Superscript</a><a id="Promote" class="Button">Promote Reditr</a></div>';var d=c.parent();d.off("WYSIWYG");d.prepend(b);d.on("click.WYSIWYG"+c.instance,"#Bold",function(){var e=c.get_selection();var f=c.val();if(f.charAt(e.end)+f.charAt(e.end+1)=="**"&&f.charAt(e.start-1)+f.charAt(e.start-2)=="**"){c.cut(e.end,e.end+1);c.cut(e.start-2,e.start-1);c.set_selection(e.start-2,e.end-2)}else{c.wrap_selection("**","**",2,c.get_selection().text.length)}});d.on("click.WYSIWYG"+c.instance,"#Strike",function(){var e=c.get_selection();var f=c.val();if(f.charAt(e.end)+f.charAt(e.end+1)=="~~"&&f.charAt(e.start-1)+f.charAt(e.start-2)=="~~"){c.cut(e.end,e.end+1);c.cut(e.start-2,e.start-1);c.set_selection(e.start-2,e.end-2)}else{c.wrap_selection("~~","~~",2,c.get_selection().text.length)}});d.on("click.WYSIWYG"+c.instance,"#Promote",function(){c.replace_selection("[Reditr](http://reditr.com)")});d.on("click.WYSIWYG"+c.instance,"#Super",function(){var e=c.get_selection();var f=c.val();if(f.indexOf("^")==-1){f="^"+f.replace(/( |\n)/g,"$1^")}else{f=f.replace(/\^/g,"")}c.replace_selection(f)});d.on("click.WYSIWYG"+c.instance,"#Link",function(){var i=c.get_selection();var e=i.text;var j=c.val();if(j.charAt(i.start-1)=="["&&j.charAt(i.end)+j.charAt(i.end+1)=="]("){c.cut(i.start-1,i.start-1);var g=i.end-1;var h=i.end;while(j.charAt(h)!=")"){h++}c.cut(g,h-1);c.set_selection(i.start-1,i.end-1)}else{var f=prompt("Please enter a URL:","http://");if(f!=null){c.wrap_selection("[","]("+f+")",1,i.text.length)}else{c.set_selection(i.start,i.end)}}});d.on("click.WYSIWYG"+c.instance,"#Bullet",function(){c.multiline("* ")});d.on("click.WYSIWYG"+c.instance,"#Code",function(){c.multiline("    ")});d.on("click.WYSIWYG"+c.instance,"#Quote",function(){c.multiline(">")});d.on("click.WYSIWYG"+c.instance,"#Italic",function(){var e=c.get_selection();var f=c.val();if(f.charAt(e.end)=="*"&&f.charAt(e.end+1)!="*"&&f.charAt(e.start-1)=="*"&&f.charAt(e.start-2)!="*"){c.cut(e.end,e.end);c.cut(e.start-1,e.start-1);c.set_selection(e.start-1,e.end-1)}else{c.wrap_selection("*","*",1,c.get_selection().text.length)}});d.on("click.WYSIWYG",function(){c.change()});return this}})(jQuery);function gallery(a,b,c){this.url=a.url;this.connection=a.connection;this.columnObject=a;this.callback=c;this.posts=[];this.currentPost=0;this.after=null;this.loadingNext=false;this.mode=b;this.stopLoadingNewPosts=false;this.sort=a.flags.SORT;this.otherPostLoaded=false;this.startup()}gallery.prototype.startup=function(){var a=this;a.backdrop=$('<div class="complexAlertBackdrop"></div>').appendTo("body");a.playground=$('<div class="complexAlertContainer" id="galleryPlayground"> 		<div class="galleryButtons"> 		  <div class="buttongroup buttonContainer"><button class="galleryHome">Gallery Home</button> 		  <button class="copyLink openContainer">Copy URL</button> 		  <button class="visitLink openContainer">View Comments</button></div></div> 		<div data-message="close" id="closeGallery"></div> 		<div class="backButton"></div> 		<div class="galleryTitle"></div> 		<div class="galleryThumbs"><div class="loadingcss block"></div></div> 		<div class="galleryThumbsShadow"></div> 		<div class="galleryContent"></div> 		<div class="forwardButton"></div> 	</div>').appendTo("body");a.thumbContainer=a.playground.find(".galleryThumbs");a.postTitle=a.playground.find(".galleryTitle");a.postContent=a.playground.find(".galleryContent");a.buttons=a.playground.find(".galleryButtons");a.playground.on("click.gallery","#closeGallery",function(){a.closeGallery()});a.playground.on("click.gallery",".forwardButton",function(){a.loadNext()});a.playground.on("click.gallery",".backButton",function(){a.loadPrev()});a.playground.on("click.gallery",".galleryHome",function(){a.defaultLayout()});a.playground.on("click.gallery",".copyLink",function(){a.copyLink()});a.playground.on("click.gallery",".visitLink",function(){a.openLink()});a.postTitle.on("click.gallery",".upVote",function(){a.upVote($(this))});a.postTitle.on("click.gallery",".downVote",function(){a.downVote($(this))});a.thumbContainer.on("click.gallery",".thumb",function(){var b=$(this).attr("id");if(a.posts.length-(b+1)<=5){a.loadMore(a.after)}a.singleLayout($(this).attr("id"))});a.playground.on("scroll.gallery",function(b){clearTimeout(a.scrollEvent);a.scrollEvent=setTimeout(function(){a.handleScroll(b)},500)});if(a.mode=="default"){a.defaultLayout()}else{if(a.mode=="fromPost"){a.fromPost()}}};gallery.prototype.fromPost=function(){var c=this;var a=[];var b=c.columnObject.selector.find(".Post.current");c.backdrop.addClass("animate");c.posts=[];c.after=c.columnObject.selector.find(".Post:last").prev().attr("name");var d=0;c.columnObject.selector.find(".Post").each(function(i,k){var j=$(this);if(typeof j.attr("data-href")!="undefined"){if(infoHandler(j.attr("data-href"),false)){var l=j.find(".Thumb").outerHTML()==""?'<div title="'+j.find(".Title").text()+'" class="noThumb"></div>':j.find(".Thumb").attr("title",j.find(".Title").text()).outerHTML();a.push('<div id="'+d+'" class="thumb '+(j.hasClass("current")?"selected":"")+' hide" href="'+j.attr("data-href")+'"><div class="thumbEffects">'+l+"</div></div>");var h=null;if(j.find(".upVote").hasClass("Likes")){h=true}else{if(j.find(".upVote").hasClass("DisLikes")){h=false}}if(j.hasClass("current")){c.currentPost=d}c.posts[d]={id:j.attr("data-postid"),permalink:j.attr("data-permalink"),likes:h,url:j.attr("data-href"),title:j.find(".Title").text(),score:j.find(".Score").text()};d++}}});var e=c.posts.length*90;c.thumbContainer.html(a.join("")).addClass("forceBottom").css("width",e+"px");var g=0;function f(){var j=$(window).height();var i=(Math.floor((c.posts.length*133)/$(window).width()))*133;var h=c.posts.length;c.getData(c.after,function(){c.thumbContainer.css("width",c.posts.length*90+"px").append(c.createPostBuffer(h));if(i<j&&g<=5){f()}});g++}f();c.buttons.show();c.highlight(c.currentPost)};gallery.prototype.handleScroll=function(){var b=this.playground;var c=b.scrollTop();var a=this;this.yScrollPos=c;if(b.height()-(c+b.height())<650&&!this.loadingNext){this.loadingNext=true;this.count+=25;a.loadMore(a.after)}};gallery.prototype.loadMore=function(){var a=this;a.loadingNext=true;var c=a.posts.length;var d=0;function b(e){if(a.posts.length-c<=5&&d<=5){a.getData(a.after,function(f){var g=a.createPostBuffer(e,false);setTimeout(function(){a.thumbContainer.append(g);if(a.thumbContainer.hasClass("forceBottom")){a.thumbContainer.css("width",(a.posts.length+25)*90+"px")}a.loadingNext=false;b(a.posts.length);d++},100)})}}b(c)};gallery.prototype.closeGallery=function(){this.stopLoadingNewPosts=true;this.playground.remove();this.playground=undefined;this.backdrop.remove();this.backdrop=undefined;delete this};gallery.prototype.defaultLayout=function(){var a=this;var c=0;a.backdrop.addClass("animate");a.playground.find(".backButton, .forwardButton").hide();a.buttons.hide();if(a.thumbContainer.find(".thumb").length==0){a.posts=[];a.after=null;a.stopLoadingNewPosts=false;function b(){var g=$(window).height();var e=(Math.floor((a.posts.length*133)/$(window).width()))*133;var d=a.posts.length;var f=a.after;a.getData(a.after,function(){if(f==null){a.thumbContainer.html("")}a.thumbContainer.append(a.createPostBuffer(d));if(e<g&&!a.stopLoadingNewPosts&&c<=11){b()}});c++}b()}else{a.thumbContainer.removeClass("forceBottom").css("width","100%");a.playground.find(".backButton, .forwardButton").hide();a.postTitle.hide();a.postContent.hide();a.buttons.hide()}};gallery.prototype.loadNext=function(){var a=this;if(a.currentPost>=(a.posts.length-1)){a.highlight(a.posts.length-1)}else{if(a.currentPost>=(a.posts.length-25)){a.highlight(++a.currentPost);a.loadMore(a.after)}else{a.highlight(++a.currentPost)}}};gallery.prototype.loadPrev=function(){var a=this;if(a.currentPost==0){a.highlight(0)}else{a.highlight(--a.currentPost)}};gallery.prototype.singleLayout=function(b){var a=this;a.stopLoadingNewPosts=true;if(!a.thumbContainer.hasClass("forceBottom")){a.thumbContainer.addClass("forceBottom").css({width:(a.posts.length+25)*90+"px"});a.playground.find(".backButton, .forwardButton").show();a.postTitle.show();a.postContent.show();a.buttons.show()}setTimeout(function(){a.highlight(b)},225)};gallery.prototype.loadContent=function(c){var b=this;var d=b.posts[c];var a=d.url;b.postContent.contents().fadeOut(100,function(){$(this).parent().html('<div class="loadingcss block"></div>')});infoHandler(a,function(i,k){if(c==b.currentPost){b.postContent.html('<div class="contentAlign">'+i+'<div class="galleryPostComments"></div></div>');if(typeof k=="function"){var g=k(b.postContent);if(g.handledBy){var j=b.postContent.find("img");var f=j.width();var e=j.height();var h=true;j.draggable({start:function(){h=false},stop:function(){setTimeout(function(){h=true},250)}});j.on("click",function(l){l.stopPropagation();l.preventDefault();if(!h){return false}f*=1.2;e*=1.2;j.css("width",f+"px").css("height",e+"px");return false});j.on("contextmenu",function(l){l.stopPropagation();l.preventDefault();if(!h){return false}f*=0.8;e*=0.8;j.css("width",f+"px").css("height",e+"px");return false});j.on("mousewheel",function(o){o.preventDefault();o.stopPropagation();var l=o.originalEvent.wheelDeltaY;var m=f+(l/600)*f;var n=e+(l/600)*e;if(l<0&&(n<50||m<50)){return false}j.css("width",(f=m)+"px").css("height",(e=n)+"px");return false})}}}},b.playground.width()-200,b.playground.height()-240)};gallery.prototype.highlight=function(g){var d=this;d.currentPost=g;var c=d.thumbContainer.find("#"+g);var f=$(document).width();if(d.posts.length*90>f){var h=c.position().left-(f/2)+41;d.thumbContainer.css("left",-1*h+"px")}d.thumbContainer.find(".highlight").removeClass("highlight");c.addClass("highlight");var b=d.posts[g];var a="";if(b.likes==true){a="Likes"}else{if(b.likes==false){a="DisLikes"}}var e='<div class="Voting"><div class="controls"><div class="upVote '+a+'"></div><div class="Score">'+b.score+'</div><div class="downVote '+a+'"></div></div><div class="theTitle">'+c.find("div:not(.thumbEffects), img").attr("title")+"</div></div>";d.loadContent(g);d.setTitle(e)};gallery.prototype.setTitle=function(b){var a=this;a.postTitle.html(b)};gallery.prototype.createPostBuffer=function(d,g){var a=[];var b=this;var g=g||false;for(var f=d;f<b.posts.length;f++){var e=b.posts[f];var h='<div title="'+e.title.replace(/\"/g,"&quot;")+'" class="noThumb"></div>';var c="";if(e.thumbnail!=""&&e.thumbnail!="self"&&e.thumbnail!="default"&&e.thumbnail!="nsfw"){h='<img title="'+e.title.replace(/\"/g,"&quot;")+'" src="'+e.thumbnail+'" />'}else{if(e.thumbnail=="self"||e.thumbnail=="default"||e.thumbnail=="nsfw"){h='<div title="'+e.title.replace(/\"/g,"&quot;")+'" class="'+e.thumbnail+'"></div>'}}a.push('<div id="'+f+'" class="thumb '+(g?"hide":"")+'" href="'+e.url+'"><div class="thumbEffects">'+h+"</div></div>")}return a.join("")};gallery.prototype.getData=function(b,c){var a=this;a.columnObject.fetchDataAfter(b,function(h){var d=h.length;var e=a.posts.length;for(var g in h){var f=h[g].data;if(a.isMedia(f.url)){a.posts[e]=h[g].data;e++}if(g=d-1){a.after=f.name}}if(typeof c=="function"){c(h)}})};gallery.prototype.isMedia=function(a){var b=a.toLowerCase();return infoHandler(b,false)};gallery.prototype.upVote=function(f){var b=this;var a=b.connection;var c=b.posts[b.currentPost];var e=f.parent();var h=e.children(".downVote:first");var g=e.children(".Score:first");if(!f.hasClass("Likes")){f.addClass("Likes");var d=(h.hasClass("DisLikes")?2:1);h.removeClass("DisLikes");g.text(parseInt(g.text())+d);a.upvote(c.id)}else{f.removeClass("Likes");h.removeClass("DisLikes");g.text(parseInt(g.text())-1);a.removevote(c.id)}};gallery.prototype.downVote=function(f){var b=this;var a=b.connection;var c=b.posts[b.currentPost];var e=f.parent();var h=e.children(".upVote:first");var g=e.children(".Score:first");if(!f.hasClass("DisLikes")){f.addClass("DisLikes");var d=(h.hasClass("Likes")?-2:-1);h.removeClass("Likes");g.text(parseInt(g.text())+d);a.downvote(c.id)}else{f.removeClass("DisLikes");h.removeClass("Likes");g.text(parseInt(g.text())+1);a.removevote(c.id)}};gallery.prototype.copyLink=function(){var b=this;var d=b.posts[b.currentPost];var c=d.url;var a=document.createElement("div");a.contentEditable=true;document.body.appendChild(a);a.innerHTML=c;a.unselectable="off";a.setAttribute("style","position: absolute; top: -1000px; left: -1000px; width: 1px; height: 1px;").focus();document.execCommand("SelectAll");document.execCommand("Copy",false,null);document.body.removeChild(a)};gallery.prototype.openLink=function(){var a=this;var c=a.playground.find(".visitLink");if(c.text()=="View Comments"){c.text("Close Comments");a.playground.addClass("commentsMode");var b=a.posts[a.currentPost];var d=new redditpost(b.id,b.permalink,a.playground.find(".galleryPostComments"),a.connection,a.columnObject)}else{c.text("View Comments");a.playground.find(".galleryPostComments").html("");a.playground.removeClass("commentsMode")}};function uploader(){var a=this;this.files=[];this.uploadContainer=$('<div id="uploadProgressContainer"></div>').appendTo("body");this.bufferIterator=0;this.isUploading=false;this.url="http://imgur.com/";this.imgIds="";this.callback=undefined;this.startup()}uploader.prototype.startup=function(){var a=this;$(document).bind("drop",function(b){b.preventDefault();a.createUploadBuffer(b)})};uploader.prototype.createUploadBuffer=function(b,c){var a=this;a.callback=c||undefined;a.files=(typeof b.originalEvent.dataTransfer=="undefined")?b.originalEvent.srcElement.files:b.originalEvent.dataTransfer.files;a.bufferLength=a.files.length;a.bufferIterator=0;a.runUploader(a.bufferIterator)};uploader.prototype.runUploader=function(e){var a=this;a.isUploading=true;var d=a.files[e];var h="upload_"+Date.now();if(!d||!d.type.match(/image.*/)){if(typeof a.callback!="undefined"){a.callback(false)}return}var c=$('<div id="'+h+'" class="upload"><div class="fileName">'+d.name+'</div><span class="uploadProgress"><span class="percentage">0</span>%</span><div class="clearBoth"></div></div>').prependTo(a.uploadContainer);var f=c.find(".percentage");var b=new FormData();b.append("image",d);b.append("key","5a9cc96a4bcaacb8cd50d0e5a89886db");var g=new XMLHttpRequest();g.open("POST","http://api.imgur.com/2/upload.json");g.onload=function(){f.html(100);a.handleFinishedUpload(JSON.parse(g.responseText).upload.links);c.fadeOut(350,function(){$(this).remove()})};g.upload.addEventListener("progress",function(j){var i=Math.round(parseInt((j.loaded/j.total*100))*0.99);f.html(i)},false);g.send(b);if(a.bufferLength-1==e){a.isUploading=false}else{setTimeout(function(){a.runUploader(++a.bufferIterator)},10)}};uploader.prototype.handleFinishedUpload=function(c){var a=this;var b=c.imgur_page;a.imgIds+=b.replace("http://imgur.com/","")+",";if(!a.isUploading&&$("#newPostPopup").length!=0){if($("#newPostPopup #Link").val().indexOf("imgur")!=-1){$("#newPostPopup #Link").val($("#newPostPopup #Link").val()+","+a.imgIds.slice(0,-1))}else{$("#newPostPopup #Link").val(a.url+a.imgIds.slice(0,-1))}}else{if(!a.isUploading&&$("#settingsPopup").length==0){createPost(null,connection,window.tabManagerObj,function(d){d.find("#Link").val(a.url+a.imgIds.slice(0,-1))})}else{if(!a.isUploading){if(typeof a.callback!="undefined"){a.callback(c)}}}}if(!a.isUploading){a.imgIds="";a.files=[]}};var _gaq=_gaq||[];_gaq.push(["_setAccount","UA-32339730-2"]);_gaq.push(["_trackPageview",location.pathname+location.search+location.hash]);(function(){var b=document.createElement("script");b.type="text/javascript";b.async=true;b.src="https://ssl.google-analytics.com/ga.js";var a=document.getElementsByTagName("script")[0];a.parentNode.insertBefore(b,a)})();window.themeid=100;function changeAccountSettings(a,c,b){if(b){subReddits(a)}applyShortcuts(a);a.setting("fontSize",function(d){$("head #fontSetting").remove();if(d==13){return}$("head").append('<style id="fontSetting"> 							.Column #PostContainer div.Post div.Title, .infoDescription, #CommentContent { 							    font-size: '+d+"px !important; 							    line-height: "+(d*1.28578)+"px !important; 							} 							#ColumnContainer .Column #PostContainer div.Post .Domain { 							    font-size: "+(d*0.8571)+"px !important; 							} 							#ColumnContainer .Column #PostContainer div.Post .InfoBottom { 							    font-size: "+(d*0.8571)+"px !important; 							} 						 </style>")});a.setting("background",function(d){var e=$("#stripes");if(d==-1){e.css("background","none")}else{a.setting("backgrounds",function(f){e.css("background","url("+f[d]+".png) center center")})}});a.setting("backgroundStretched",function(d){var e=$("#stripes");if(d){e.css("background-size","100% 100%")}else{e.css("background-size","auto")}});if(c){a.setting("theme",function(e){e=(reddit.prototype.defaultSettings.theme=="iOSDark")?"iOSDark":e;if(typeof e=="undefined"||e==""){e="dark"}var d=window.themeid;window.themeid=load_css("css/stylesheet_theme_"+e+".css",function(){$("#"+d).remove()});if(e.toLowerCase().indexOf("dark")!=-1){$("body").addClass("darkTheme")}else{$("body").removeClass("darkTheme")}});a.setting("visual_animations",function(d){$('link[rel=stylesheet][href*="stylesheet_blockanimations"]').remove();if(!d){load_css("css/stylesheet_blockanimations.css")}})}}function navLogout(a){a.logout(function(){updateNav("person","guest");window.location=window.location+"/reload/"+Date.now()})}function accountsPopup(d,b,a){if($("body").find("#accountsPopup").length!=0){$("body").find("#accountsPopup").off().remove();return}setTimeout(function(){$("body").one("click",function(){$("body").find("#accountsPopup").off().remove()})},250);var e=$('<div id="accountsPopup" class="menubarDropdown"> 						   	  <div action="new" class="text node">Add Account</div> 						   </div>').appendTo("body");var c=b.user.username;database.fetch("users",function(h){var f="";for(var g in h){f+="<div class='node "+((c==h[g].username)?"active":"inactive")+"'> 						 	 <div class='text' action='reddit'>"+h[g].username+"</div> 						 	 <div action='remove' class='option icon remove'></div> 						 </div>"}e.append(f)});e.on("click","div",function(){e.remove();var f=$(this).attr("action");if(f=="reddit"){var g=$(this).html();if(g==b.user.username){b.logout(function(i){changeAccountSettings(b);window.location.href=(window.location.href.replace(/reload\/(.*?)\//,"")+"/reload/"+Date.now()).replace("//reload","/reload");updateNav("person","guest")});return}b.switchUser(g,function(){changeAccountSettings(b);updateNav("person","member");if(typeof window.userNotifications=="undefined"){window.userNotifications=new notificationsCenter($("#notificationCounter"),b)}else{window.userNotifications.restart()}sync_update(b);window.location.href=(window.location.href.replace(/reload\/(.*?)\//,"")+"/reload/"+Date.now()).replace("//reload","/reload")})}else{if(f=="remove"){var h=$(this).parent().find(".text").html();$.popup({title:"Account Removal",id:"confirmDeleteUser",message:"Are you sure you want to remove the account "+h+" from Reditr?",buttons:'<button data-message="close" class="left"><i class="icon-remove"></i><span>&nbsp;&nbsp;No</span></button><button data-message="remove" class="right green"><i class="icon-ok"></i><span>&nbsp;&nbsp;Yes</span></button>'},function(j,i){if(j=="remove"){b.removeUser(h,false,function(){sync_update(b)})}return"close"})}else{if(f=="new"){addNewAccountPopup(b)}}}})}function addNewAccountPopup(b){var a='<div class="incontainer"> 							<input id="username" data-message="add" placeholder="Reddit Username"> 						</div> 						<div class="incontainer"> 							<input id="password" data-message="add" class="nomargins" placeholder="Reddit Password" type="password"> 						</div>';var d='<button class="right space green" data-message="add"><i class="icon-ok"></i><span>&nbsp;&nbsp;Add Account</span></button> 				   <button class="left" data-message="close"><i class="icon-remove"></i><span>&nbsp;&nbsp;Cancel</span></button>';var c=$.popup({id:"newAccountPopup",message:a,buttons:d},function(g,f){if(g=="add"&&!f.hasClass("loading")){f.addClass("loading");var h=$(this).find("#username").val();var e=$(this).find("#password").val();b.login(h,e,function(i){if(i=="RATELIMIT"){alert("Reddit has given you a rate limit error.");f.removeClass("loading");return}else{if(i=="WRONG_PASSWORD"){alert("You have entered an invalid password.");f.removeClass("loading");return}else{if(i=="ERROR"){alert("Reddit has returned an unknown error. Please try again later.");f.removeClass("loading");return}}}c.closePopup();sync_update(b);if(i=="SUCCESS"){changeAccountSettings(b);updateNav("person","member");window.location.href=(window.location.href.replace(/reload\/(.*?)\//,"")+"/reload/"+Date.now()).replace("//reload","/reload")}else{if(i=="SUCCESS_MULTIPLE"){updateNav("person","member");window.location.href=(window.location.href.replace(/reload\/(.*?)\//,"")+"/reload/"+Date.now()).replace("//reload","/reload")}}})}return g})}window.version="0.2.0.1";function update(a){a.fetch("version",function(b){if(typeof b=="undefined"){welcomeWizard(a,0)}else{if(parseInt(b.replace(/\./g,""))<parseInt(window.version.replace(/\./g,""))){a.save("version",window.version);$.get("http://reditr.com/updatenotes/"+window.version+".php",function(d){var c=$.popup({id:"updatePopup",message:d},function(e){return e});!function(h,e,i){var g,f=h.getElementsByTagName(e)[0];if(!h.getElementById(i)){g=h.createElement(e);g.id=i;g.src="http://platform.twitter.com/widgets.js";f.parentNode.insertBefore(g,f)}}(document,"script","twitter-wjs")})}}})}function welcomeWizard(b,a){sync_status(b,function(f){if(!f&&(a!=1&&a!=2)){settingsPopup.prototype.about(function(h){var g='<button class="left" data-message="close"><i class="icon-remove"></i><span>&nbsp;&nbsp;End Tutorial</span></button> <button class="green" data-message="goFirstStep"><i class="icon-hand-right"></i><span>&nbsp;&nbsp;Setup Reditr</span></button>';c(h,g)},b)}else{if(!f&&(a!=2)){var e="<h3>STEP 1: Setup Sync Account</h3> 						   If you choose to create a sync account with Reditr, we will automatically sync all your columns, usertags, accounts and favourites for you!";var d='<button class="left" data-message="close"><i class="icon-remove"></i><span>&nbsp;&nbsp;End Tutorial</span></button> <button data-message="skipSetupReditrAccount"><i class="icon-forward"></i><span>&nbsp;&nbsp;Skip Step</span></button>&#160;&#160;&#160;<button class="green" data-message="setupReditrAccount"><i class="icon-hand-right"></i><span>&nbsp;&nbsp;Create Sync Account</span></button>';c(e,d)}else{var e='<h3>STEP 2: Add Your Reddit Account</h3> 						   Now you may choose to add your Reddit account. You may add multiple accounts later on by clicking "Manage Accounts" in the top right of Reditr.';var d='<button class="left" data-message="close"><i class="icon-remove"></i><span>&nbsp;&nbsp;End Tutorial</span></button> <button data-message="setupRedditAccount" class="green"><i class="icon-hand-right"></i><span>&nbsp;&nbsp;Add your Reddit Account</span></button>';c(e,d)}}function c(i,h){var g=$.popup({id:"updatePopup",message:i,buttons:h},function(o){if(o=="goFirstStep"){o="close";setTimeout(function(){welcomeWizard(b,1)},400)}else{if(o=="reditrDonate"){popupBrowser("http://reditr.com/?donate")}else{if(o=="reditrWebsite"){popupBrowser("http://reditr.com")}else{if(o=="wallaMagic"){var j=$(window).height();var m='<div class="spaceship" style="position:absolute;z-index:99999;height: '+j+'px; width: 2560px;"></div>';var l='<div class="spaceship" style="top:-64px;left:64px;position:absolute;z-index:99999;height: '+j+'px; width:2432px;"></div>';var k=$('<div style="position:absolute;width:2560px;height:100%;left: -2560px;" id="eggMover">'+m+l+"</div>").prependTo("body");k.animate({left:"2560px"},1500,function(){$(this).remove()})}else{if(o=="reditrSubreddit"){g.closePopup();$("#content .Subreddit").first().click();$("#promptFancyinput").val("Reditr");$('[data-message="add"]').click()}else{if(o=="reditrBugsSubreddit"){g.closePopup();$("#content .Subreddit").first().click();$("#promptFancyinput").val("ReditrBugs");$('[data-message="add"]').click()}else{if(o=="setupReditrAccount"){var n=new settingsPopup(window.connection,window.tabManagerObj,"sync")}else{if(o=="skipSetupReditrAccount"){o="close";setTimeout(function(){welcomeWizard(b,2)},400)}else{if(o=="setupRedditAccount"){o="close";b.save("version",window.version);setTimeout(function(){addNewAccountPopup(connection)},400)}else{if(o=="close"){b.save("version",window.version)}}}}}}}}}}return o})}})}(function(N){function M(f,e){var h=(f&65535)+(e&65535),g=(f>>16)+(e>>16)+(h>>16);return g<<16|h&65535}function L(d,c){return d<<c|d>>>32-c}function K(b,l,k,j,i,c){return M(L(M(M(l,b),M(j,c)),i),k)}function J(i,d,n,m,l,k,j){return K(d&n|~d&m,i,d,l,k,j)}function I(i,d,n,m,l,k,j){return K(d&m|n&~m,i,d,l,k,j)}function H(i,d,n,m,l,k,j){return K(d^n^m,i,d,l,k,j)}function G(i,d,n,m,l,k,j){return K(n^(d|~m),i,d,l,k,j)}function F(P,O){P[O>>5]|=128<<O%32,P[(O+64>>>9<<4)+14]=O;var t,s,r,q,h,g=1732584193,f=-271733879,e=-1732584194,b=271733878;for(t=0;t<P.length;t+=16){s=g,r=f,q=e,h=b,g=J(g,f,e,b,P[t],7,-680876936),b=J(b,g,f,e,P[t+1],12,-389564586),e=J(e,b,g,f,P[t+2],17,606105819),f=J(f,e,b,g,P[t+3],22,-1044525330),g=J(g,f,e,b,P[t+4],7,-176418897),b=J(b,g,f,e,P[t+5],12,1200080426),e=J(e,b,g,f,P[t+6],17,-1473231341),f=J(f,e,b,g,P[t+7],22,-45705983),g=J(g,f,e,b,P[t+8],7,1770035416),b=J(b,g,f,e,P[t+9],12,-1958414417),e=J(e,b,g,f,P[t+10],17,-42063),f=J(f,e,b,g,P[t+11],22,-1990404162),g=J(g,f,e,b,P[t+12],7,1804603682),b=J(b,g,f,e,P[t+13],12,-40341101),e=J(e,b,g,f,P[t+14],17,-1502002290),f=J(f,e,b,g,P[t+15],22,1236535329),g=I(g,f,e,b,P[t+1],5,-165796510),b=I(b,g,f,e,P[t+6],9,-1069501632),e=I(e,b,g,f,P[t+11],14,643717713),f=I(f,e,b,g,P[t],20,-373897302),g=I(g,f,e,b,P[t+5],5,-701558691),b=I(b,g,f,e,P[t+10],9,38016083),e=I(e,b,g,f,P[t+15],14,-660478335),f=I(f,e,b,g,P[t+4],20,-405537848),g=I(g,f,e,b,P[t+9],5,568446438),b=I(b,g,f,e,P[t+14],9,-1019803690),e=I(e,b,g,f,P[t+3],14,-187363961),f=I(f,e,b,g,P[t+8],20,1163531501),g=I(g,f,e,b,P[t+13],5,-1444681467),b=I(b,g,f,e,P[t+2],9,-51403784),e=I(e,b,g,f,P[t+7],14,1735328473),f=I(f,e,b,g,P[t+12],20,-1926607734),g=H(g,f,e,b,P[t+5],4,-378558),b=H(b,g,f,e,P[t+8],11,-2022574463),e=H(e,b,g,f,P[t+11],16,1839030562),f=H(f,e,b,g,P[t+14],23,-35309556),g=H(g,f,e,b,P[t+1],4,-1530992060),b=H(b,g,f,e,P[t+4],11,1272893353),e=H(e,b,g,f,P[t+7],16,-155497632),f=H(f,e,b,g,P[t+10],23,-1094730640),g=H(g,f,e,b,P[t+13],4,681279174),b=H(b,g,f,e,P[t],11,-358537222),e=H(e,b,g,f,P[t+3],16,-722521979),f=H(f,e,b,g,P[t+6],23,76029189),g=H(g,f,e,b,P[t+9],4,-640364487),b=H(b,g,f,e,P[t+12],11,-421815835),e=H(e,b,g,f,P[t+15],16,530742520),f=H(f,e,b,g,P[t+2],23,-995338651),g=G(g,f,e,b,P[t],6,-198630844),b=G(b,g,f,e,P[t+7],10,1126891415),e=G(e,b,g,f,P[t+14],15,-1416354905),f=G(f,e,b,g,P[t+5],21,-57434055),g=G(g,f,e,b,P[t+12],6,1700485571),b=G(b,g,f,e,P[t+3],10,-1894986606),e=G(e,b,g,f,P[t+10],15,-1051523),f=G(f,e,b,g,P[t+1],21,-2054922799),g=G(g,f,e,b,P[t+8],6,1873313359),b=G(b,g,f,e,P[t+15],10,-30611744),e=G(e,b,g,f,P[t+6],15,-1560198380),f=G(f,e,b,g,P[t+13],21,1309151649),g=G(g,f,e,b,P[t+4],6,-145523070),b=G(b,g,f,e,P[t+11],10,-1120210379),e=G(e,b,g,f,P[t+2],15,718787259),f=G(f,e,b,g,P[t+9],21,-343485551),g=M(g,s),f=M(f,r),e=M(e,q),b=M(b,h)}return[g,f,e,b]}function E(e){var d,f="";for(d=0;d<e.length*32;d+=8){f+=String.fromCharCode(e[d>>5]>>>d%32&255)}return f}function D(e){var d,f=[];f[(e.length>>2)-1]=undefined;for(d=0;d<f.length;d+=1){f[d]=0}for(d=0;d<e.length*8;d+=8){f[d>>5]|=(e.charCodeAt(d/8)&255)<<d%32}return f}function C(b){return E(F(D(b),b.length*8))}function B(i,h){var n,m=D(i),l=[],k=[],j;l[15]=k[15]=undefined,m.length>16&&(m=F(m,i.length*8));for(n=0;n<16;n+=1){l[n]=m[n]^909522486,k[n]=m[n]^1549556828}return j=F(l.concat(D(h)),512+h.length*8),E(F(k.concat(j),640))}function A(g){var f="0123456789abcdef",j="",i,h;for(h=0;h<g.length;h+=1){i=g.charCodeAt(h),j+=f.charAt(i>>>4&15)+f.charAt(i&15)}return j}function z(b){return unescape(encodeURIComponent(b))}function y(b){return C(z(b))}function x(b){return A(y(b))}function w(d,c){return B(z(d),z(c))}function v(d,c){return A(w(d,c))}function u(e,d,f){return d?f?w(d,e):v(d,e):f?y(e):x(e)}"use strict",typeof define=="function"&&define.amd?define(function(){return u}):N.md5=u})(this);function sync_status(a,b){a.fetch("sync_enabled",function(c){b(c?true:false)})}function sync_recovery(b,a,c){$.post("http://api.reditr.com/sync/",{action:"recovery",email:b},function(d){c(d)})}function sync_setup(c,b,a,f){var e=a.database;var d=md5("@(&TH3f2F)"+b);$.post("http://api.reditr.com/sync/",{action:"login",email:c,password:d},function(g){if(g=="success"){e.save("sync_username",c,function(){e.save("sync_password",d,function(){e.save("sync_enabled",true,function(){e.save("sync_lastupdate","0",function(){if(typeof f=="function"){f(g)}})})})})}else{if(g=="empty"){if(typeof f=="function"){f(g)}return}else{$.post("http://api.reditr.com/sync/",{action:"register",email:c,password:d},function(h){if(h=="empty"||h=="taken"||h=="invalid_email"){f(h);return}else{if(h=="success"){e.save("sync_username",c,function(){e.save("sync_password",d,function(){e.save("sync_enabled",true);if(typeof f=="function"){f(h)}})})}}})}}})}function sync_sync(a,c){var b=a.database;b.fetch("sync_enabled",function(d){if(!d){if(typeof c=="function"){c()}return}b.fetch("sync_username",function(e){b.fetch("sync_password",function(f){b.fetch("sync_lastupdate",function(g){$.post("http://api.reditr.com/sync/",{action:"sync",email:e,password:f,lastupdate:g},function(i){var h=i.substr(0,10);i=i.substr(10);if(i==""){c("success")}else{if(i=="empty"||i=="invalid_login"){alert("Pleaase re-configure your sync settings!");if(typeof c=="function"){c("success")}}else{if(i==""){sync_update(a,c)}else{if(i=="no_changes"){if(typeof c=="function"){c("success")}}else{b.save("sync_lastupdate",h);sync_applyChanges(a,i,c)}}}}})})})})})}function sync_applyChanges(a,d,e){var c=a.database;var d=JSON.parse(d);for(var b in d){c.save(b,d[b])}if(typeof e=="function"){e("success")}}function sync_update(a,c){var b=a.database;b.fetch("sync_enabled",function(e){if(!e){return}var d={};b.fetch("users",function(k){b.fetch("reddit_activeuser",function(i){d.reddit_activeuser=i});d.users=k;var j=0;for(var g in k){b.fetch(g,function(i){d[g]=i});var f=g+"_columns";b.fetch(f,function(i){d[f]=i});var f=g+"_tags";b.fetch(f,function(i){d[f]=i});var f=g+"_savedComments";b.fetch(f,function(i){d[f]=i});var f=g+"_subs";b.fetch(f,function(i){if(typeof i!="undefined"){d[f]=i}clearTimeout(j);j=setTimeout(h,1000)})}function h(){saveString=JSON.stringify(d);b.fetch("sync_username",function(i){b.fetch("sync_password",function(l){$.post("http://api.reditr.com/sync/",{action:"sync",email:i,password:l,data:saveString},function(m){if(m=="empty"||m=="invalid_login"){alert("Pleaase re-configure your sync settings!");if(typeof c=="function"){c("success")}}else{if(m.indexOf("time:")!=-1){var n=m.match(/time:(.*?):/).pop();b.save("sync_lastupdate",n);if(typeof c=="function"){c("success")}}}})})})}})})}window.isMacgap=(typeof macgap!="undefined")?true:false;window.nodewebkit=(typeof window.parent.require!="undefined")?true:false;window.microsoft=(navigator.appName.indexOf("MSAppHost")!=-1)?true:false;if(window.microsoft){reddit.prototype.defaultSettings.enableFlair=false;window.forceFlairOff=true;window.alert=function(a){$.popup({message:a},function(b){return b})}}else{if(navigator.userAgent.search(/(iPad|iPhone|iPod|Android)/i)!=-1){reddit.prototype.crossDomain=true;reddit.prototype.jsonextension=".json?jsonp=?&";reddit.prototype.defaultSettings.visual_animations=false;reddit.prototype.defaultSettings.macros_enabled=false;reddit.prototype.defaultSettings.theme="iOSDark";reddit.prototype.defaultSettings.postHoverOvers=false}else{if(window.nodewebkit){var gui=window.parent.require("nw.gui");var sys=window.parent.require("sys");var exec=window.parent.require("child_process").exec;window.popupBrowser=function(a){gui.Shell.openExternal(a)};window.clipboard_set=function(a){gui.Clipboard.get().set(a)};var positionFromBottom=0;window.desktopNotification=function(c,b){if(navigator.appVersion.indexOf("Win")!=-1){return}else{function a(f,d,e){sys.puts(d)}exec('notify-send -t 3000 "'+c.replace(/"/g,'"')+'" "'+b.replace(/"/g,'"')+'" -i /opt/reditr/128x128.png',a)}}}else{if(window.isMacgap){var database=new storageWrapper();database.fetch("OSXWindowSettings",function(a){if(typeof a=="undefined"){a={width:1040,height:700,x:(window.screen.availWidth-1040)/2,y:(window.screen.height-700)/2}}macgap.window.resize({width:a.width,height:a.height});macgap.window.move({x:a.x,y:window.screen.height-a.y-a.height});setInterval(function(){if(window.screenX!=a.x||window.screenY!=a.y){a.x=window.screenX;a.y=window.screenY;database.save("OSXWindowSettings",a)}if(window.innerWidth!=a.width||a.innerHeight!=a.height){a.width=window.innerWidth;a.height=window.innerHeight;database.save("OSXWindowSettings",a)}},3000)});window.popupBrowser=function(a){macgap.app.open(a)};window.desktopNotification=function(b,a){macgap.notice.notify({title:b,content:a})};var old_setBadge=setBadge;window.setBadge=function(a){macgap.dock.badge=String(a);old_setBadge(a)};window.clipboard_set=function(a){var b='<textarea class="viewSource">'+a+"</textarea>";var c=$.popup({title:"Copy Your Text Below",message:b},function(d){return d});setTimeout(function(){c.find(".viewSource").select()},500)};reddit.prototype.defaultSettings.macros.hide=nameToCode.cmdOrControl+",72";reddit.prototype.defaultSettings.macros.quit=nameToCode.cmdOrControl+",81";shortcuts.hide={action:function(){macgap.app.hide()},desc:"Hide Reditr"};shortcuts.quit={action:function(){macgap.app.terminate()},desc:"Quit Reditr"}}}}}function quickView(c,i,b,a,d){var j=this;this.connection=c;this.displayFlags=(typeof a=="undefined")?{SPECIAL:true,TEMP:true}:a;this.addColumnFlags=(typeof d=="undefined")?{SORT:"hot"}:d;this.title=i;var g='<div class="Viewport"></div>';var h='<div id="subRedditsBottomPane" class="left"> 						<div data-message="startGallery" id="galleryIcon" class="bottomIcon"><i class="icon-camera"></i> 							<div class="desc">Gallery</div> 						</div> 						<div data-message="newRandom" id="randomIcon" class="bottomIcon"><i class="icon-random"></i> 							<div class="desc">Random</div> 						</div> 						<div data-message="goBack" id="goBack" class="icon-circle-arrow-left bottomIcon" style="display: none"> 							<div class="desc">Go Back</div> 						</div> 						<div data-message="goForward" id="goForward" class="icon-circle-arrow-right bottomIcon" style="display: none"> 							<div class="desc">Go Forward</div> 						</div> 				   </div> 				   <div class="right"> 						  <div id="subStats"></div> 				   		  <button data-message="close" class="right space">[suggestedCloseText]</button> 				   		  <button data-message="addColumn" class="right green"><i class="icon-ok"></i><span>&nbsp;&nbsp;Add Column</span></button> 				   </div>';var f=null;f=this.thisPopup=$.popup({id:"subredditPopup",message:g,buttons:h,sidebar:"<div class='loadingcss'></div>"},function(m,l){return j.eventHandler.call(j,m,l)});this.setPopupStats(i);this.backArray=[];this.forwardArray=[];this.goForwardTimeout=null;this.goBackTimeout=null;var k=this.workingColumn=new column(b,f.find(".Viewport"),activePlayground,c,false,this.displayFlags,capitalize(i)).startup();var e=k.openPost;k.openPost=function(l){f.closePopup();e.call(k,l)};this.sidebar=f.find(".sidebar .content").on("click","a",function(m){m.preventDefault();m.stopPropagation();var l=$(this).attr("href");if((l+"/").search(/\/r\/(.*?)\/$/i)!=-1&&l.search(/\/r\/(.*?)\/(.+?)/i)==-1){var n=(l+"/").match(/\/r\/(.*?)\//i).pop();j.goForward(n)}else{redditpost.prototype.clickLink(l,m,function(o){if(o){k.shutdown(function(){f.closePopup()})}})}return false});this.changeSidebar(i,2)}quickView.prototype.eventHandler=function(e,c){var b=this.workingColumn;if(e=="addColumn"){var a=this;var f=tabManagerObj.insert(function(g){return new column(a.workingColumn.url,g,activePlayground,a.connection,this,a.addColumnFlags,capitalize(a.title))},"SYNC");tabManagerObj.changePage(f);$().closePopup(true)}else{if(e=="goForward"){this.goForward()}else{if(e=="goBack"){this.goBack()}else{if(e=="newRandom"){var d=this.thisPopup.find("#randomIcon");if(d.hasClass("icon-refresh")){return}d.removeClass("icon-random").addClass("icon-refresh");this.changeSidebar(null,1);var a=this;this.connection.randomSubreddit(function(g){a.goForward(g);d.addClass("icon-random").removeClass("icon-refresh")})}else{if(e=="startGallery"){var a=this;setTimeout(function(){a.workingColumn.openGallery()},100);e="close"}}}}}if(e=="close"){this.workingColumn.shutdown()}return e};quickView.prototype.changeSidebar=function(d,b){var c=this.sidebar;if(typeof b=="undefined"||b==1){c.html('<div class="loadingcss">')}if(typeof b=="undefined"||b==2){if(d=="Favourites"){c.html('<div class="title">Fav. Comments</div>');var a=$("<div></div>").appendTo(c);this.pullFavourites(a)}else{this.connection.sidebar(d,function(e){c.html('<div class="title">/r/'+capitalize(d)+"</div>"+e)})}}};quickView.prototype.pullFavourites=function(a){var b=this.connection;b.favouriteComments(function(e){for(var c in e){var d=e[c];if(d==true){continue}a.append('<div class="item loading"><div class="loadingcss"></div></div>');$.getJSON(reddit.prototype.base+d.replace(".json",reddit.prototype.jsonextension),function(g){var i=g[1].data.children[0].data;var h=g[0].data.children[0].data;var f="#/Home/post/"+h.id+"/permalink/"+h.permalink.replace(/\//g,"~")+i.id+"~/column/-r-"+h.subreddit.toLowerCase()+"-/title/"+capitalize(h.subreddit)+"/url/~r~"+h.subreddit.toLowerCase()+"~/sort/hot/highlight/"+h.id;a.find(".loading").first().replaceWith('<div class="item" link="'+f+'"><div class="author">'+i.author+'</div><div class="message">'+$("<div />").html(i.body_html.replace("&lt;!-- SC_OFF --&gt;","").replace("&lt;!-- SC_ON --&gt;","")).text()+'</div><div class="delete icon-remove" id="'+i.id+'"></div></div>')})}});a.on("click",".item:not(.loading)",function(c){c.preventDefault();c.stopPropagation();window.location.href=$(this).attr("link");return false});a.on("click",".item .delete",function(d){d.preventDefault();d.stopPropagation();var c=$(this);b.unsaveComment(c.attr("id"));c.parent().remove();return false})};quickView.prototype.goForward=function(c){var a=this;var b=this.thisPopup;clearTimeout(this.goForwardTimeout);this.goForwardTimeout=setTimeout(function(){var f=a.forwardArray;var g=a.backArray;var d=b.find("#goBack");var e=b.find("#goForward");if(typeof c!="undefined"){f=[];e.hide();g.push(a.title);a.title=c}else{c=f.pop();if(!f.length){e.hide()}g.push(a.title);a.title=c}d.show();a.workingColumn.setUrl("/r/"+c+"/");a.changeSidebar(c);a.setPopupStats(c);b.find("#text").html(c)},500)};quickView.prototype.goBack=function(){var a=this;var b=this.thisPopup;clearTimeout(this.goBackTimeout);this.goBackTimeout=setTimeout(function(){var e=a.forwardArray;var g=a.backArray;var c=b.find("#goBack");var d=b.find("#goForward");var f=g.pop();if(!g.length){c.hide()}e.push(a.title);a.title=f;d.show();a.workingColumn.setUrl("/r/"+f+"/");a.changeSidebar(f);a.setPopupStats(f);b.find("#text").html(f)})};quickView.prototype.setPopupStats=function(b){if(b=="Favourites"){this.thisPopup.find("#subStats").html("");return}var a=this;this.connection.subredditAbout(b,function(d){var c="<div class='item'> 					  	<div class='title'>Subscribed:</div> 					  	<div class='data'>"+d.subscribers+"</div> 					  </div> 					  <div class='item'> 					  	<div class='title'>Active Users:</div> 					  	<div class='data'>"+d.accounts_active+"</div> 					  </div> 					  <div class='item'> 					  	<div class='title'>Created On:</div> 					  	<div class='data'>"+formatDate(d.created)[0]+"</div> 					  </div>";a.thisPopup.find("#subStats").html(c)})};